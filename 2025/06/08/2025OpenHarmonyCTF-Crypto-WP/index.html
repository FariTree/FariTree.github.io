<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/Default_Emote-Thumbs_Up.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Default_Emote-Thumbs_Up.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/Default_Emote-Thumbs_Up.png">
  <link rel="mask-icon" href="/images/Default_Emote-Thumbs_Up.png" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":2,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="第一届鸿蒙CTF，密码部分都挺简单的">
<meta property="og:type" content="article">
<meta property="og:title" content="2025OpenHarmonyCTF-Crypto-WP">
<meta property="og:url" content="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/index.html">
<meta property="og:site_name" content="FariTree&#39;s Blog">
<meta property="og:description" content="第一届鸿蒙CTF，密码部分都挺简单的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/enc.png">
<meta property="article:published_time" content="2025-06-08T07:16:59.000Z">
<meta property="article:modified_time" content="2025-06-08T09:22:57.250Z">
<meta property="article:author" content="FariTree">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="OL-attack">
<meta property="article:tag" content="DLP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/enc.png">


<link rel="canonical" href="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/","path":"2025/06/08/2025OpenHarmonyCTF-Crypto-WP/","title":"2025OpenHarmonyCTF-Crypto-WP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2025OpenHarmonyCTF-Crypto-WP | FariTree's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">FariTree's Blog</p>
      <i class="logo-line"></i>
    </a>
      <img class="custom-logo-image" src="/images/Default_Emote-Thumbs_Up.png" alt="FariTree's Blog">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#ea5y_rsa"><span class="nav-number">1.</span> <span class="nav-text">Ea5y_RSA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF"><span class="nav-number">1.1.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exp"><span class="nav-number">1.2.</span> <span class="nav-text">exp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#small-message-for-sm4-encryption"><span class="nav-number">2.</span> <span class="nav-text">Small Message For (SM4)
Encryption</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-1"><span class="nav-number">2.1.</span> <span class="nav-text">exp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weak_random"><span class="nav-number">3.</span> <span class="nav-text">Weak_random</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-2"><span class="nav-number">3.1.</span> <span class="nav-text">exp</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#simple-lll"><span class="nav-number">4.</span> <span class="nav-text">Simple LLL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%9D%E8%B7%AF-1"><span class="nav-number">4.1.</span> <span class="nav-text">思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exp-3"><span class="nav-number">4.2.</span> <span class="nav-text">exp</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">FariTree</p>
  <div class="site-description" itemprop="description">我好菜啊</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="FariTree">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FariTree's Blog">
      <meta itemprop="description" content="我好菜啊">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2025OpenHarmonyCTF-Crypto-WP | FariTree's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2025OpenHarmonyCTF-Crypto-WP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-06-08 15:16:59 / 修改时间：17:22:57" itemprop="dateCreated datePublished" datetime="2025-06-08T15:16:59+08:00">2025-06-08</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>第一届鸿蒙CTF，密码部分都挺简单的</p>
<span id="more"></span>
<h3 id="ea5y_rsa">Ea5y_RSA</h3>
<p><strong>题目描述</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是一个未完全开发的OpenHarmony应用，在hint.txt中泄露了部分日志记录。请根据给定的源码和日志记录得到flag</span><br></pre></td></tr></table></figure>
<p><strong>题目附件</strong></p>
<p><a href="Ea5y_RSA.zip">Ea5y_RSA.zip</a></p>
<h4 id="思路">思路</h4>
<p>Ea5y_rsa.ets里面有密文： <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nlRTOIr7P61VxeNDiPtFd65VCBJWhKlpSMF+g7Fib3VYHZYc/kgNWeFHSMvcgsqWuBCfMkB90SPQDR6hKvaxhYrqLAg/8+rRWqZbL7hXD3s2JA92V8zgx18r9zmekS28UiTUTUZDkkAhhkrWFvdx3gqgxGwj/l+DX82StHiyyOo=</span><br></pre></td></tr></table></figure></p>
<p>hint.txt里面的gift有部分私钥： <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00300d06092a864886f70d0101010500048202623082025e02010002818100a2f1fcc64fe2cb96aad3af057fdc9ad7fabe7d032b0fd6ef7a94af14d0adf155a85cb56edca219cd9f6077b41321093422890466a6c38ecc01f78c8db85c0ea27bd0a066709ac282688b8d0a3694a0a464f5d0292767a087636c0fe7dbfff92372836c4690b676fdde73b5479b46878d2449ddcd921f0837b52e6f7fd065b9dd02030100010281802b0d8d2048d33fbf9b7b3aef550d50cc6830148fd5bce5a978d5f83ca3b691e1740eaad193f230a727c931579f06478c42e3b909f65e0d48d1ec3a72e7974b362f59f5d3f871a2bd65bd44a8a503dd17b0b74e38b396c63f7e83dfa5ef203b9ebbcddfd3e4376b1388f1a9ce83225fe1</span><br></pre></td></tr></table></figure></p>
<p>只能提取出1024bit的n和d的高896bit: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x00a2f1fcc64fe2cb96aad3af057fdc9ad7fabe7d032b0fd6ef7a94af14d0adf155a85cb56edca219cd9f6077b41321093422890466a6c38ecc01f78c8db85c0ea27bd0a066709ac282688b8d0a3694a0a464f5d0292767a087636c0fe7dbfff92372836c4690b676fdde73b5479b46878d2449ddcd921f0837b52e6f7fd065b9dd</span></span><br><span class="line">dh = <span class="number">0x2b0d8d2048d33fbf9b7b3aef550d50cc6830148fd5bce5a978d5f83ca3b691e1740eaad193f230a727c931579f06478c42e3b909f65e0d48d1ec3a72e7974b362f59f5d3f871a2bd65bd44a8a503dd17b0b74e38b396c63f7e83dfa5ef203b9ebbcddfd3e4376b1388f1a9ce83225fe1</span></span><br></pre></td></tr></table></figure></p>
<h4 id="exp">exp</h4>
<p>d高位泄露攻击： <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line">c = <span class="string">&#x27;nlRTOIr7P61VxeNDiPtFd65VCBJWhKlpSMF+g7Fib3VYHZYc/kgNWeFHSMvcgsqWuBCfMkB90SPQDR6hKvaxhYrqLAg/8+rRWqZbL7hXD3s2JA92V8zgx18r9zmekS28UiTUTUZDkkAhhkrWFvdx3gqgxGwj/l+DX82StHiyyOo=&#x27;</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">0x00a2f1fcc64fe2cb96aad3af057fdc9ad7fabe7d032b0fd6ef7a94af14d0adf155a85cb56edca219cd9f6077b41321093422890466a6c38ecc01f78c8db85c0ea27bd0a066709ac282688b8d0a3694a0a464f5d0292767a087636c0fe7dbfff92372836c4690b676fdde73b5479b46878d2449ddcd921f0837b52e6f7fd065b9dd</span></span><br><span class="line">dh = <span class="number">0x2b0d8d2048d33fbf9b7b3aef550d50cc6830148fd5bce5a978d5f83ca3b691e1740eaad193f230a727c931579f06478c42e3b909f65e0d48d1ec3a72e7974b362f59f5d3f871a2bd65bd44a8a503dd17b0b74e38b396c63f7e83dfa5ef203b9ebbcddfd3e4376b1388f1a9ce83225fe1</span></span><br><span class="line">leakbit = <span class="number">112</span> * <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(leakbit)</span><br><span class="line"></span><br><span class="line">k = e * (dh &lt;&lt; (<span class="number">1024</span> - leakbit)) // n + <span class="number">1</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(RealField(<span class="number">2048</span>))</span><br><span class="line">f = e * (dh &lt;&lt; ((<span class="number">1024</span> - leakbit))) * x - x - k * (x - <span class="number">1</span>) * (n- x)</span><br><span class="line">r = f.roots()</span><br><span class="line">ph = <span class="built_in">int</span>(r[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = ph + x</span><br><span class="line">pl = <span class="built_in">int</span>(f.small_roots(X=<span class="number">2</span>**<span class="number">200</span>, beta=<span class="number">0.49</span>, epsilon=<span class="number">0.02</span>)[<span class="number">0</span>])</span><br><span class="line">p = ph + pl</span><br><span class="line">q = n // p</span><br><span class="line">c = bytes_to_long(b64decode(c))</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p * q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
flag{01D_W1Ne_in_4_n3W_80t7lE_HAh4hAH4h4}</p>
<h3 id="small-message-for-sm4-encryption">Small Message For (SM4)
Encryption</h3>
<p><strong>题目描述</strong> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SM4 is a block cipher, standardised for commercial cryptography in China. It is used in the Chinese National Standard for Wireless LAN WAPI (WLAN Authentication and Privacy Infrastructure), and with Transport Layer Security.</span><br><span class="line"></span><br><span class="line">It seems to be very secure... But what if someone implement it insecurely?</span><br></pre></td></tr></table></figure></p>
<p><strong>题目附件</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4, func</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG, secret_message</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">key, plaintext, iv</span>):</span><br><span class="line">    cipher = sm4.CryptSM4(sm4.SM4_ENCRYPT, <span class="number">0</span>)</span><br><span class="line">    cipher.set_key(key, sm4.SM4_ENCRYPT)</span><br><span class="line">    ciphertext = cipher.crypt_cbc(iv,plaintext)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key = secret_message</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(key) &lt; <span class="number">16</span>:</span><br><span class="line">        key += secret_message</span><br><span class="line">    key = key[:<span class="number">16</span>]</span><br><span class="line">    iv = urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    plaintext = <span class="string">b&quot;My FLAG? If you want it, I&#x27;ll let you have it... search for it! I left all of it at that place: &quot;</span> + FLAG</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(plaintext) % <span class="number">16</span> == <span class="number">0</span>, <span class="string">&quot;The message must be a multiple of 16 bytes.&quot;</span></span><br><span class="line">    ciphertext = encrypt(key, plaintext, iv)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Ciphertext: <span class="subst">&#123;ciphertext.<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;What is this: <span class="subst">&#123;xor(key, iv).<span class="built_in">hex</span>()&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></p>
<h4 id="exp-1">exp</h4>
<p>让ai写一个爆破secret_message的脚本 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm4, func</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知数据</span></span><br><span class="line">ciphertext_hex = <span class="string">&quot;d9ea43b0d208aa168e4a275a69df3bc86051e756f9ca7959b68c6b23c9e1b69c19e08b75938375a6be830d1844d8a6e368faf1ddffecea69b5abe00ac0d6e10d6696be33d40e83a272072fbe131f98c82587011f61f2d58a020c8c54cf9b651abd740a3d55d36daa9c88cfc10a520ce4211fba4365ce98b82355b17c64dd2de4800fc68df36cfa8a3fd05baac6970dcd&quot;</span></span><br><span class="line">xor_key_iv_hex = <span class="string">&quot;ee278c4e526ff15b8d308b6b18f83221&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节</span></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(ciphertext_hex)</span><br><span class="line">xor_key_iv = <span class="built_in">bytes</span>.fromhex(xor_key_iv_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可能的字符集 (可打印ASCII)</span></span><br><span class="line">charset = string.printable.strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">key, ciphertext, iv</span>):</span><br><span class="line">    cipher = sm4.CryptSM4(sm4.SM4_DECRYPT, <span class="number">0</span>)</span><br><span class="line">    cipher.set_key(key, sm4.SM4_DECRYPT)</span><br><span class="line">    plaintext = cipher.crypt_cbc(iv, ciphertext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_secret_message</span>():</span><br><span class="line">    <span class="comment"># 尝试1-16字节长度的secret_message</span></span><br><span class="line">    <span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Trying length: <span class="subst">&#123;length&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 生成所有可能的组合</span></span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> itertools.product(charset, repeat=length):</span><br><span class="line">            secret = <span class="string">&#x27;&#x27;</span>.join(candidate)</span><br><span class="line">            <span class="comment"># 扩展key到16字节</span></span><br><span class="line">            key = (secret * (<span class="number">16</span> // <span class="built_in">len</span>(secret) + <span class="number">1</span>))[:<span class="number">16</span>].encode()</span><br><span class="line">            <span class="comment"># 计算iv</span></span><br><span class="line">            iv = <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(key, xor_key_iv))</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                plaintext = decrypt(key, ciphertext, iv)</span><br><span class="line">                <span class="comment"># 检查解密结果是否符合预期格式</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&quot;My FLAG? If you want it&quot;</span> <span class="keyword">in</span> plaintext:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Found secret_message: <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Decrypted plaintext: <span class="subst">&#123;plaintext&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="comment"># 提取FLAG</span></span><br><span class="line">                    flag_start = plaintext.find(<span class="string">b&quot;flag&#123;&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_start != -<span class="number">1</span>:</span><br><span class="line">                        flag_end = plaintext.find(<span class="string">b&quot;&#125;&quot;</span>, flag_start) + <span class="number">1</span></span><br><span class="line">                        flag = plaintext[flag_start:flag_end].decode()</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;FLAG found: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="keyword">return</span> secret, flag</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    secret_message, flag = brute_force_secret_message()</span><br><span class="line">    <span class="keyword">if</span> secret_message:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Success! secret_message: &#x27;<span class="subst">&#123;secret_message&#125;</span>&#x27;, FLAG: &#x27;<span class="subst">&#123;flag&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Failed to find the secret_message and FLAG.&quot;</span>)</span><br></pre></td></tr></table></figure>
flag{tHe_m3s5ag3_1s_2_sMa11!11!}</p>
<h3 id="weak_random">Weak_random</h3>
<p><strong>题目描述</strong> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一道弱伪随机数生成器题目，密钥的生成过程存在严重漏洞。</span><br></pre></td></tr></table></figure></p>
<p><strong>题目附件</strong> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag)==<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">message</span>):</span><br><span class="line">    padding_len = <span class="number">16</span> - <span class="built_in">len</span>(message)%<span class="number">16</span></span><br><span class="line">    ret = <span class="built_in">hex</span>(padding_len)[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(ret*padding_len)+message</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_weak_entropy</span>():</span><br><span class="line">    time_now=time.time()%<span class="number">10000</span></span><br><span class="line"></span><br><span class="line">    entropy_part1 = <span class="built_in">int</span>(time_now) &amp; <span class="number">0xFFFF</span> </span><br><span class="line"></span><br><span class="line">    entropy_part2 = os.getpid() &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    final_seed = entropy_part1 + (entropy_part2 &lt;&lt; <span class="number">8</span>) </span><br><span class="line">    random.seed(final_seed)</span><br><span class="line">    </span><br><span class="line">    key = random.getrandbits(<span class="number">128</span>) </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line">entropy_key=get_weak_entropy()</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">key_bytes = entropy_key.to_bytes(<span class="number">16</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">msg=padding(flag.encode())</span><br><span class="line">aes = AES.new(key_bytes,AES.MODE_CBC,iv=iv)</span><br><span class="line">enc = aes.encrypt(msg)</span><br><span class="line"><span class="built_in">print</span>(enc.<span class="built_in">hex</span>())</span><br><span class="line">check=hashlib.sha256(flag.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()  </span><br><span class="line"><span class="built_in">print</span>(check)</span><br><span class="line"><span class="comment">#enc=e88b2eb25b22929b2eb84898bc2c620c8798637ab64b892c218c83a0e523580f6c5772c84461f09045b6bce48c102a5f</span></span><br><span class="line"><span class="comment">#check=83d92dc441e420587b2eb46f46ca424597af97a88f0da1b64243e287c69aa645</span></span><br></pre></td></tr></table></figure></p>
<h4 id="exp-2">exp</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">enc = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;e88b2eb25b22929b2eb84898bc2c620c8798637ab64b892c218c83a0e523580f6c5772c84461f09045b6bce48c102a5f&quot;</span>)</span><br><span class="line">check = <span class="string">&quot;83d92dc441e420587b2eb46f46ca424597af97a88f0da1b64243e287c69aa645&quot;</span></span><br><span class="line"></span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> seed <span class="keyword">in</span> trange(<span class="number">0</span>, <span class="number">256</span>*<span class="number">256</span> + <span class="number">10000</span>):</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    key = random.getrandbits(<span class="number">128</span>).to_bytes(<span class="number">16</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv=iv)</span><br><span class="line">    msg = aes.decrypt(enc)[<span class="number">16</span>:]</span><br><span class="line">    <span class="keyword">if</span> hashlib.sha256(msg).hexdigest() == check:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">b&quot;flag&#123;&quot;</span> + msg + <span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>flag{9848ca46c1c1cc9db4246566b275d3c8}</p>
<h3 id="simple-lll">Simple LLL</h3>
<p><strong>题目描述</strong> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">simple lattice but openharmony</span><br></pre></td></tr></table></figure></p>
<p><strong>题目附件</strong></p>
<p><a href="Simple%20LLL.zip">Simple_LLL.zip</a></p>
<h4 id="思路-1">思路</h4>
<p>解压后发现是个鸿蒙逆向，拿<a target="_blank" rel="noopener" href="https://github.com/ohos-decompiler/abc-decompiler/releases">https://github.com/ohos-decompiler/abc-decompiler/releases</a>工具反编译。</p>
<p>核心加密如下： <img src="/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/enc.png"></p>
<p>即我们可以得到50组如下形式的<span class="math inline">\(c_i\)</span>： <span class="math display">\[
c_i = r_i*q + (g^{m_i}s_i \mod p)
\]</span> 其中<span class="math inline">\(r_i\)</span>，<span class="math inline">\(q\)</span>相对<span class="math inline">\(p\)</span>较小，所以直接用正交格加离散对数就解掉了</p>
<h4 id="exp-3">exp</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits</span><br><span class="line"></span><br><span class="line">a = [<span class="number">45596599146517595769213567008027354990530152281109573038863246709378806226257335310766479851680188494182323525530530505256</span>, <span class="number">62432374431437591826734273911812391207656242897401885268127107607214388994256327721530322212234111642476641341569615655775</span>, <span class="number">66640867270680683651105915351782232550272910743762721024149499622223272317021218813086665442488154134536635091168151679262</span>, <span class="number">76568791607439426429890581080326982594324744169701114653618996191036247280167861065425161127891911640115719874949519513409</span>, <span class="number">80505764860782440798434567134832555598469365799962186558947545820389077349592175372099995788813126347559362498096484561087</span>, <span class="number">49886762049415620162731028873582943421775694364410242029122769830561241631714493053920164993309711714828904752810911376673</span>, <span class="number">63764608791300251401000140557122880801227171628942028982810331285921668215965127876492165610922306217924951340692885034445</span>, <span class="number">75150749592297738434833716596208117968146378967070896331493267301751508105379281839545556616649489492862396168011336629860</span>, <span class="number">64640885967491510460161437267821813741190981731057014520820089056784197782061031601387968993783090906716081424349788858131</span>, <span class="number">64437291571761719605154322068355171624572928894219031137168295198426051411772641573978100287013420825453909253049882111608</span>, <span class="number">66504977482535802726769039193408744223638783830651957559642117606942253995141503865661025618554702478031262816698525032136</span>, <span class="number">76002568717709562873915527551148914168997623756300359592451412016772230012774064201866937923034345062382027041394993181454</span>, <span class="number">63266985974944409749869963721110410312519236858231888474633226073550935799575298125269866699330196788217453515960042308014</span>, <span class="number">41378678610694150590920910285112607982977816143559599698344863434208418190795670372530100158282880873585095139346542182207</span>, <span class="number">47095714976926850579359360089815975293364468242683704814212607488560707212600108415692525003584392669639960496824687225871</span>, <span class="number">81712279014270911594566324410970967065420131442219991825217142864252526122573901396406765443368883802863522142841038531059</span>, <span class="number">46899315688285826493888208674882803737623349293461166939548270777452716728288162058211757343071983713080383903753175566525</span>, <span class="number">77001953210338837057924001273567386417735976768153786434377740557131463743054441573962638411859255662145059533392768151159</span>, <span class="number">61344092790836117616593559739714992543552126735084182427898958666452402020794852886254745796680655750124380725951855048010</span>, <span class="number">41798537018707926245084694076262041173943033079080146970126525132704066495699601424087894987780276017360809502522616125394</span>, <span class="number">63387993920920122367999624086483629563252946113412688583890185139461926238435833641040933872789534901371558025032872075509</span>, <span class="number">73308599701131409464380487348189364538310423897958233779818170276256490392349086950293706361381652255418906670559849023338</span>, <span class="number">79656592431138093729170996132259461695478861668300598583789836126987243595249158493470453092373692862598725554307228872775</span>, <span class="number">66686609349363352414174552287289340779849453906905378709020779878225151601984410724395496186873990929643813847426883168892</span>, <span class="number">73629238580972114305567044343530088917932511220527756471428594467552523423255130084899098302915123830683981111535738601638</span>, <span class="number">49498906417357835892520675114611644052169603417532472178901453472582291336119172842035513537774428033797593014512677351435</span>, <span class="number">52174217475092237597936231689235487926615205995485347429534522208443240578238018451973609326577546098568499813741462015539</span>, <span class="number">80047762077509250355763047192733755477123946490832613760007651778991838965572319380438868001156427212461586278039816493826</span>, <span class="number">65093211867471012814356995410138867637862719476444799545940055034242517927221160325208221269710241764401111566664350993658</span>, <span class="number">46011244750481202278149073625755585684260386245667515244622055779661135900620865355790231322990781098608449420272236827649</span>, <span class="number">53117509020129498861968904973153083766481628602843082575566170552766982459112237988922328578653333150309738552227954392141</span>, <span class="number">55459188663102328389961593038479425938901985433225942468392445820718629229313178400426180281496533959937344423076984430674</span>, <span class="number">78444745613219318304755274100121829802982955598779086342705126567561388206659867698016883565928585796097381260797922655519</span>, <span class="number">43958732315072668909629997482365926883011682959499021501879834969759552915014043651906394862009078183350949233959094932805</span>, <span class="number">61305435387549084308484680178646146929431427882044457046211844779552509450815730509488874603808230047212187842781103455153</span>, <span class="number">70637259106230458373333494078168198926256656499333956870221228138617427598610924695021659385808327535049122557717095889661</span>, <span class="number">65488728024961307175054135997812474419797386013099712092129340958152238442655356597216364171923967429155549425314004976747</span>, <span class="number">41625960760631805176266652837586144901306841022437321127731795763904181671613462308134640764955282404049919880515527122098</span>, <span class="number">71963979924766202542689152185192891354279089665062029590009513136963032846334363384099417013523272240110934926309168051428</span>, <span class="number">80251778335603398358629896861168846340221689717009306678229176648582836983027616322956600208242209788987847059377353910549</span>, <span class="number">70284032408930923412572260535342969184801973281722349552207656726600064883190098349426312634152674923127303108515857786319</span>, <span class="number">42017603985852991154545640679246147284482910315115721206206452863103006355613789016611463239370863506027749335463578575305</span>, <span class="number">69877399809833254387653649392946328765278216825706254792870473350054372563698919553742183921227432721214640597147524631246</span>, <span class="number">53857121890842582862177371083826128456199075709482866213895717527182513045934317770490721788186406883690528462156380898247</span>, <span class="number">64001232528214466569851169431725495993460092493119013330479471106567913343082607991839399906226146294179112946412714353633</span>, <span class="number">68794934824127239944040431762674854475686621190929074032646726399953434603694936833899174892998387998834509107900100986371</span>, <span class="number">68966508075486889501108784849699866656588246221931458138799356947047368779859934967665457687684069221994712578788436679754</span>, <span class="number">76000714031230558195498090452755463892015002095887478759556871466937829860283192442760605574465753606694091015079927493429</span>, <span class="number">65889577129438227733404759215735188782970893752143620491220200742094265192946367814381845991305876972823427075367837470223</span>, <span class="number">78057186896723223998512735748769800421682091882992425661700127016657965666059373278973633235161094736796529787276595121298</span>]</span><br><span class="line">M = column_matrix(a)</span><br><span class="line">M *= getPrime(<span class="number">1024</span>)</span><br><span class="line">M = M.augment(identity_matrix(M.nrows()))</span><br><span class="line">ML = M.LLL()</span><br><span class="line"></span><br><span class="line">K = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    <span class="keyword">assert</span> ML[i][<span class="number">0</span>] == <span class="number">0</span></span><br><span class="line">    K.append(ML[i][<span class="number">1</span>:])</span><br><span class="line">K = matrix(K)</span><br><span class="line">KK = K.right_kernel_matrix().LLL()</span><br><span class="line">m_ = KK[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">if</span> m_[<span class="number">0</span>] &lt; <span class="number">0</span>:</span><br><span class="line">    m_ *= -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;Lattice-based cryptography is the generic term for constructions of cryptographic primitives that involve &quot;</span>[:<span class="number">50</span>]</span><br><span class="line">P = <span class="number">910927656194791222517913045809166069831899969390111</span></span><br><span class="line">G = <span class="number">181486661693304272005374759243600368243</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">49</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    gm = m_[i] * <span class="built_in">pow</span>(<span class="built_in">ord</span>(s[i]), -<span class="number">1</span>, P)</span><br><span class="line">    m = discrete_log_lambda(Mod(gm, P), Mod(G, P), bounds=(<span class="number">2</span>**<span class="number">16</span>, <span class="number">2</span>**<span class="number">24</span>))</span><br><span class="line">    flag = long_to_bytes(m).decode() + flag</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b8fdba363c31f3a4cadaf5289e0bf4fb578f2a5e28dcdb8fdba363c31f3a4cadaf5289e0bf4fb578f2a5e28dcdb8fdba363c31f3a4cadaf5289e0bf4fb578f2a5e28dcdb8fdba363c31f3a</span></span><br></pre></td></tr></table></figure>
<p>最后解出来这一串不是flag，flag是子串b8fdba363c31f3a4cadaf5289e0bf4fb578f2a5e28dcd。。。</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>FariTree
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/" title="2025OpenHarmonyCTF-Crypto-WP">http://example.com/2025/06/08/2025OpenHarmonyCTF-Crypto-WP/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"><i class="fa fa-tag"></i> CTF</a>
              <a href="/tags/OL-attack/" rel="tag"><i class="fa fa-tag"></i> OL-attack</a>
              <a href="/tags/DLP/" rel="tag"><i class="fa fa-tag"></i> DLP</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/01/2025D%5E3CTF-Crypto-WP/" rel="prev" title="2025D^3CTF-Crypto-WP">
                  <i class="fa fa-angle-left"></i> 2025D^3CTF-Crypto-WP
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">FariTree</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>





</body>
</html>
