<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2025HXCTFåˆèµ›-Crypto-WP</title>
    <url>/2025/05/11/2025HXCTF%E5%88%9D%E8%B5%9B-Crypto-WP/</url>
    <content><![CDATA[<p>ç»™å­¦æ ¡æ–°ç”Ÿèµ›å‡ºçš„é¢˜ï¼Œå‡ºçš„ä¸ç®—éš¾ï¼Œä½†æ˜¯æ–°ç”Ÿå¥½åƒæ²¡å‡ ä¸ªå­¦å¯†ç çš„ã€‚ã€‚ã€‚
<span id="more"></span></p>
<h3 id="é€ä½ å¼—è±æ ¼">é€ä½ å¼—è±æ ¼</h3>
<p>ä¸€çœ¼æ‘©æ–¯å¯†ç ï¼Œå‘ç°â€œå˜€â€æ€»æ˜¯å•ç‹¬å‡ºç°ï¼ŒçŒœæµ‹æ˜¯ç©ºæ ¼ï¼Œâ€œæ»´â€æ˜¯â€œ.â€ï¼Œâ€œå—’â€æ˜¯
â€œ-â€ã€‚ å†™ä¸ªè„šæœ¬æ›¿æ¢ä¸€ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cipher = <span class="string">&quot;æ»´æ»´æ»´æ»´å˜€å—’æ»´æ»´å—’å˜€å—’æ»´å—’æ»´å˜€å—’å˜€æ»´æ»´å—’æ»´å˜€å—’å—’å—’å—’æ»´å—’å—’å˜€å—’å—’å˜€å—’å—’å—’å˜€æ»´å—’æ»´å˜€æ»´æ»´æ»´å˜€æ»´å˜€æ»´æ»´å—’å—’æ»´å—’å˜€å—’æ»´å—’æ»´å˜€å—’å—’å—’å˜€å—’æ»´æ»´å˜€æ»´å˜€æ»´æ»´å—’å—’æ»´å—’å˜€æ»´æ»´å˜€æ»´æ»´æ»´å˜€æ»´æ»´å—’å—’æ»´å—’å˜€æ»´æ»´å—’æ»´å˜€æ»´æ»´å—’å˜€å—’æ»´å˜€å—’æ»´å˜€å—’æ»´å—’å—’å˜€å—’å—’å—’å—’å—’æ»´å—’&quot;</span></span><br><span class="line">convet = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> cipher:</span><br><span class="line">    <span class="keyword">match</span> c:</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;æ»´&quot;</span>:</span><br><span class="line">            convet += <span class="string">&quot;.&quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;å˜€&quot;</span>:</span><br><span class="line">            convet += <span class="string">&quot; &quot;</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;å—’&quot;</span>:</span><br><span class="line">            convet += <span class="string">&quot;-&quot;</span></span><br><span class="line"><span class="built_in">print</span>(convet)</span><br><span class="line"><span class="comment"># .... -..- -.-. - ..-. ----.-- -- --- .-. ... . ..--.- -.-. --- -.. . ..--.- .. ... ..--.- ..-. ..- -. -. -.-- -----.-</span></span><br></pre></td></tr></table></figure>
<p>HXCTF{MORSE_CODE_IS_FUNNY}</p>
<h3 id="classic">Classic</h3>
<p>æ³¨æ„åˆ°å¯†æ–‡åˆ†ä¸‰å­—èŠ‚ä¸€ç»„ï¼Œæ¯ç»„å¼€å¤´éƒ½æ˜¯e5ï¼Œe6ï¼ŒçŒœæµ‹æ˜¯UTF-8ç¼–ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">c = <span class="string">&quot;e585ace6ada3e887aae794b1e585ace6ada3e69687e6988ee5928ce8b090e585ace6ada3e585ace6ada3e69687e6988ee5928ce8b090e69687e6988ee585ace6ada3e5b9b3e7ad89e5928ce8b090e887aae794b1e5928ce8b090e6b395e6b2bbe585ace6ada3e5928ce8b090e5928ce8b090e695ace4b89ae5928ce8b090e69687e6988ee5928ce8b090e585ace6ada3e585ace6ada3e585ace6ada3e5928ce8b090e887aae794b1e5928ce8b090e5af8ce5bcbae5928ce8b090e5928ce8b090e585ace6ada3e585ace6ada3e5928ce8b090e5af8ce5bcbae5928ce8b090e69687e6988ee585ace6ada3e6b091e4b8bbe585ace6ada3e5b9b3e7ad89e5928ce8b090e695ace4b89ae585ace6ada3e69687e6988ee585ace6ada3e6b091e4b8bbe585ace6ada3e585ace6ada3e5928ce8b090e5af8ce5bcbae5928ce8b090e5928ce8b090e5928ce8b090e6b091e4b8bbe585ace6ada3e887aae794b1e5928ce8b090e6b395e6b2bbe5928ce8b090e69687e6988ee585ace6ada3e6b091e4b8bbe585ace6ada3e6b091e4b8bbe5928ce8b090e6b091e4b8bbe585ace6ada3e6b091e4b8bbe5928ce8b090e6b091e4b8bbe5928ce8b090e585ace6ada3e5928ce8b090e5af8ce5bcbae585ace6ada3e585ace6ada3e585ace6ada3e5928ce8b090e5928ce8b090e5928ce8b090e5928ce8b090e788b1e59bbd&quot;</span></span><br><span class="line">c = <span class="built_in">bytes</span>.fromhex(c)</span><br><span class="line"><span class="built_in">print</span>(c.decode())</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">å…¬æ­£è‡ªç”±å…¬æ­£æ–‡æ˜å’Œè°å…¬æ­£å…¬æ­£æ–‡æ˜å’Œè°æ–‡æ˜å…¬æ­£å¹³ç­‰å’Œè°è‡ªç”±å’Œè°æ³•æ²»å…¬æ­£å’Œè°å’Œè°æ•¬ä¸šå’Œè°æ–‡æ˜å’Œè°å…¬æ­£å…¬æ­£å…¬æ­£å’Œè°è‡ªç”±å’Œè°å¯Œå¼ºå’Œè°å’Œè°å…¬æ­£å…¬æ­£å’Œè°å¯Œå¼ºå’Œ è°æ–‡æ˜å…¬æ­£æ°‘ä¸»å…¬æ­£å¹³ç­‰å’Œè°æ•¬ä¸šå…¬æ­£æ–‡æ˜å…¬æ­£æ°‘ä¸»å…¬æ­£å…¬æ­£å’Œè°å¯Œå¼ºå’Œè°å’Œè°å’Œè°æ°‘ä¸»å…¬æ­£è‡ªç”±å’Œè°æ³•æ²»å’Œè°æ–‡æ˜å…¬æ­£æ°‘ä¸»å…¬æ­£æ°‘ä¸»å’Œè°æ°‘ä¸»å…¬æ­£æ°‘ä¸»å’Œè°æ°‘ä¸»å’Œè° å…¬æ­£å’Œè°å¯Œå¼ºå…¬æ­£å…¬æ­£å…¬æ­£å’Œè°å’Œè°å’Œè°å’Œè°çˆ±å›½</span><br></pre></td></tr></table></figure>
<p>ç„¶åç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£ç å¾—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">db6b2e47c926f403f02ae9baf031d72aa1a160fc38</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®é¢˜ç›®æè¿°ï¼ŒçŒœæµ‹æ˜¯ä»¿å°„åŠ å¯†ï¼Œæ‰€ä»¥çˆ†ç ´å¯†é’¥ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cipher = <span class="string">&quot;db6b2e47c926f403f02ae9baf031d72aa1a160fc38&quot;</span></span><br><span class="line">cipher = <span class="built_in">bytes</span>.fromhex(cipher)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">256</span>, <span class="number">2</span>):</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">256</span>):</span><br><span class="line">        flag = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> cipher:</span><br><span class="line">            flag += <span class="built_in">chr</span>((a*c + b) % <span class="number">256</span>)</span><br><span class="line">        <span class="keyword">if</span> flag.startswith(<span class="string">&quot;HXCTF&#123;&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># HXCTF&#123;Y0u_found_^^e!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="base16">base^{16}</h3>
<p>è¿™é¢˜ä¸»è¦æ˜¯æƒ³è®©å¤§å®¶å†™è„šæœ¬ï¼Œç¨å¾®è¯•è¯•å¯ä»¥å‘ç°æ˜¯äº¤æ›¿çš„base64å’Œbase91ï¼Œå¾ªç¯äº†16è½®ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base91</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">r&quot;enc.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">cipher = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    cipher = base91.decode(cipher.decode())</span><br><span class="line">    cipher = base64.b64decode(cipher)</span><br><span class="line"><span class="built_in">print</span>(cipher)</span><br><span class="line"><span class="comment"># HXCTF&#123;B6bbAa@ass5ssEee36b6644A4&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezrsa">ezRSA</h3>
<p>ä»åå¾€å‰é€’å½’æ¢å¤på°±è¡Œã€‚</p>
<p>å‡è®¾å’Œå·²ç»çŸ¥é“pï¼Œ qçš„åk
bitsï¼Œç„¶åæšä¸¾pçš„åç¬¬k+1ä¸ªæ¯”ç‰¹ï¼Œé€šè¿‡ä¸‹å¼æ¢å¤qçš„åç¬¬k+1ä¸€ä¸ªæ¯”ç‰¹ï¼š <span class="math display">\[
q_k = p_k \oplus leak_k
\]</span></p>
<p>ç„¶åæ£€æŸ¥æ˜¯å¦æ»¡è¶³ï¼š <span class="math display">\[
((q_{k+1} &lt;&lt; k) + q_{lsb})((p_{k+1} &lt;&lt; k) + p_{lsb}) \equiv
n \mod 2^{k+1}
\]</span></p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">20581338524773710931014796705060927721164022110933170236907622868446276673276379960074983874694013071501404205921712458516719528791313217075372120292540769607768267213148470047192533783356651951103773544607365700830304720348095357381720861732062131428306950367835186817770742714377511664088124921726109762611</span></span><br><span class="line">n = <span class="number">131955690538161673663979223798074678499726259420694182793841613919440640794173261722991102718429029438380697505701015619452283142119487944084622078736557807531823541140258838261464844922518316272881433984179091296264635187662962573084675257499354062781067172877584482339564742280505536614114067794677477277487</span></span><br><span class="line">leak = <span class="number">2854831492248561377973114517344274987491834433439026310389937614171692082857812555747188089670141576752295596881129854180086210600895683598247563627762686</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">p_lsb, k</span>):</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">512</span>:</span><br><span class="line">        <span class="keyword">return</span> [p_lsb]</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        p = (bit &lt;&lt; k) + p_lsb</span><br><span class="line">        q = leak ^ p</span><br><span class="line">        <span class="keyword">if</span> (p*q - n) % (<span class="number">2</span>**(k+<span class="number">1</span>)) == <span class="number">0</span>:</span><br><span class="line">            result.extend(recover(p, k+<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">result = recover(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> res <span class="keyword">in</span> result:</span><br><span class="line">    <span class="keyword">if</span> n % res == <span class="number">0</span>:</span><br><span class="line">        p = res</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n // p</span><br><span class="line">d = <span class="built_in">pow</span>(<span class="number">65537</span>, -<span class="number">1</span>, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p * q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># HXCTF&#123;7his_i5_the_r3al_s1gn-in_que5ti0n&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="weaksystem">WeakSystem</h3>
<p>å¯†æ–‡ç©ºé—´å¤§å°åªæœ‰<span class="math inline">\(A_8^8\)</span>ï¼Œæ‰€ä»¥ç›´æ¥æšä¸¾keyå°±è¡Œï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations, product</span><br><span class="line">cipher = [<span class="number">9</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">81</span>, <span class="number">97</span>, <span class="number">187</span>, <span class="number">195</span>, <span class="number">131</span>, <span class="number">179</span>, <span class="number">155</span>, <span class="number">123</span>, <span class="number">195</span>, <span class="number">233</span>, <span class="number">163</span>, <span class="number">177</span>, <span class="number">155</span>, <span class="number">145</span>, <span class="number">209</span>, <span class="number">235</span>, <span class="number">123</span>, <span class="number">115</span>, <span class="number">137</span>, <span class="number">131</span>, <span class="number">209</span>, <span class="number">123</span>, <span class="number">163</span>, <span class="number">131</span>, <span class="number">233</span>, <span class="number">123</span>, <span class="number">11</span>, <span class="number">123</span>, <span class="number">179</span>, <span class="number">131</span>, <span class="number">155</span>, <span class="number">219</span>]</span><br><span class="line">key = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">all_key = <span class="built_in">list</span>(permutations(key))</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> all_key:</span><br><span class="line">    flag = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">        binc = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bin</span>(cipher[i])[<span class="number">2</span>:].zfill(<span class="number">8</span>)]</span><br><span class="line">        c_ = [binc[key[j]] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c_)):</span><br><span class="line">            c &lt;&lt;= <span class="number">1</span></span><br><span class="line">            c ^= c_[j]</span><br><span class="line">        flag += <span class="built_in">chr</span>(c)</span><br><span class="line">    <span class="keyword">if</span> flag.startswith(<span class="string">&quot;HXCTF&#123;&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># HXCTF&#123;easy_encrypto_What_can_I_say&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="weirvierwilson">WeirVierWilson</h3>
<p>è¿™é¢˜å°±è€ƒäº†ä¸€ä¸ªå¨å°”é€Šå®šç†ï¼Œçœ‹é¢˜åä¹Ÿèƒ½çŒœåˆ°ã€‚</p>
<p>ä¸ºäº†åŠ é€Ÿè¿™ä¸ªå¾ªç¯ï¼Œä¸»è¦ç”¨åˆ°äº†ä¸‹é¢è¿™ä¸ªç­‰å¼ï¼š</p>
<p><span class="math display">\[
(p - 1)! \equiv -1 \mod p
\]</span></p>
<p>æ‰€ä»¥å®é™…ä¸Šåªéœ€è¦éå†ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p + <span class="number">1</span>, p + p.bit_length())</span><br></pre></td></tr></table></figure>
å°±å¯ä»¥æ±‚å‡ºç§é’¥ï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªç®€å•çš„RSAè§£å¯†ã€‚</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">prime = <span class="number">137507368993355914860594752037581031045352928887415381942526303684476934340258890988567168982905997088929819580321685527266991589958746449618579850907765883870406926066972236505061792661515022699471025570619211456282127086268577930799928025034487476640164726617790269194813768322066680097473281637077598071503</span></span><br><span class="line">n = <span class="number">135682573094891703553176370837232897617602270323588124823165101627726795394883393432665305493991941306105477252624327158129510957489322126803110534374827392252943932529899808378499467893344818778838011561390030105276983196848035629485680341851450845219061424892927388790415769446019942364106200260533601837319</span></span><br><span class="line">cipher = <span class="number">41622954513604406352873105855005440904638036223332018757506281634908104215433400850153277514829103000815542937837390595177169806358970750719651237435525099636604205350232352002592510801557603418471900545470844050105254021489131546373444583233001627136018732688443852250808321663559410660967027997290818817259</span></span><br><span class="line"></span><br><span class="line">d = -<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(prime + <span class="number">1</span>, prime + prime.bit_length()):</span><br><span class="line">    d = (d * i) % prime</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">pow</span>(cipher, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># HXCTF&#123;find_+he_f@c+ori@1_i5_very_5imp1e_wi+h_Wi15on&#x27;5_+heorem&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="babysign">babysign</h3>
<p>è¿™é¢˜è€ƒçš„æ˜¯DSAçº¿æ€§kæ”»å‡»ã€‚ä½†å…¶å®ç½‘ä¸Šå¾ˆå¤šæ–‡ç« ï¼Œç›´æ¥æ‹·æ‰“AIä¹Ÿèƒ½å‡ºã€‚ã€‚ã€‚</p>
<p>DSAåœ¨æ¯æ¬¡ç­¾åè¿‡ç¨‹ä¸­å¿…é¡»è¦é€‰ä¸€ä¸ªéšæœºæ•°kæ¥ä¿è¯ç§é’¥xä¸ä¼šæ³„éœ²ï¼Œè€Œè¿™é‡Œç”¨çš„éšæœºæ•°ç”Ÿæˆå™¨æ˜¯LCGæ˜¯çº¿æ€§çš„ï¼Œä¸å¤Ÿéšæœºã€‚
å…·ä½“åˆ©ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<p>æ ¹æ®DSAç­¾åçš„ç­‰å¼ï¼Œå¯ä»¥è·å–ä¸‹é¢ä¸¤ç»„ç­¾åï¼š</p>
<p><span class="math display">\[
\begin{gather}
s_1 \equiv (H(m) + xr_1)k_1^{-1} \mod q \\
s_2 \equiv (H(m) + xr_2)(ak_1 + b)^{-1} \mod q
\end{gather}
\]</span></p>
<p>è¿™é‡Œé¢åªæœ‰x,
k1ä¸¤ä¸ªæœªçŸ¥æ•°ï¼Œç›´æ¥è§£æ–¹ç¨‹å°±èƒ½å¾—åˆ°xï¼Œç„¶åå°±å¯ä»¥ä¼ªé€ ç­¾åäº†ã€‚</p>
<p>é€‰æ‰‹å¯ä»¥è‡ªå·±æ¨å¯¼è§£çš„è¡¨è¾¾å¼ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨äº†sageçš„solveå‡½æ•°ï¼Œä¸è¿‡å¯¹äºè¿™ç§ç®€å•çš„æ–¹ç¨‹ç»„ï¼Œgroebner_basisåº”è¯¥æ˜¯æœ€ç®€å•çš„ã€‚</p>
<p>exp.py:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, process</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">a = <span class="number">0xe4b39d062f5eaffe04fd8c302b8f956a43264ead</span></span><br><span class="line">b = <span class="number">0xb703a3ec8c6a9520e77d6bb14220abfde7d12dc6</span>        </span><br><span class="line">io = remote(<span class="string">&quot;43.139.51.42&quot;</span>, <span class="number">32838</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&quot;This is my pubkey: &quot;</span>)</span><br><span class="line">p, q, g, y = <span class="built_in">eval</span>(io.recvline().decode())</span><br><span class="line">io.recvuntil(<span class="string">b&quot;[+]: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;hijack&quot;</span>)</span><br><span class="line">msg1, r1, s1 = <span class="built_in">eval</span>(io.recvline().decode())</span><br><span class="line">msg1 = <span class="built_in">bytes</span>.fromhex(msg1)</span><br><span class="line">Hm1 = bytes_to_long(md5(msg1).digest())</span><br><span class="line">io.recvuntil(<span class="string">b&quot;[+]: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;hijack&quot;</span>)</span><br><span class="line">msg2, r2, s2 = <span class="built_in">eval</span>(io.recvline().decode())</span><br><span class="line">msg2 = <span class="built_in">bytes</span>.fromhex(msg2)</span><br><span class="line">Hm2 = bytes_to_long(md5(msg2).digest())</span><br><span class="line"></span><br><span class="line">x, k = var(<span class="string">&quot;x, k&quot;</span>)</span><br><span class="line">f1 = s1*k - Hm1 - x*r1</span><br><span class="line">f2 = s2*(a*k + b) - Hm2 - x*r2</span><br><span class="line">k_ = solve(f1, k)[<span class="number">0</span>].right()</span><br><span class="line">x = GF(q)(solve(f2(k=k_), x)[<span class="number">0</span>].right())</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;[+]: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&quot;verify&quot;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&quot;[+]: &quot;</span>)</span><br><span class="line">msg = <span class="string">b&quot;faritree&quot;</span></span><br><span class="line">Hm = bytes_to_long(md5(msg).digest())</span><br><span class="line">k = <span class="number">1111</span></span><br><span class="line">r = <span class="built_in">pow</span>(g, k, p) % q</span><br><span class="line">s = (Hm + x * r) * <span class="built_in">pow</span>(k, -<span class="number">1</span>, q) % q</span><br><span class="line">signature = msg.<span class="built_in">hex</span>() + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(r) + <span class="string">&quot;,&quot;</span> + <span class="built_in">str</span>(s)</span><br><span class="line">io.sendline(signature.encode())</span><br><span class="line"><span class="built_in">print</span>(io.recvline())</span><br><span class="line"><span class="built_in">print</span>(io.recvline())</span><br><span class="line">io.close()</span><br><span class="line"><span class="comment"># HXCTF&#123;D5A_1s_sa7e_but_LC6_n0t&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezdecision">ezDecision</h3>
<p>è¿™é¢˜éœ€è¦æˆ‘ä»¬åŒºåˆ†F1å’ŒF0ç”Ÿæˆçš„çŸ©é˜µï¼Œå¯ä»¥å‘ç°F1ç”Ÿæˆçš„çŸ©é˜µçš„è¡Œåˆ—å¼åªä¸Mæœ‰å…³ï¼Œè€ŒMçš„è¡Œåˆ—å¼æ¯”è¾ƒå°ï¼Œæ‰€ä»¥å¯ä»¥æ ¹æ®çŸ©é˜µçš„è¡Œåˆ—å¼æ¥åˆ¤æ–­ã€‚éœ€è¦æ³¨æ„ä¸€ä¸‹è¿™é‡Œçš„çŸ©é˜µæ˜¯mod
qä¸‹çš„çŸ©é˜µï¼Œæ‰€ä»¥æ¯”è¾ƒå°çš„å€¼è¡¨ç°ä¸ºæ¥è¿‘0æˆ–è€…æ¥è¿‘qã€‚</p>
<p>exp.sage:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    M = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    p = <span class="built_in">int</span>(f.readline())</span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> M:</span><br><span class="line">    mat = matrix(ZZ, [m[<span class="number">0</span>:<span class="number">3</span>], m[<span class="number">3</span>:<span class="number">6</span>], m[<span class="number">6</span>:<span class="number">9</span>]])</span><br><span class="line">    tmp = mat.det() % p </span><br><span class="line">    flag &lt;&lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> tmp &gt; p - <span class="number">10000</span> <span class="keyword">or</span> tmp &lt; <span class="number">10000</span>:</span><br><span class="line">        flag ^^= <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag ^^= <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"><span class="comment"># HXCTF&#123;Th3s3_m@trice5_ar3_n0t_di77icu1t_t0_di5tingu1sh&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ezotp">ezOTP</h3>
<p>è¿™é¢˜å®ç°äº†ä¸€ä¸ªé­”æ”¹çš„RC4ï¼Œæ²¡æœ‰å¯†é’¥ï¼Œä½†æ˜¯å¯ä»¥å‘ç°åœ¨swapéƒ¨åˆ†å¹¶ä¸æ˜¯çœŸçš„äº¤æ¢ï¼Œè€Œæ˜¯å¯¹å€¼è¿›è¡Œäº†åŒåŒ–ï¼Œæ‰€ä»¥çŒœæµ‹åœ¨åŠ å¯†åéƒ¨åˆ†æ—¶Sboxä¸­çš„å€¼å…¨éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥æšä¸¾Sboxï¼Œè·å–LCGçš„åé¢å‡ ä¸ªè¾“å‡ºï¼Œç„¶åæ¢å¤LCGï¼Œå¾—åˆ°AESçš„å¯†é’¥ã€‚</p>
<p>exp.sage:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, a, b, s</span>):</span><br><span class="line">        <span class="variable language_">self</span>.a = a</span><br><span class="line">        <span class="variable language_">self</span>.b = b</span><br><span class="line">        <span class="variable language_">self</span>.state = s</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = (<span class="variable language_">self</span>.a * <span class="variable language_">self</span>.state + <span class="variable language_">self</span>.b) % (<span class="number">2</span>**<span class="number">128</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.state</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    enc = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    cipher = <span class="built_in">eval</span>(f.readline())</span><br><span class="line">    </span><br><span class="line">total = <span class="built_in">len</span>(data)</span><br><span class="line"><span class="keyword">for</span> sbox <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    data = [sbox^^c <span class="keyword">for</span> c <span class="keyword">in</span> enc]</span><br><span class="line">    n = <span class="number">5</span></span><br><span class="line">    output = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        U128 = data[total - <span class="number">16</span>*(i + <span class="number">1</span>) : total - <span class="number">16</span>*i]</span><br><span class="line">        U128 = <span class="built_in">sum</span>([U128[i] &lt;&lt; <span class="number">8</span>*(<span class="number">15</span> - i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">        output = [U128] + output</span><br><span class="line">    <span class="comment"># print(output)</span></span><br><span class="line">    PR.&lt;a, b, s&gt; = PolynomialRing(Zmod(<span class="number">2</span>**<span class="number">128</span>))</span><br><span class="line">    x = [s]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        x.append(a*x[-<span class="number">1</span>] + b)</span><br><span class="line">    I = PR.ideal([x[i] - output[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line">    a, b, s = I.groebner_basis()[:<span class="number">3</span>]</span><br><span class="line">    a = <span class="number">2</span>**<span class="number">128</span> - a.constant_coefficient()</span><br><span class="line">    b = <span class="number">2</span>**<span class="number">128</span> - b.constant_coefficient()</span><br><span class="line">    s = <span class="number">2</span>**<span class="number">128</span> - s.constant_coefficient()</span><br><span class="line">    lcg = LCG(a, b, s)</span><br><span class="line">    [lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>)]</span><br><span class="line">    key = lcg.<span class="built_in">next</span>()</span><br><span class="line">    flag = AES.new(<span class="built_in">int</span>(key).to_bytes(<span class="number">16</span>, <span class="string">&quot;big&quot;</span>), mode=AES.MODE_ECB).decrypt(cipher)</span><br><span class="line">    <span class="keyword">if</span> flag.startswith(<span class="string">b&quot;HXCTF&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># HXCTF&#123;a_5maLl_m157aK3_L3Ad5_7O_a_hU93_prOBl3m&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="lfsr">lfsr</h3>
<p>å¾ˆå¸¸è§„çš„lfsrç ´è§£ã€‚</p>
<p>lfsråœ¨ç”Ÿæˆéšæœºæ•°çš„è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´åœ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ç”±128ä¸ªæ¯”ç‰¹æ„æˆï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒè®°ä½œï¼š</p>
<p><span class="math display">\[
\mathbf{state} = (s_1, s_2, \cdots, s_{128})
\]</span> åŠ å¯†è¿‡ç¨‹è¿˜éœ€è¦ä¸€ä¸ªæ©ç mask,æˆ‘ä»¬è®°ä½œï¼š <span class="math display">\[
\mathbf{mask} = (m_1, m_2, \cdots, m_{128})
\]</span>
ç„¶åå°†è¿™ä¸¤ä¸ªå‘é‡ä½œå†…ç§¯ï¼Œå¾—åˆ°çš„å°±æ˜¯è¾“å‡ºæ¯”ç‰¹ï¼Œè¦æ³¨æ„è¿™é‡Œçš„è¿ç®—æ˜¯åœ¨<span class="math inline">\(GF(2)\)</span>ä¸Šè¿›è¡Œçš„(å¯ä»¥ç®€å•çš„ç†è§£ä¸ºæ‰€æœ‰è¿ç®—éƒ½è¦æ¨¡2ï¼Œä¿è¯æ•°æ®åªæœ‰1æ¯”ç‰¹çš„å¤§å°)ã€‚é‚£ä¹ˆæ–°çš„çŠ¶æ€å¯ä»¥è¡¨ç¤ºä¸ºï¼š
<span class="math display">\[
\mathbf{state}^{&#39;} = ( s_2, s_3, \cdots, s_{128}, \mathbf{state}
\cdot \mathbf{mask}^T )
\]</span> æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå†™ä½œçŸ©é˜µå½¢å¼ï¼š <span class="math display">\[
\mathbf{state}^{&#39;} = \mathbf{state}
\begin{pmatrix}
&amp;&amp;&amp;&amp;m_1\\
1&amp;&amp;&amp;&amp;m_2\\
&amp;1&amp;&amp;&amp;m_3\\
&amp;&amp;\ddots&amp;&amp;\vdots\\
&amp;&amp;&amp;1&amp;m_{128}
\end{pmatrix}
\]</span>
å°†è¿™ä¸ªçŸ©é˜µä½œç”¨128æ¬¡åå¾—åˆ°çš„çŠ¶æ€ï¼Œå°±æ˜¯lfsrçš„è¿ç»­128æ¯”ç‰¹çš„è¾“å‡ºï¼Œå³ï¼š <span class="math display">\[
\mathbf{output} = \mathbf{state}
\begin{pmatrix}
&amp;&amp;&amp;&amp;m_1\\
1&amp;&amp;&amp;&amp;m_2\\
&amp;1&amp;&amp;&amp;m_3\\
&amp;&amp;\ddots&amp;&amp;\vdots\\
&amp;&amp;&amp;1&amp;m_{128}
\end{pmatrix}^{128}
\]</span> æ‰€ä»¥æœ‰äº†<span class="math inline">\(\mathbf{output}\)</span>åï¼Œåªéœ€è¦å³ä¹˜ä¸€ä¸ªçŸ©é˜µé€†åŸå°±å¯ä»¥æ¢å¤åˆå§‹çŠ¶æ€ï¼Œä»è€Œå¾—åˆ°seedã€‚</p>
<p>exp.sage:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">enc = <span class="string">b&#x27;\x81H\xd7_\x1c[\x00\xffkX+\x8d\n(-(U\xcd\x13$u\xa1\xceY.\x97\xfd8\x90\x07\xf5\x92&#x27;</span></span><br><span class="line">output = <span class="number">46569537592563541192266548905767353620</span></span><br><span class="line">mask = <span class="number">288869314699467157022235107404330039071</span></span><br><span class="line"></span><br><span class="line">mask_matrix = matrix([<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(mask)[<span class="number">2</span>:].zfill(<span class="number">128</span>)])</span><br><span class="line">M = zero_matrix(GF(<span class="number">2</span>), <span class="number">1</span>, <span class="number">127</span>).stack(identity_matrix(<span class="number">127</span>)).augment(mask_matrix.T)</span><br><span class="line">output_vec = vector([<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(output)[<span class="number">2</span>:].zfill(<span class="number">128</span>)])</span><br><span class="line">seed_vec = output_vec*(M^(-<span class="number">128</span>))</span><br><span class="line">seed = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> seed_vec:</span><br><span class="line">    seed &lt;&lt;= <span class="number">1</span></span><br><span class="line">    seed ^^= <span class="built_in">int</span>(s)</span><br><span class="line">cipher = AES.new(long_to_bytes(seed), AES.MODE_ECB)</span><br><span class="line">cipher.decrypt(enc)</span><br><span class="line"><span class="comment"># HXCTF&#123;s1mpl3_1ine@r_5y5tem&#125;</span></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2025äº¬éº’CTFæŒ‘æˆ˜èµ›-Cryptoå¤ç°</title>
    <url>/2025/05/24/2025%E4%BA%AC%E9%BA%92CTF%E6%8C%91%E6%88%98%E8%B5%9B-Crypto%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<p>æœ‰ç‚¹é—æ†¾ï¼Œä¸‹åˆç¡äº†å¿«4å°æ—¶ï¼Œç»“æŸåä¸€å°æ—¶æŠŠonlinecryptoæ•´äº†å‡ºæ¥ã€‚(ã£â•¥â•¯ï¹â•°â•¥c)</p>
<span id="more"></span>
<h3 id="onelinecrypto">onelinecrypto</h3>
<p>é¢˜ç›®å¾ˆçŸ­ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">assert</span> <span class="built_in">__import__</span>(<span class="string">&#x27;re&#x27;</span>).fullmatch(<span class="string">br&#x27;flag\&#123;[!-z]&#123;11&#125;\&#125;&#x27;</span>,flag:=os.getenvb(<span class="string">b&#x27;FLAG&#x27;</span>)) <span class="keyword">and</span> [is_prime(<span class="built_in">int</span>(flag.<span class="built_in">hex</span>(),<span class="number">16</span>)^^<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;ğŸŒŒ &#x27;</span>))) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>^<span class="number">7</span>)]</span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜ä¸€å¼€å§‹æ²¡çœ‹æ‡‚åœ¨å¹²å˜›ï¼Œå› ä¸ºassertæ˜¯æ°¸çœŸçš„ã€‚ç„¶å<a href="http://n1gh7ma12e.cn/"><span class="citation" data-cites="N1gh7ma12e">@N1gh7ma12e</span></a>è¯´å¯èƒ½æ˜¯ä¾§ä¿¡é“ï¼Œæ‰€ä»¥ä¸€ç›´åœ¨è¯•is_primeçš„æ—¶é—´ã€‚ç„¶åå°±å‘ç°åªè¦è¾“å…¥çš„æ•°å­—æœ‰ä¸€ä¸ªå°å› å­ï¼Œé‚£ä¹ˆis_primeå¾ˆå¿«å°±èƒ½è¿”å›Falseã€‚å½“æ—¶å°±æƒ³åˆ°ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­flagæ˜¯å¦å«æœ‰å› å­2ï¼ˆè™½ç„¶è¿™ä¸ªæ˜¯æ˜¾ç„¶çš„ï¼‰ã€‚</p>
<p>ç„¶åå°±å¡ä½äº†ï¼Œè€Œä¸”ç”±äºæ˜¨æ™šç¡å¤ªæ™šäº†ï¼Œä¸‹åˆå¤ªå›°äº†å°±ç¡è¿‡å»äº†ï¼Œ7ç‚¹èµ·æ¥å‘ç°å°±5è§£äº†ï¼Œæ‰€ä»¥åˆå¼€å§‹çœ‹è¿™é¢˜ã€‚</p>
<h4 id="æ€è·¯">æ€è·¯</h4>
<p>è¿™é¢˜å¤§æ¦‚çš„æ€è·¯æ˜¯å…ˆæ±‚å‡ºflagæ¨¡3çš„å€¼ï¼Œç„¶åæ˜¯æ¨¡5çš„å€¼ï¼Œï¼Œï¼Œã€‚è¿™æ ·å¾ªç¯å‡ æ¬¡åå°±å¯ä»¥ç”¨crtæ±‚å‡ºflagã€‚</p>
<p>é¦–å…ˆæ¥çœ‹æ€ä¹ˆæ±‚mod3çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥ç»™é¶æœºè¾“å…¥ <span class="math inline">\(k*2^{256} ,k \in \{1, 2, 3\}\)</span>
ï¼Œè¿™æ ·is_primeçš„è¾“å…¥å°±æ˜¯ <span class="math inline">\(k*2^{256} +
m\)</span> ï¼Œè€Œä¸” <span class="math inline">\(k*2^{256} + m\)</span>
æ¨¡3çš„æ‰€ä»¥æƒ…å†µä¸€å®šæ˜¯ <span class="math inline">\(\{0,1,2\}\)</span>ï¼Œæ‰€ä»¥å½“æ¨¡3æ˜¯0çš„æ—¶å€™ï¼Œis_primeå¾ˆå¿«å°±èƒ½åšå‡ºåˆ¤æ–­ï¼Œè¿™å°±ä»æ—¶é—´ä¸Šå‘Šè¯‰äº†æˆ‘ä»¬flagæ¨¡3çš„å€¼ã€‚ç„¶åä¸ºäº†è®©åŒºåˆ«æ›´æ˜æ˜¾ä¸€äº›ï¼Œæˆ‘ä»¬ä¸èƒ½åªæµ‹è¿™ä¸‰ä¸ªæ•°ï¼Œè€Œæ˜¯è¦å¯¹äºæ¯ä¸€ä¸ªkï¼Œæˆ‘ä»¬æµ‹å‡ºä¸‹é¢è¿™äº›æ•°çš„æ€»æ—¶é—´:</p>
<p><span class="math display">\[
(k + j*3)*2^{256} + m, \ \ j \in {1,2,3 \dots}
\]</span></p>
<p>å¯¹äºåŒä¸€ä¸ªkï¼Œè¿™äº›æ•°æ¨¡3çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ç„¶åæ¥çœ‹æ¨¡5ï¼Œæˆ‘ä»¬éœ€è¦è®©is_primeè¾“å…¥çš„æ•°ä¸å«å› å­3å’Œ2ï¼Œæ‰€ä»¥è¾“å…¥ä¸‹é¢çš„æ•°ï¼š</p>
<p><span class="math display">\[
(k + j*15)*2^{256} + m, \ \ j \in {1,2,3 \dots}
\]</span></p>
<p>ä¸ºäº†è®©ä»–ä¸å«æœ‰å› å­3ï¼Œå¯ä»¥è§£ä¸‹é¢çš„åŒä½™æ–¹ç¨‹:</p>
<p><span class="math display">\[
k*2^{256} + m \equiv 1 \mod 3
\]</span></p>
<p>ç”±äºmæ¨¡3å·²ç»çŸ¥é“ï¼Œæ‰€ä»¥å¯ä»¥æ±‚å‡ºkæ¨¡3çš„å€¼ï¼Œè®°ä¸º<span class="math inline">\(k_1\)</span>ï¼Œç„¶åå°†ä»–å¸¦å…¥ä¸Šå¼:</p>
<p><span class="math display">\[
(3*t + k_1)*2^{256} + m \equiv 1 \mod 3
\]</span></p>
<p>ç„¶åæšä¸¾ <span class="math inline">\(t \in \{0, 1, 2, 3,
4\}\)</span>ï¼Œè¿™æ · <span class="math inline">\((3*t + k_1)*2^{256} +
m\)</span> æ¨¡5ä¸€å®šä¼šå‡ºç° <span class="math inline">\(\{0,1,2,3,4\}\)</span>ï¼Œè€Œä¸”ä¸€å®šä¸å«å› å­3ï¼Œæ‰€ä»¥å½“æ¨¡5æ˜¯0æ—¶ï¼Œis_primeåˆ¤æ–­æ—¶é—´ä¼šå¾ˆå¿«ï¼Œè¿™å°±ä»æ—¶é—´ä¸Šå‘Šè¯‰äº†æˆ‘ä»¬flagæ¨¡5çš„å€¼ã€‚åŒæ ·ä¸ºäº†è®©åŒºåˆ«æ›´æ˜æ˜¾ï¼Œå¯¹äºæ¯ä¸€ä¸ªtæˆ‘ä»¬æµ‹å‡ºä¸‹é¢è¿™äº›æ•°çš„æ€»æ—¶é—´ï¼š</p>
<p><span class="math display">\[
(3*t + k_1 + 15 * j)*2^{256} + m , \ \ j \in {1,2,3 \dots}
\]</span></p>
<p>å¯¹äºåŒä¸€ä¸ªtï¼Œè¿™äº›æ•°æ¨¡3æ¨¡5çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>ç„¶åæŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤ï¼Œä¾æ¬¡æ±‚å‡ºæ¨¡7ï¼Œæ¨¡11çš„çš„å€¼ï¼Œï¼Œï¼Œã€‚æœ€åå°†flagåœ¨æ¨¡å„ä¸ªç´ æ•°çš„å€¼CRTã€‚</p>
<h4 id="exp">exp</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> remote, process, context</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;error&#x27;</span></span><br><span class="line">os.environ[<span class="string">&quot;FLAG&quot;</span>] = <span class="string">&quot;flag&#123;_test_flag_&#125;&quot;</span></span><br><span class="line">path = <span class="string">&quot;server.sage&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpend</span>(<span class="params">io, numbers</span>):</span><br><span class="line">    payload = <span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(num) + <span class="string">&quot;\n&quot;</span> <span class="keyword">for</span> num <span class="keyword">in</span> numbers])</span><br><span class="line">    io.send(payload.encode())</span><br><span class="line">    begin = time()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(numbers)):</span><br><span class="line">        io.recvuntil((<span class="string">&quot;ğŸŒŒ &quot;</span>).encode())</span><br><span class="line">    end = time()</span><br><span class="line">    <span class="keyword">return</span> end - begin</span><br><span class="line"></span><br><span class="line">N = <span class="number">1</span></span><br><span class="line">pn = <span class="number">1</span></span><br><span class="line">fn = <span class="number">0</span></span><br><span class="line">an = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">io = process([<span class="string">&quot;sage&quot;</span>, path])</span><br><span class="line">io.recvuntil((<span class="string">&quot;ğŸŒŒ &quot;</span>).encode())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>):</span><br><span class="line">    <span class="keyword">if</span> pn == <span class="number">1</span>:</span><br><span class="line">        pn = <span class="number">3</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pn = next_prime(pn)</span><br><span class="line">    spends = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (i % <span class="number">5</span>) == <span class="number">0</span>:  <span class="comment"># é¶æœºé‡Œå¾ªç¯å¯èƒ½ç”¨å®Œäº†ï¼Œé‡ç½®ä¸€ä¸‹</span></span><br><span class="line">        io.close()</span><br><span class="line">        io = process([<span class="string">&quot;sage&quot;</span>, path])</span><br><span class="line">        io.recvuntil((<span class="string">&quot;ğŸŒŒ &quot;</span>).encode())</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(pn):</span><br><span class="line">        numbers = [(an + k * N + j * N * pn) &lt;&lt; <span class="number">256</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">300</span>)]</span><br><span class="line">        spendtime = getSpend(io, numbers)</span><br><span class="line">        spends.append(spendtime)</span><br><span class="line">    <span class="comment"># print(spends)</span></span><br><span class="line">    k = spends.index(<span class="built_in">min</span>(spends))</span><br><span class="line">    fn_ = -((an + k*N) &lt;&lt; <span class="number">256</span>) % (pn)</span><br><span class="line">    fn = <span class="built_in">int</span>(crt([fn, fn_], [N, pn]))</span><br><span class="line">    an = (<span class="number">1</span> - fn) * <span class="built_in">pow</span>(<span class="number">1</span> &lt;&lt; <span class="number">256</span>, -<span class="number">1</span>, N * pn) % (N * pn)</span><br><span class="line">    N = N * pn</span><br><span class="line">    <span class="built_in">print</span>(fn, end=<span class="string">&quot; &quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(fn))</span><br></pre></td></tr></table></figure>
<h3 id="unwind-on-vacation">Unwind On Vacation</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> ast <span class="keyword">import</span> literal_eval</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> shake_128</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;redacted&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Hash</span>(<span class="params">msg</span>):</span><br><span class="line">    h = <span class="built_in">int</span>(shake_128(msg).hexdigest(<span class="number">3</span>*m),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">return</span> vector(GF(q),[(h:=h//q)%q <span class="keyword">if</span> i <span class="keyword">else</span> h%q <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UOV</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, m, n, q</span>):</span><br><span class="line">        <span class="variable language_">self</span>.params = (m, n, q)</span><br><span class="line">        <span class="variable language_">self</span>.pub = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.O = random_matrix(ZZ, n-m, m)</span><br><span class="line">        <span class="variable language_">self</span>.refresh()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">self</span>):</span><br><span class="line">        set_random_seed(seed:=secrets.randbits(<span class="number">128</span>))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸŒ»&quot;</span>, seed)</span><br><span class="line">        m, n, q = <span class="variable language_">self</span>.params</span><br><span class="line">        F = GF(q)</span><br><span class="line">        Ps = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">            P1 = random_matrix(F, n-m, n-m)</span><br><span class="line">            P2 = random_matrix(F, n-m, m)</span><br><span class="line">            P3 = (-<span class="variable language_">self</span>.O.T*P1*<span class="variable language_">self</span>.O-<span class="variable language_">self</span>.O.T*P2)</span><br><span class="line">            P = block_matrix(F, [[P1, P2], [zero_matrix(F, m, n-m), P3]])</span><br><span class="line">            <span class="built_in">print</span>(P3.<span class="built_in">list</span>())</span><br><span class="line">            Ps.append(P)</span><br><span class="line">        set_random_seed(secrets.randbits(<span class="number">128</span>))</span><br><span class="line">        <span class="keyword">return</span> Ps</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refresh</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.pub = <span class="variable language_">self</span>.keygen()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, msg</span>):</span><br><span class="line">        <span class="keyword">if</span> msg == <span class="string">&quot;Unwind On Vacation&quot;</span>: <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">        m, n, q = <span class="variable language_">self</span>.params</span><br><span class="line">        F = GF(q)</span><br><span class="line">        O = block_matrix(F, <span class="number">2</span>, <span class="number">1</span>, [<span class="variable language_">self</span>.O, identity_matrix(F, m)])</span><br><span class="line">        v = random_vector(F, n, <span class="number">1</span>)</span><br><span class="line">        M = matrix(F, [v*(<span class="variable language_">self</span>.pub[i]+<span class="variable language_">self</span>.pub[i].T)*O <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)])</span><br><span class="line">        u = Hash(msg.encode())-vector([(v*<span class="variable language_">self</span>.pub[i]*v) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)])</span><br><span class="line">        <span class="keyword">return</span> v+O*M.solve_right(u)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, msg, token</span>):</span><br><span class="line">        msg = Hash(msg.encode())</span><br><span class="line">        t = vector(token)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.params[<span class="number">0</span>]):</span><br><span class="line">            <span class="keyword">if</span> t*<span class="variable language_">self</span>.pub[i]*t != msg[i]:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">m, n = <span class="number">73</span>, <span class="number">180</span></span><br><span class="line">q = <span class="number">0x10001</span></span><br><span class="line">uov = UOV(m, n, q)</span><br><span class="line"><span class="built_in">__import__</span>(<span class="string">&quot;signal&quot;</span>).alarm(<span class="number">1200</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80</span>):</span><br><span class="line">    <span class="keyword">match</span> <span class="built_in">input</span>(<span class="string">&quot;&gt; &quot;</span>):</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;R&quot;</span>: uov.refresh()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;S&quot;</span>: <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;uov.sign(<span class="built_in">input</span>(<span class="string">&quot;ğŸ’¬ &quot;</span>))&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;V&quot;</span>: <span class="built_in">print</span>(<span class="string">&quot;ğŸš©&quot;</span>, uov.verify(<span class="string">&quot;Unwind On Vacation&quot;</span>,</span><br><span class="line">                                        literal_eval(<span class="built_in">input</span>(<span class="string">&quot;ğŸ“ &quot;</span>)))*FLAG)</span><br></pre></td></tr></table></figure></p>
]]></content>
      <tags>
        <tag>CTF</tag>
        <tag>ä¾§ä¿¡é“</tag>
      </tags>
  </entry>
  <entry>
    <title>2025VNCTF-Crypto-WP</title>
    <url>/2025/02/15/2025VNCTF-Crypto-WP/</url>
    <content><![CDATA[<p>åªå†™äº†å¯†ç éƒ¨åˆ†å’Œä¸€é“æ‚é¡¹ï¼Œæœ€åç¦»æ¯”èµ›ç»“æŸè¿˜æœ‰å‡ åç§’çš„æ—¶å€™å‘ç°è‡ªå·±ä»30æ‰åˆ°äº†31ï¼Œä»¥ä¸ºä¸å¥–å“æ— ç¼˜äº†ï¼Œä½†æ˜¯åé¢æ”¶é›†wpçš„æ—¶å€™ï¼Œå‰é¢æœ‰ä¸¤é˜Ÿæ²¡äº¤wpï¼Œæ‰€ä»¥æ’åˆ°29äº†:Dã€‚
<span id="more"></span></p>
<h3 id="eazymath">eazymath</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">flag=bytes_to_long(flag)</span><br><span class="line">l=flag.bit_length()//<span class="number">3</span> + <span class="number">1</span></span><br><span class="line">n=[]</span><br><span class="line">N=<span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(n) &lt; <span class="number">3</span>:</span><br><span class="line">    p = <span class="number">4</span>*getPrime(l)-<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        n.append(p)</span><br><span class="line">        N *= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;flag*flag%N&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, expand</span><br><span class="line">x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">polynomial = expand((x - n[<span class="number">0</span>]) * (x - n[<span class="number">1</span>]) * (x - n[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;polynomial=&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># c=24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line"><span class="comment"># polynomial=x**3 - 15264966144147258587171776703005926730518438603688487721465*x**2 + 76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923*x - 125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br></pre></td></tr></table></figure></p>
<p>é¢˜ç›®å¯¹flagåšäº†å¦‚ä¸‹åŠ å¯†: <span class="math display">\[
c = (flag)^2 \mod N
\]</span> å…¶ä¸­Næ˜¯ä¸‰ä¸ªç´ æ•°(n0, n1,
n2)çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠåŠ å¯†çš„ç­‰å¼ç°è½¬æ¢åˆ°æ¨¡ç´ æ•°ä¸‹ï¼š <span class="math display">\[
c = (flag)^2 \mod n_i \ \ \ i \in {0, 1, 2}
\]</span>
ç„¶åæ¥çœ‹å¦‚ä½•è·å–è¿™3ä¸ªç´ æ•°ï¼Œé¢˜ç›®ç»™äº†ä¸€ä¸ªæ•´æ•°ä¸Šçš„polynomialï¼Œè¿™3ä¸ªç´ æ•°å°±æ˜¯è¿™ä¸ªå¤šé¡¹å¼çš„æ ¹ï¼Œæ‰€ä»¥ç›´æ¥ç”¨rootsæ–¹æ³•æ±‚è§£å°±è¡Œã€‚
è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†3ä¸ªæ¨¡ç´ æ•°ä¸‹çš„äºŒæ¬¡æ–¹ç¨‹ï¼Œè§£è¿™3ä¸ªæ–¹ç¨‹å¯ä»¥ç”¨AMMç®—æ³•å¼€æ¨¡ç´ æ•°ä¸‹çš„æ ¹å·ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ç”¨çš„æ˜¯sageè‡ªå¸¦çš„rootsæ–¹æ³•ï¼Œrootsæ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥æ±‚è§£æ¨¡ç´ æ•°ä¸‹çš„å¤šé¡¹å¼çš„æ ¹çš„ã€‚æœ€åæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯æ¨¡<span class="math inline">\(n_i\)</span>ä¸‹çš„<span class="math inline">\(flag\)</span>ï¼Œæ‰€ä»¥è¿˜è¦ç”¨CRT(ä¸­å›½å‰©ä½™å®šç†)å°†æ¨¡æ•°æå‡åˆ°<span class="math inline">\(N\)</span>ã€‚ exp.sage: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(ZZ)</span><br><span class="line">c=<span class="number">24884251313604275189259571459005374365204772270250725590014651519125317134307160341658199551661333326703566996431067426138627332156507267671028553934664652787411834581708944</span></span><br><span class="line">polynomial=x**<span class="number">3</span> - <span class="number">15264966144147258587171776703005926730518438603688487721465</span>*x**<span class="number">2</span> + <span class="number">76513250180666948190254989703768338299723386154619468700730085586057638716434556720233473454400881002065319569292923</span>*x - <span class="number">125440939526343949494022113552414275560444252378483072729156599143746741258532431664938677330319449789665352104352620658550544887807433866999963624320909981994018431526620619</span></span><br><span class="line">n1, n2, n3 = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> polynomial.roots()]</span><br><span class="line">all_root = []</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> [n1, n2, n3]:</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(GF(n))</span><br><span class="line">    f = x^<span class="number">2</span> - c</span><br><span class="line">    all_root.append([ZZ(r[<span class="number">0</span>]) <span class="keyword">for</span> r <span class="keyword">in</span> f.roots()])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> r1 <span class="keyword">in</span> all_root[<span class="number">0</span>]:</span><br><span class="line">    <span class="keyword">for</span> r2 <span class="keyword">in</span> all_root[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">for</span> r3 <span class="keyword">in</span> all_root[<span class="number">2</span>]:</span><br><span class="line">            flag = crt([r1, r2, r3], [n1, n2, n3])</span><br><span class="line">            flag = long_to_bytes(flag)</span><br><span class="line">            <span class="keyword">if</span> flag.isascii():</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;VNCTF&#123;90dcfb2dfb21a21e0c8715cbf3643f4a47d3e2e4b3f7b7975954e6d9701d9648&#125;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="simple_prediction">Simple_prediction</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice, randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># flagæ¥æº</span></span><br><span class="line">flag = <span class="string">b&quot;VNCTF&#123;xxxxxxx&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)&lt;<span class="number">100</span></span><br><span class="line">FLAG1=flag[:<span class="number">32</span>]</span><br><span class="line">FLAG2=flag[<span class="number">32</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># part1</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed=<span class="literal">None</span>, a=<span class="literal">None</span>, b=<span class="literal">None</span>, m=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> m:</span><br><span class="line">            <span class="variable language_">self</span>.m = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> seed:</span><br><span class="line">            <span class="variable language_">self</span>.seed = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> a:</span><br><span class="line">            <span class="variable language_">self</span>.a = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> b:</span><br><span class="line">            <span class="variable language_">self</span>.b = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="comment">#print(f&quot;LCG åˆå§‹åŒ–å‚æ•°: seed=&#123;self.seed&#125;\n a=&#123;self.a&#125;\n b=&#123;self.b&#125;\n m=&#123;self.m&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = (<span class="variable language_">self</span>.seed * <span class="variable language_">self</span>.a + <span class="variable language_">self</span>.b) % <span class="variable language_">self</span>.m</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.seed</span><br><span class="line">binary_flag = <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&quot;<span class="subst">&#123;byte:08b&#125;</span>&quot;</span> <span class="keyword">for</span> byte <span class="keyword">in</span> FLAG1)</span><br><span class="line">m = [<span class="built_in">int</span>(bit) <span class="keyword">for</span> bit <span class="keyword">in</span> binary_flag]</span><br><span class="line"></span><br><span class="line">n=[]</span><br><span class="line">lcg=LCG()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    z=lcg.<span class="built_in">next</span>()</span><br><span class="line">    <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">        n.append(z)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        z=randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line">        n.append(z)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = [...]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># part2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FlagEncoder</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, flag: <span class="built_in">bytes</span>, e: <span class="built_in">int</span> = <span class="number">65537</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.flag = flag</span><br><span class="line">        <span class="variable language_">self</span>.e = e</span><br><span class="line">        <span class="variable language_">self</span>.encoded_flag = []</span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.c = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> idx, byte <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="variable language_">self</span>.flag):</span><br><span class="line">            <span class="variable language_">self</span>.encoded_flag.extend([idx + <span class="number">0x1234</span>] * byte)</span><br><span class="line">        shuffle(<span class="variable language_">self</span>.encoded_flag)</span><br><span class="line">        p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">        <span class="variable language_">self</span>.n = p * q</span><br><span class="line">        <span class="variable language_">self</span>.c = <span class="built_in">sum</span>(<span class="built_in">pow</span>(m, <span class="variable language_">self</span>.e, <span class="variable language_">self</span>.n) <span class="keyword">for</span> m <span class="keyword">in</span> <span class="variable language_">self</span>.encoded_flag) % <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;self.n = &#125;</span>\n<span class="subst">&#123;self.e = &#125;</span>\n<span class="subst">&#123;self.c = &#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">encoder = FlagEncoder(FLAG2)</span><br><span class="line">encoder.process()</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">self.n = 16880924655573626811763865075201881594085658222047473444427295924181371341406971359787070757333746323665180258925280624345937931067302673406166527557074157053768756954809954623549764696024889104571712837947570927160960150469942624060518463231436452655059364616329589584232929658472512262657486196000339385053006838678892053410082983193195313760143294107276239320478952773774926076976118332506709002823833966693933772855520415233420873109157410013754228009873467565264170667190055496092630482018483458436328026371767734605083997033690559928072813698606007542923203397847175503893541662307450142747604801158547519780249</span></span><br><span class="line"><span class="string">self.e = 65537</span></span><br><span class="line"><span class="string">self.c = 9032357989989555941675564821401950498589029986516332099523507342092837051434738218296315677579902547951839735936211470189183670081413398549328213424711630953101945318953216233002076158699383482500577204410862449005374635380205765227970071715701130376936200309849157913293371540209836180873164955112090522763296400826270168187684580268049900241471974781359543289845547305509778118625872361241263888981982239852260791787315392967289385225742091913059414916109642527756161790351439311378131805693115561811434117214628348326091634314754373956682740966173046220578724814192276046560931649844628370528719818294616692090359</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>Part1</strong>
é¢˜ç›®åŸºäºä¸€ä¸ªLCG(çº¿æ€§åŒä½™çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨)ï¼Œä»–çš„å‚æ•°æˆ‘ä»¬éƒ½ä¸çŸ¥é“ï¼Œä½†æ˜¯ç”±äºFLAG1å‰ç¼€æ˜¯b"VNCTF{"ï¼Œæ‰€ä»¥å¯ä»¥çŸ¥é“LCGç‰¹å®šä½ç½®çš„å€¼ï¼Œé‚£ä¹ˆå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªiï¼Œä½¿å¾—ï¼š
<span class="math display">\[
X_i = (aX_{i-1} + b) \% m
\]</span> è¿™é‡Œæ‰¾åˆ°çš„æ˜¯ï¼š <span class="math display">\[
\begin{aligned}
X_{8} = (aX_{7} + b) \% m \\
X_{11} = (aX_{10} + b) \% m \\
X_{12} = (aX_{15} + b) \% m \\
X_{19} = (aX_{18} + b) \% m
\end{aligned}
\]</span> æ‰€ä»¥æœ‰ï¼š <span class="math display">\[
a = \frac{X_{8} - X_{11}}{X_{7}-X_{10}} =
\frac{X_{11}-X_{16}}{X_{10}-X_{15}} = \frac{X_{16} -
X_{19}}{X_{15}-X_{18}}
\]</span> æ‰€ä»¥: <span class="math display">\[
\begin{aligned}
(X_{8} - X_{11})(X_{10}-X_{15})-(X_{7}-X_{10})(X_{11}-X_{16}) \equiv
0  \mod m \\
(X_{11} - X_{16})(X_{15}-X_{18})-(X_{10}-X_{15})(X_{16}-X_{19}) \equiv 0
\mod m
\end{aligned}
\]</span>
ä¸Šé¢ä¸¤å¼çš„å·¦ä¾§éƒ½æ˜¯mçš„å€æ•°ï¼Œé‚£ä»–ä»¬çš„æœ€å¤§å…¬å› æ•°å¾ˆå¯èƒ½å°±æ˜¯mï¼Œå¾—åˆ°måå†åˆ©ç”¨ä¸Šå¼æ±‚å‡ºaï¼Œbï¼Œç„¶ååæ¨å‡ºseedã€‚
exp.sage: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, GCD</span><br><span class="line">n=[...]</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed=<span class="literal">None</span>, a=<span class="literal">None</span>, b=<span class="literal">None</span>, m=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.m = m</span><br><span class="line">        <span class="variable language_">self</span>.seed = seed</span><br><span class="line">        <span class="variable language_">self</span>.a = a</span><br><span class="line">        <span class="variable language_">self</span>.b = b</span><br><span class="line">        <span class="comment">#print(f&quot;LCG åˆå§‹åŒ–å‚æ•°: seed=&#123;self.seed&#125;\n a=&#123;self.a&#125;\n b=&#123;self.b&#125;\n m=&#123;self.m&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.seed = (<span class="variable language_">self</span>.seed * <span class="variable language_">self</span>.a + <span class="variable language_">self</span>.b) % <span class="variable language_">self</span>.m</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.seed</span><br><span class="line"></span><br><span class="line">p1 = (n[<span class="number">8</span>]-n[<span class="number">11</span>])*(n[<span class="number">10</span>]-n[<span class="number">15</span>]) - (n[<span class="number">7</span>]-n[<span class="number">10</span>])*(n[<span class="number">11</span>]-n[<span class="number">16</span>])</span><br><span class="line">p2 = (n[<span class="number">11</span>]-n[<span class="number">16</span>])*(n[<span class="number">15</span>]-n[<span class="number">18</span>]) - (n[<span class="number">10</span>]-n[<span class="number">15</span>])*(n[<span class="number">16</span>]-n[<span class="number">19</span>])</span><br><span class="line">p = (GCD(p1, p2))</span><br><span class="line">a = (n[<span class="number">8</span>] - n[<span class="number">11</span>])*<span class="built_in">pow</span>(n[<span class="number">7</span>] - n[<span class="number">10</span>], -<span class="number">1</span>, p) % p</span><br><span class="line">b = (n[<span class="number">8</span>] - a*n[<span class="number">7</span>]) % p</span><br><span class="line">seed = (n[<span class="number">0</span>] - b)*<span class="built_in">pow</span>(a, -<span class="number">1</span>, p) % p</span><br><span class="line">lcg = LCG(seed, a, b, p)</span><br><span class="line">FLAG1 = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">    <span class="keyword">if</span> n[i] == lcg.<span class="built_in">next</span>():</span><br><span class="line">        FLAG1 = FLAG1 + <span class="string">&quot;0&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        FLAG1 = FLAG1 + <span class="string">&quot;1&quot;</span></span><br><span class="line">FLAG1 = long_to_bytes(<span class="built_in">int</span>(FLAG1, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(FLAG1)</span><br><span class="line"><span class="comment"># b&#x27;VNCTF&#123;Happy_New_Year_C0ngratu1at&#x27;</span></span><br></pre></td></tr></table></figure> <strong>Part2</strong>
é¢˜ç›®ä¸­çš„å¯†æ–‡cå¯ä»¥å¦‚ä¸‹è¡¨ç¤ºï¼š <span class="math display">\[
c = \sum^{len(FLAG2)-1}_{i=0} m_{i}*a_{i} \\
a_i = (i + 0x1234)^e \ \%n
\]</span>
ç”±äºFLAG2çš„é•¿åº¦æœªçŸ¥ï¼Œè¿™é‡ŒåªçŸ¥é“ä»–çš„é•¿åº¦å°äº69ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å‡è®¾é•¿åº¦ä¸º68ï¼Œè¿™æ ·å¦‚æœå®é™…ä¸Šæ²¡æœ‰è¿™ä¹ˆé•¿ï¼Œé‚£ä¹Ÿå°±å¯¹åº”åˆ°<span class="math inline">\(m_i=0\)</span>çš„æƒ…å†µã€‚
æ‰€ä»¥ç°åœ¨çš„é—®é¢˜å°±æ˜¯å¦‚ä½•è§£ä¸Šé¢çš„å¤šå…ƒçº¿æ€§æ–¹ç¨‹ç»„äº†ï¼Œè¿™é‡Œä¸€å…±68ä¸ªå˜é‡ï¼Œä½†æˆ‘ä»¬åªæœ‰ä¸€ä¸ªç­‰å¼ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹ç¨‹å®é™…ä¸Šæ˜¯æœ‰æ— ç©·å¤šä¸ªè§£ã€‚éš¾é“å°±æ²¡åŠæ³•æ±‚è§£äº†å—ï¼Œå…¶å®æˆ‘ä»¬è¿˜æ¼æ‰äº†ä¸€äº›ä¿¡æ¯ï¼Œé‚£å°±æ˜¯è¿™é‡Œçš„çº¿æ€§æ–¹ç¨‹ç»„éƒ½æ˜¯æ•´æ•°ï¼Œè€Œä¸”æˆ‘ä»¬è¦æ±‚çš„æœªçŸ¥é‡<span class="math inline">\(m_i\)</span>ç›¸æ¯”ç³»æ•°<span class="math inline">\(a_i\)</span>è¦å°çš„å¤šã€‚å‰é¢æ— ç©·å¤šè§£çš„ç»“è®ºæ˜¯å»ºç«‹åœ¨å®æ•°åŸŸä¸Šçš„ï¼Œè¿™é‡Œæ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„è§£æ˜¯æœ‰é™çš„ã€‚è€Œæ‰¾åˆ°è¿™ä¸ªè§£çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨æ ¼åŸºè§„çº¦ç®—æ³•ï¼Œæˆ‘ä»¬æ‰¾ä¸‹é¢è¿™æ ·çš„æ ¼<span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
\begin{pmatrix}
a_0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0\\
a_1 &amp; 0 &amp; 1 &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_{67} &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
c &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
\end{pmatrix}_{68 \times 68}
\]</span> è¿™ä¸ªæ ¼æ»¡è¶³å¦‚ä¸‹çš„çº¿æ€§å…³ç³»: <span class="math display">\[
(m_0, m_1 \cdots, m_{67}, -1)\begin{pmatrix}
a_0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0\\
a_1 &amp; 0 &amp; 1 &amp; \cdots &amp; 0\\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_{67} &amp; 0 &amp; 0 &amp; \cdots &amp; 1 \\
c &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\
\end{pmatrix}_{68 \times 68} =
(0, m_0, m_1, \cdots, m_{67})
\]</span> æ‰€ä»¥<span class="math inline">\((0, m_0, m_1, \cdots,
m_{67})\)</span>å°±æ˜¯æ ¼ä¸­çš„ä¸€ä¸ªçŸ­å‘é‡ï¼Œæˆ‘ä»¬å¯¹æ ¼ä½¿ç”¨æ ¼åŸºè§„çº¦ç®—æ³•å°±å¾ˆæœ‰å¯èƒ½å¾—åˆ°è¿™ä¸ªçŸ­å‘é‡ã€‚
exp.sage: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">n = <span class="number">16880924655573626811763865075201881594085658222047473444427295924181371341406971359787070757333746323665180258925280624345937931067302673406166527557074157053768756954809954623549764696024889104571712837947570927160960150469942624060518463231436452655059364616329589584232929658472512262657486196000339385053006838678892053410082983193195313760143294107276239320478952773774926076976118332506709002823833966693933772855520415233420873109157410013754228009873467565264170667190055496092630482018483458436328026371767734605083997033690559928072813698606007542923203397847175503893541662307450142747604801158547519780249</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">9032357989989555941675564821401950498589029986516332099523507342092837051434738218296315677579902547951839735936211470189183670081413398549328213424711630953101945318953216233002076158699383482500577204410862449005374635380205765227970071715701130376936200309849157913293371540209836180873164955112090522763296400826270168187684580268049900241471974781359543289845547305509778118625872361241263888981982239852260791787315392967289385225742091913059414916109642527756161790351439311378131805693115561811434117214628348326091634314754373956682740966173046220578724814192276046560931649844628370528719818294616692090359</span></span><br><span class="line">length = <span class="number">68</span></span><br><span class="line">m = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">    m.append(<span class="built_in">pow</span>(i + <span class="number">0x1234</span>, e, n))</span><br><span class="line">M = column_matrix(ZZ, m + [c])</span><br><span class="line">M = M.augment(identity_matrix(ZZ, length+<span class="number">1</span>))</span><br><span class="line">M = M.stack(vector(ZZ, [n] + [<span class="number">0</span>]*(length+<span class="number">1</span>)))</span><br><span class="line">MLLL = M.LLL()</span><br><span class="line">f = -MLLL[<span class="number">0</span>]</span><br><span class="line">FLAG2 = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">32</span> <span class="keyword">and</span> i &lt;= <span class="number">127</span>:</span><br><span class="line">        FLAG2 += <span class="built_in">bytes</span>([i])</span><br><span class="line"><span class="built_in">print</span>(FLAG2)</span><br><span class="line"><span class="built_in">print</span>(FLAG1 + FLAG2)</span><br><span class="line"><span class="comment"># b&#x27;i0ns_On_Rec0vering_The_Messages&#125;&#x27;</span></span><br><span class="line"><span class="comment"># b&#x27;VNCTF&#123;Happy_New_Year_C0ngratu1ati0ns_On_Rec0vering_The_Messages&#125;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="ss0hurt">ss0Hurt!</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DaMie</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, flag , n = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.m = ZZ(bytes_to_long(flag))</span><br><span class="line">        <span class="variable language_">self</span>.n = n <span class="keyword">if</span> n <span class="keyword">else</span> getPrime(<span class="number">1024</span>)</span><br><span class="line">        <span class="variable language_">self</span>.P = Zmod(<span class="variable language_">self</span>.n)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;self.n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">self, x, y, z</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> vector([<span class="number">5</span> * x + y - <span class="number">5</span> * z, <span class="number">5</span> * y - z, <span class="number">5</span> * z])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Mat</span>(<span class="params">self, m</span>):</span><br><span class="line">        PR = <span class="variable language_">self</span>.P[<span class="string">&#x27;x,y,z&#x27;</span>]</span><br><span class="line">        x,y,z = PR.gens()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> m != <span class="number">0</span>:</span><br><span class="line">            plana = <span class="variable language_">self</span>.Mat(m//<span class="number">2</span>)</span><br><span class="line">            planb = plana(*plana)</span><br><span class="line">            <span class="keyword">if</span> m % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> planb</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">self</span>.process(*planb)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.process(*PR.gens())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">self, A, B, C</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.Mat(<span class="variable language_">self</span>.m)(A, B, C)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    </span><br><span class="line">    Ouch = DaMie(flag)</span><br><span class="line">    result = Ouch.<span class="built_in">hash</span>(<span class="number">2025</span>,<span class="number">208</span>,<span class="number">209</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;hash(A,B,C) = <span class="subst">&#123;result&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p>é¢˜ç›®ä¸­çš„processæ–¹æ³•å®é™…ä¸Šå®ç°äº†ä¸€ä¸ªå¦‚ä¸‹çš„çº¿æ€§å˜æ¢ï¼š <span class="math display">\[
M = \left(\begin{matrix}
5 &amp; 0  &amp; 0\\
1 &amp; 5  &amp; 0\\
-5&amp;-1  &amp; 5\\
\end{matrix}
\right)
\]</span>
é¢˜ç›®ä¸­çš„Matæ–¹æ³•å®ç°äº†ä¸€ä¸ªç±»ä¼¼çŸ©é˜µå¿«é€Ÿå¹‚çš„ç®—æ³•ï¼Œä¹‹æ‰€ä»¥æ˜¯ç±»ä¼¼ï¼Œæ˜¯å› ä¸ºå¿«é€Ÿå¹‚ç®—æ³•ä¸­ï¼Œå½“m=0æ—¶ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ªæ’ç­‰å˜æ¢çš„ç»“æœï¼Œä½†è¿™é‡Œåˆè¿”å›äº†ç»è¿‡<span class="math inline">\(M\)</span>å˜æ¢åçš„ç»“æœï¼Œæ‰€ä»¥å½“è¾“å…¥ä¸ºflagæ—¶ï¼Œå¾—åˆ°çš„å®é™…ä¸Šæ—¶<span class="math inline">\(M^{flag+2^k}\)</span>ã€‚æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡è¿™ä¸ª<span class="math inline">\(2^k\)</span>ï¼Œå› ä¸ºä»–åªä¼šè®©æˆ‘ä»¬æœ€åå¾—åˆ°çš„flagæœ‰1ä¸ªæ¯”ç‰¹çš„åå·®ï¼Œæ‰‹åŠ¨ä¿®å¤å°±å¥½ã€‚</p>
<p>æ‰€ä»¥ç°åœ¨æˆ‘ä»¬çš„é—®é¢˜å°±æ˜¯å·²çŸ¥<span class="math inline">\(M,
M^n\)</span>ï¼Œå¦‚ä½•æ±‚<span class="math inline">\(n\)</span>ã€‚
å¯¹äºçŸ©é˜µ<span class="math inline">\(M^n\)</span>çš„æ±‚è§£ï¼Œå¯ä»¥åšå¦‚ä¸‹æ“ä½œï¼š
<span class="math display">\[
M = \left(\begin{matrix}
0 &amp; 0  &amp; 0\\
1 &amp; 0  &amp; 0\\
-5&amp;-1  &amp; 0\\
\end{matrix}
\right)  +
\left(\begin{matrix}
5 &amp; 0  &amp; 0\\
0 &amp; 5  &amp; 0\\
0 &amp; 0  &amp; 5\\
\end{matrix}
\right) = K + 5I
\]</span> è€Œ: <span class="math display">\[
K^3 = \mathbf{0}
\]</span> æ‰€ä»¥å¯¹<span class="math inline">\((K+5I)^n\)</span>ç”¨äºŒé¡¹å¼å®šç†: <span class="math display">\[
M^n = (K + 5I)^n = C^2_nK^2(5I)^{n-2} + C^1_nK(5I)^{n-1}+(5I)^n \\ =
\left(\begin{matrix}
5^n &amp; 0  &amp; 0\\
n5^{n-1} &amp; 5^n  &amp; 0\\
a_{31} &amp; -n5^{n-1}  &amp; 5^n\\
\end{matrix}
\right)
\]</span> æ‰€ä»¥: <span class="math display">\[
(2025,208,209)M^n = (A, 2028*5^n-2029*n5^{n-1}, 2029*5^n) = (A, B, C)
\]</span> æ ¹æ®ä¸Šé¢å‘é‡ç›¸ç­‰ï¼Œå¯ä»¥æå–å‡ºä¸‹é¢ä¸¤ä¸ªç­‰å¼ï¼š <span class="math display">\[
\begin{gather}
2028*5^n-2029*n5^{n-1} = B \\
2029*5^n = C
\end{gather}
\]</span> æˆ‘ä»¬æŠŠ<span class="math inline">\(n,
5^n\)</span>çœ‹ä½œä¸¤ä¸ªæ–°çš„æœªçŸ¥é‡ï¼Œç›´æ¥è§£æ–¹ç¨‹ç»„å°±å¯ä»¥å¾—åˆ°<span class="math inline">\(n\)</span>ã€‚</p>
<p>exp.sageï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">h_A, h_B, h_C = (<span class="number">17199707718762989481733793569240992776243099972784327196212023936622130204798694753865087501654381623876011128783229020278210160383185417670794284015692458326761011808048967854332413536183785458993128524881447529380387804712214305034841856237045463243243451585619997751904403447841431924053651568039257094910</span>, <span class="number">62503976674384744837417986781499538335164333679603320998241675970253762411134672614307594505442798271581593168080110727738181755339828909879977419645331630791420448736959554172731899301884779691119177400457640826361914359964889995618273843955820050051136401731342998940859792560938931787155426766034754760036</span>, <span class="number">93840121740656543170616546027906623588891573113673113077637257131079221429328035796416874995388795184080636312185908173422461254266536066991205933270191964776577196573147847000446118311985331680378772920169894541350064423243733498672684875039906829095473677927238488927923581806647297338935716890606987700071</span>)</span><br><span class="line">A, B, C = [<span class="number">2025</span>, <span class="number">208</span>, <span class="number">209</span>]</span><br><span class="line">n = <span class="number">106743081253087007974132382690669187409167641660258665859915640694456867788135702053312073228376307091325146727550371538313884850638568106223326195447798997814912891375244381751926653858549419946547894675646011818800255999071070352934719005006228971056393128007601573916373180007524930454138943896336817929823</span></span><br><span class="line">K_5 = h_C * <span class="built_in">pow</span>(C, -<span class="number">1</span>, n) % n</span><br><span class="line">K = <span class="number">5</span>*(B*K_5 - h_B)*<span class="built_in">pow</span>(C*K_5, -<span class="number">1</span>, n) % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(K)))</span><br><span class="line"><span class="string">b&#x27;VNCTF&#123;WWhy_diagonalization_1s_s0_brRRRrRrrRrrrRrRRrRRrrrRrRrRuUuUUUTTTtte3333?????ouch!ouch!Th3t_is_S0_Crazy!!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="å¹¶érc4">å¹¶éRC4</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> small_key, flag</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä½ èƒ½æ‰¾åˆ°è¿™ä¸ªå®ç°é”™åœ¨å“ªå—</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">faulty_rc4_encrypt</span>(<span class="params">text</span>):</span><br><span class="line">    data_xor_iv = []</span><br><span class="line">    sbox = []</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    x = y = k = <span class="number">0</span></span><br><span class="line">    key = small_key</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        sbox.append(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            j = j + sbox[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)]) &amp; <span class="number">255</span></span><br><span class="line">            sbox[i] = sbox[j]  </span><br><span class="line">            sbox[j] = sbox[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> idx <span class="keyword">in</span> text:</span><br><span class="line">                x = x + <span class="number">1</span> &amp; <span class="number">255</span></span><br><span class="line">                y = y + sbox[x] &amp; <span class="number">255</span></span><br><span class="line">                sbox[x] = sbox[y] </span><br><span class="line">                sbox[y] = sbox[x]</span><br><span class="line">                k = sbox[sbox[x] + sbox[y] &amp; <span class="number">255</span>]</span><br><span class="line">                data_xor_iv.append(idx^k^<span class="number">17</span>)</span><br><span class="line">    <span class="keyword">return</span> data_xor_iv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    mt_string = <span class="built_in">bytes</span>([random.getrandbits(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40000</span>)])</span><br><span class="line">    encrypted_data = faulty_rc4_encrypt(mt_string)</span><br><span class="line">    </span><br><span class="line">    p = nextprime(random.getrandbits(<span class="number">512</span>))</span><br><span class="line">    q = nextprime(random.getrandbits(<span class="number">512</span>))</span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    </span><br><span class="line">    flag_number = bytes_to_long(flag.encode())</span><br><span class="line">    encrypted_flag = <span class="built_in">pow</span>(flag_number, e, n)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data_RC4.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(encrypted_data))</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>, e)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;encrypted_flag =&quot;</span>, encrypted_flag)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 26980604887403283496573518645101009757918606698853458260144784342978772393393467159696674710328131884261355662514745622491261092465745269577290758714239679409012557118030398147480332081042210408218887341210447413254761345186067802391751122935097887010056608819272453816990951833451399957608884115252497940851</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">encrypted_flag = 22847144372366781807296364754215583869872051137564987029409815879189317730469949628642001732153066224531749269434313483657465708558426141747771243442436639562785183869683190497179323158809757566582076031163900773712582568942616829434508926165117919744857175079480357695183964845638413639130567108300906156467</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜RC4çš„å®ç°çš„é—®é¢˜å‡ºåœ¨äº†swapéƒ¨åˆ†ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">sbox[i] = sbox[j]  </span><br><span class="line">sbox[j] = sbox[i]</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å¯¼è‡´çš„åœ¨å¤šæ¬¡è¿›è¡Œäº¤æ¢åï¼Œsboxä¸­çš„å€¼ä¼šæ…¢æ…¢åŒåŒ–ï¼Œè€Œè¿™é¢˜åœ¨åŠ å¯†åé¢20000bitsçš„æ•°æ®æ—¶ï¼Œsboxä¸­çš„å€¼å·²ç»å®Œå…¨ä¸€æ ·äº†ï¼Œæ‰€ä»¥å¯ä»¥æšä¸¾sboxï¼Œå¾—åˆ°åé¢20000bitsçš„æ•°æ®ï¼Œè¿™20000bitsçš„æ•°æ®ï¼Œç”¨æ¥ç ´è§£pythonçš„éšæœºæ•°ç³»ç»Ÿå®Œå…¨è¶³å¤Ÿäº†ï¼Œä¹‹åå°±å¯ä»¥é¢„æµ‹åé¢çš„ç´ æ•°ç”Ÿæˆï¼Œæ±‚è§£RSAäº†ã€‚
exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, setstate, getstate</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">SAMPLES = <span class="number">20000</span>//<span class="number">8</span></span><br><span class="line">M = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">19968</span>):</span><br><span class="line">    state = [<span class="built_in">int</span>(<span class="number">0</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">    state[i//<span class="number">32</span>] = <span class="built_in">int</span>(<span class="number">1</span> &lt;&lt; (<span class="number">31</span> - (i%<span class="number">32</span>)))</span><br><span class="line">    setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(state+[<span class="built_in">int</span>(<span class="number">624</span>)]), <span class="literal">None</span>))</span><br><span class="line">    [getrandbits(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40000</span>-SAMPLES)]</span><br><span class="line">    v = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(SAMPLES):</span><br><span class="line">        v += [<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">bin</span>(<span class="built_in">int</span>(getrandbits(<span class="number">8</span>)))[<span class="number">2</span>:].zfill(<span class="number">8</span>)]</span><br><span class="line">    M.append(v)</span><br><span class="line">M = matrix(GF(<span class="number">2</span>), M)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(M.dimensions())</span></span><br><span class="line"><span class="comment"># print(M.rank())</span></span><br><span class="line"><span class="comment"># (19968, 20000)</span></span><br><span class="line"><span class="comment"># 19937</span></span><br><span class="line"></span><br><span class="line">KK = M[:<span class="number">32</span>,  <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">32</span>, <span class="number">19968</span>))]</span><br><span class="line"><span class="built_in">print</span>(KK.dimensions())</span><br><span class="line">MM = M[<span class="number">32</span>:,  <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">32</span>, <span class="number">19968</span>))]</span><br><span class="line"><span class="built_in">print</span>(MM.dimensions())</span><br><span class="line"><span class="built_in">print</span>(MM.rank())</span><br><span class="line">MM_inv = MM^(-<span class="number">1</span>)</span><br><span class="line">a0 = matrix(GF(<span class="number">2</span>), [[<span class="number">1</span>] + [<span class="number">0</span>]*<span class="number">31</span>])</span><br><span class="line"></span><br><span class="line">C = [...] <span class="comment"># data_RC4.txt</span></span><br><span class="line">n = <span class="number">26980604887403283496573518645101009757918606698853458260144784342978772393393467159696674710328131884261355662514745622491261092465745269577290758714239679409012557118030398147480332081042210408218887341210447413254761345186067802391751122935097887010056608819272453816990951833451399957608884115252497940851</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">encrypted_flag = <span class="number">22847144372366781807296364754215583869872051137564987029409815879189317730469949628642001732153066224531749269434313483657465708558426141747771243442436639562785183869683190497179323158809757566582076031163900773712582568942616829434508926165117919744857175079480357695183964845638413639130567108300906156467</span></span><br><span class="line"><span class="keyword">for</span> sbox <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">    <span class="comment"># print(sbox)</span></span><br><span class="line">    v = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> C[<span class="number">40000</span>-SAMPLES:]:</span><br><span class="line">        v += [<span class="built_in">int</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">bin</span>(i^^<span class="number">17</span>^^sbox)[<span class="number">2</span>:].zfill(<span class="number">8</span>)]</span><br><span class="line">    s = matrix(GF(<span class="number">2</span>), [v[<span class="number">32</span>: <span class="number">19968</span>]])</span><br><span class="line">    v = s + a0*KK</span><br><span class="line">    sol = v*MM_inv</span><br><span class="line">    final_state = a0.<span class="built_in">list</span>()+sol.<span class="built_in">list</span>()</span><br><span class="line">    state = [<span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join([<span class="built_in">str</span>(j) <span class="keyword">for</span> j <span class="keyword">in</span> final_state[<span class="number">32</span>*i:<span class="number">32</span>*i+<span class="number">32</span>]]), <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>)]</span><br><span class="line">    <span class="keyword">if</span> state[<span class="number">0</span>] != <span class="number">1</span>&lt;&lt;<span class="number">31</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(state+[<span class="built_in">int</span>(<span class="number">624</span>)]), <span class="literal">None</span>))</span><br><span class="line">    [getrandbits(<span class="number">8</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40000</span>)]</span><br><span class="line">    p = nextprime(getrandbits(<span class="number">512</span>))</span><br><span class="line">    <span class="keyword">if</span> n%p == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag = <span class="built_in">pow</span>(encrypted_flag, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag)))</span><br><span class="line"><span class="comment"># VNCTF&#123;FL4w3d_RC4_C0nv3rg3s_2_123_4nd_M1nd_Sm4ller_MT_Brut3&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="fwshikaku">*fwshikaku</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime </span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_handle_timeout</span>(<span class="params">signum, frame</span>):</span><br><span class="line">    <span class="keyword">raise</span> TimeoutError(<span class="string">&#x27;function timeout&#x27;</span>)</span><br><span class="line"></span><br><span class="line">timeout = <span class="number">450</span></span><br><span class="line">signal.signal(signal.SIGALRM, _handle_timeout)</span><br><span class="line">signal.alarm(timeout)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uniform_sample</span>(<span class="params">n, bound, SecureRandom</span>):</span><br><span class="line">    <span class="keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice_sample</span>(<span class="params">n, L, SecureRandom</span>):</span><br><span class="line">    <span class="keyword">return</span> [SecureRandom.choice(L) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line">n = <span class="number">197</span></span><br><span class="line">m = <span class="number">19700</span></span><br><span class="line">q = getPrime(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">e_L = [random.randrange(<span class="number">0</span>, q-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">R_s = random.SystemRandom()</span><br><span class="line">R_e = random.SystemRandom()</span><br><span class="line"></span><br><span class="line">s = np.array(uniform_sample(n, q//<span class="number">2</span>, R_s))</span><br><span class="line">e = np.array(choice_sample(m,  e_L, R_e))</span><br><span class="line"></span><br><span class="line">seed = os.urandom(<span class="number">16</span>)</span><br><span class="line">R_A = random</span><br><span class="line">R_A.seed(seed)</span><br><span class="line">A = np.array([uniform_sample(n, q, R_A) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)])</span><br><span class="line">b = (A.dot(s) + e) % q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;q = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e_L = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;seed.<span class="built_in">hex</span>() = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b.tolist() = &#125;</span>&quot;</span>) </span><br><span class="line"></span><br><span class="line">s_ = <span class="built_in">input</span>(<span class="string">&quot;Give me s: &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> s_ == <span class="built_in">str</span>(s.tolist()):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Congratulations! You have signed in successfully.&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(FLAG)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Sorry, you cannot sign in.&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜æ¯”èµ›çš„æ—¶å€™å°±æœ‰æ€è·¯äº†ï¼Œä½†æ˜¯æ²¡å†™å‡ºæ¥ï¼Œå› ä¸ºå½“æ—¶çš„æ€è·¯æ˜¯æ±‚è§£ä¸€ä¸ª19700ç»´çš„æ–¹ç¨‹ç»„ï¼Œä½†æ˜¯æˆ‘è¿™å†…å­˜ä¸å¤Ÿï¼Œæ¯æ¬¡ä½¿ç”¨sageçš„æ±‚è§£å™¨éƒ½ä¼šå´©æºƒï¼Œè€Œä¸”sageçš„solve_rightæ–¹æ³•é»˜è®¤æ˜¯å•çº¿ç¨‹çš„ï¼Œæ‰€ä»¥å°±ç®—å†…å­˜å¤Ÿï¼Œæ—¶é—´ä¹Ÿä¸å¤Ÿï¼Œå› ä¸ºé¢˜ç›®ç»™äº†450sçš„é™æ—¶ã€‚èµ›åå‡çº§äº†ä¸€ä¸‹å†…å­˜ï¼Œä¹Ÿé¡ºä¾¿ç ”ç©¶äº†ä¸€ä¸‹solve_rightçš„å¤šçº¿ç¨‹ï¼Œå°±æŠŠè¿™é¢˜å¤åˆ»äº†ä¸€éã€‚</p>
<h4 id="æ€è·¯">æ€è·¯</h4>
<p>è¿™é¢˜å…·ä½“çš„æ€è·¯å¦‚ä¸‹: é¢˜ç›®ä¼šç”Ÿæˆä¸€ä¸ªç§˜å¯†å‘é‡<span class="math inline">\(\mathbf{s}\)</span>ï¼Œç„¶åå°†<span class="math inline">\(\mathbf{s}\)</span>è¿›è¡Œå¦‚ä¸‹æ“ä½œ: <span class="math display">\[
\mathbf{c}_{19700 \times 1} = \mathbf{A}_{19700 \times 197}
\mathbf{s}_{197 \times 1} + \mathbf{e}_{19700 \times 1}
\]</span></p>
<p>ç„¶åæŠŠ<span class="math inline">\(\mathbf{c},
\mathbf{A}\)</span>å‘é€ç»™æˆ‘ä»¬ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°<span class="math inline">\(\mathbf{s}\)</span>å°±èƒ½è·å¾—flagã€‚è¿™é¢˜å…³é”®åœ¨äºæˆ‘ä»¬ä¸çŸ¥é“<span class="math inline">\(\mathbf{e}\)</span>ï¼Œä½†æ˜¯åªçŸ¥é“<span class="math inline">\(\mathbf{e}\)</span>ä¸­çš„æ¯ä¸ªåˆ†é‡éƒ½æ˜¯ä»e_Lè¿™ä¸ªåˆ—è¡¨äºŒé€‰ä¸€å¾—åˆ°çš„ï¼Œæ‰€ä»¥å¯¹äº<span class="math inline">\(\mathbf{A}\)</span>çš„æ¯è¡Œï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°: <span class="math display">\[
\begin{gather}
c_i = (a_{i0}, a_{i1}, \cdots, a_{i196})
\begin{pmatrix}
s_0\\
s_1\\
\vdots\\
s_{196}\\
\end{pmatrix} + e\_L[0] \\
\mathrm{or} \\
c_i = (a_{i0}, a_{i1}, \cdots, a_{i196})
\begin{pmatrix}
s_0\\
s_1\\
\vdots\\
s_{196}\\
\end{pmatrix} + e\_L[1]
\end{gather}
\]</span></p>
<p>ç¨å¾®å˜å½¢å¾—ï¼š <span class="math display">\[
\begin{gather}
a_{i0}s_0 + a_{i1}s_1 + \cdots + a_{i196}s_{196} + e\_L[0] - c_i = 0  
\\ \mathrm{or}\\
a_{i0}s_0 + a_{i1}s_1 + \cdots + a_{i196}s_{196} + e\_L[1] - c_i = 0  
\end{gather}
\]</span>
è™½ç„¶è¿™ä¸¤ä¸ªç­‰å¼ä¸çŸ¥é“å“ªä¸€ä¸ªä¼šæˆç«‹ï¼Œä½†æ˜¯æˆ‘ä»¬èƒ½å¾—å‡ºä¸‹é¢è¿™ä¸ªå¼å­ä¸€å®šæˆç«‹:
<span class="math display">\[
(a_{i0}s_0 + a_{i1}s_1 + \cdots + a_{i196}s_{196} + e\_L[0] -
c_i)*(a_{i0}s_0 + a_{i1}s_1 + \cdots + a_{i196}s_{196} + e\_L[1] - c_i)
= 0  
\]</span>
è¿™ä¸ªæ–¹ç¨‹æ˜¯äºŒæ¬¡çš„ï¼Œå«æœ‰197æœªçŸ¥é‡ï¼Œå³ä½¿æˆ‘ä»¬èƒ½è·å–åˆ°19700ä¸ªè¿™æ ·çš„ç­‰å¼ï¼Œæƒ³è¦æ±‚è§£ä»–ä»¬ä¹Ÿæ˜¯å¾ˆå›°éš¾çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½æ¥å°†æ–¹ç¨‹è¡Œçº¿æ€§åŒ–ï¼Œæˆ‘ä»¬ç›´æ¥æ‰“å¼€ä¸Šé¢çš„æ‹¬å·:
<span class="math display">\[
\begin{gather}
a_{i0}^2s_{0}^2 + a_{i1}^2s_{1}^2 + \cdots + a_{i196}^2s_{196}^2 + \\
2a_{i0}a_{i1}s_{0}s_{1} + 2a_{i0}a_{2}s_{i0}s_{2} + \cdots +
2a_{i195}a_{i196}s_{195}s_{196} + \\
a_{i0}(e\_L[0]+e\_L[1]-2c_i)s_{0} + a_{i1}(e\_L[0]+e\_L[1]-2c_i)s_{1} +
\cdots + a_{i196}(e\_L[0]+e\_L[1]-2c_i)s_{196} \\
= (c_i-e\_L[0])(c_i-e\_L[1])
\end{gather}
\]</span>
æ‰“å¼€åæˆ‘ä»¬å‘ç°ç­‰å·å·¦è¾¹åˆšå¥½19700é¡¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠå·¦è¾¹çš„æ¯ä¸€é¡¹çš„æœªçŸ¥é‡éƒ½ç”¨ä¸€ä¸ªæ–°çš„æœªçŸ¥é‡ä»£æ›¿ï¼š
<span class="math display">\[
a_{i0}^2x_{0} + a_{i1}^2x_{1} + \cdots +
a_{i196}(e\_L[0]+e\_L[1]-2c_i)x_{19699} = (c_i-e\_L[0])(c_i-e\_L[1])
\]</span>
è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ª19700ä¸ªæœªçŸ¥é‡çš„çº¿æ€§æ–¹ç¨‹äº†ï¼Œè€Œè¿™æ ·çš„æ–¹ç¨‹ä¸€å…±æœ‰19700ä¸ªï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨sageçš„solve_rightæ±‚è§£äº†ã€‚</p>
<h4 id="å¤šçº¿ç¨‹solve_right">å¤šçº¿ç¨‹solve_right</h4>
<p>sageçš„çº¿æ€§ä»£æ•°æ“ä½œæ˜¯åŸºäºBLAS(Basic Linear Algebra
Subprograms)æ¥å£çš„ï¼Œè€Œå¯¹äºè¿™ä¸ªæ¥å£çš„å®ç°ï¼Œä¸€èˆ¬éƒ½æ˜¯æ“ä½œç³»ç»Ÿè‡ªå¸¦çš„å®ç°ï¼Œå®ƒä¸»è¦ä¿è¯äº†ç¨³å®šæ€§ï¼Œä½†åœ¨æ•ˆç‡æ–¹é¢ä¸€èˆ¬ï¼Œè€Œä¸”ä¸èƒ½ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸ªé»˜è®¤çš„å®ç°æ›´æ¢æ‰ï¼Œè¿™é‡Œæˆ‘æ¢æˆäº†openblas:
é€šè¿‡<code>sudo pacman -S openblas</code>å®‰è£…openblasï¼Œ
é€šè¿‡<code>sudo pacman -S blas-openblas</code>å®‰è£…blas-openblasï¼Œè¿™ä¸ªåŒ…ä¼šå°†ç³»ç»Ÿé»˜è®¤
blas æ›¿æ¢ä¸º openblasã€‚</p>
<h4 id="exp">exp</h4>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uniform_sample</span>(<span class="params">n, bound, SecureRandom</span>):</span><br><span class="line">    <span class="keyword">return</span> [SecureRandom.randrange(-bound, bound) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice_sample</span>(<span class="params">n, L, SecureRandom</span>):</span><br><span class="line">    <span class="keyword">return</span> [SecureRandom.choice(L) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;node.vnteam.cn&quot;</span>, <span class="number">47987</span>)</span><br><span class="line">q = <span class="built_in">int</span>(io.recvline().decode().strip().split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">e_L = <span class="built_in">eval</span>(io.recvline().decode().strip().split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line">seed = <span class="built_in">bytes</span>.fromhex(io.recvline().decode().strip().split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>].strip(<span class="string">&quot;&#x27;&quot;</span>))</span><br><span class="line">b = <span class="built_in">eval</span>(io.recvline().decode().strip().split(<span class="string">&quot; = &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;æ•°æ®æ”¶é›†å®Œæˆ&quot;</span>)</span><br><span class="line">R_A = random</span><br><span class="line">R_A.seed(seed)</span><br><span class="line"></span><br><span class="line">A = [uniform_sample(<span class="number">197</span>, q, R_A) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19700</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_row_task</span>(<span class="params">begin, end</span>):</span><br><span class="line">    M_i = random_matrix(ZZ, end-begin, <span class="number">19700</span>)</span><br><span class="line">    row = [<span class="number">0</span>] * <span class="number">19700</span>  <span class="comment"># åˆå§‹åŒ–ä¸€è¡Œæ•°æ®ZZ</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(begin, end):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">197</span>):</span><br><span class="line">            row[i] = A[k][i] ** <span class="number">2</span></span><br><span class="line">        cnt = <span class="number">197</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">197</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="number">197</span>):</span><br><span class="line">                row[cnt] = <span class="number">2</span> * A[k][i] * A[k][j]</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">197</span>):</span><br><span class="line">            row[cnt] = A[k][i] * (e_L[<span class="number">0</span>] + e_L[<span class="number">1</span>] - <span class="number">2</span> * b[k])</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">        M_i[k-begin] = row</span><br><span class="line">    <span class="keyword">return</span> M_i</span><br><span class="line"></span><br><span class="line">begin = time.time()</span><br><span class="line">dim = <span class="number">19700</span></span><br><span class="line">num = <span class="number">8</span></span><br><span class="line">gap = dim // num</span><br><span class="line">M = matrix(GF(q), [[<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">19700</span>)]])</span><br><span class="line"><span class="keyword">with</span> ProcessPoolExecutor(max_workers=num) <span class="keyword">as</span> executor:</span><br><span class="line">    future_all = [executor.submit(get_row_task, gap*i, gap*(i+<span class="number">1</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num)] + [executor.submit(get_row_task, gap*<span class="number">8</span>, dim)]</span><br><span class="line">    <span class="keyword">for</span> future <span class="keyword">in</span> future_all:</span><br><span class="line">        M = M.stack(future.result())</span><br><span class="line">M = M[<span class="number">1</span>:]</span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;çŸ©é˜µ M å¡«å……å®Œæˆï¼Œè€—æ—¶<span class="subst">&#123;end-begin&#125;</span>s&quot;</span>)</span><br><span class="line"></span><br><span class="line">begin = time.time()</span><br><span class="line">y = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(dim):</span><br><span class="line">    y.append(-(b[i]-e_L[<span class="number">0</span>])*(b[i]-e_L[<span class="number">1</span>]))</span><br><span class="line">y = vector(GF(q), y)</span><br><span class="line">x = M.solve_right(y)</span><br><span class="line">end = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ±‚è§£å®Œæˆï¼Œè€—æ—¶<span class="subst">&#123;end-begin&#125;</span>s&quot;</span>)</span><br><span class="line">s = x[-<span class="number">197</span>:].change_ring(ZZ).<span class="built_in">list</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">    <span class="keyword">if</span> s[i] &gt;= q//<span class="number">2</span>:</span><br><span class="line">        s[i] -= q</span><br><span class="line">s = np.array(s)</span><br><span class="line">io.recvuntil(<span class="string">b&quot;Give me s: &quot;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(s.tolist()).encode())</span><br><span class="line"><span class="built_in">print</span>(io.recvline())</span><br><span class="line">flag = io.recvline()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">çŸ©é˜µ M å¡«å……å®Œæˆï¼Œè€—æ—¶103.08421277999878s</span><br><span class="line">æ±‚è§£å®Œæˆï¼Œè€—æ—¶145.3967547416687s</span><br><span class="line">VNCTF&#123;Wh3%_th3rr0R_c@nd1d@t3s_0f_L3@rn1n9-w1tH-3r^20r_1s_sm4ll,it_WoulD_b3-R3411Y_D4ng3r0us!!&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>2025GHCTFæ–°ç”Ÿèµ›-Crypto-WP</title>
    <url>/2025/03/06/2025GHCTF%E6%96%B0%E7%94%9F%E8%B5%9B-Crypto-WP/</url>
    <content><![CDATA[<p>é‡åˆ°äº†å‡ ä¸ªæœ‰æ„æ€çš„é¢˜è®°å½•ä¸€ä¸‹</p>
<span id="more"></span>
<h3 id="babysign">babysign</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line">p=getPrime(<span class="number">128</span>)</span><br><span class="line">q=getPrime(<span class="number">128</span>)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">flag=<span class="string">&quot;NSSCTF&#123;xxxxxx&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">m=bytes_to_long(flag.encode())</span><br><span class="line">e=<span class="number">4</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 182756071972245688517047475576147877841</span></span><br><span class="line"><span class="string">q= 305364532854935080710443995362714630091</span></span><br><span class="line"><span class="string">c= 14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line"><span class="string">n= 55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>å¯ä»¥å‘ç°è¿™é‡Œ<span class="math inline">\(e\)</span>ä¸ºå¶æ•°ï¼Œä¸<span class="math inline">\(\phi(n)\)</span>æ˜¯ä¸äº’ç´ çš„ï¼Œæ‰€ä»¥æ²¡åŠæ³•æ±‚å‡º<span class="math inline">\(d\)</span>ï¼Œè¿™é‡Œå®é™…ä¸Šæ˜¯éœ€åœ¨æ¨¡ç´ æ•°çš„æƒ…å†µä¸‹å¼€4æ¬¡æ–¹æ ¹ï¼Œå¼€æ ¹å¯ä»¥ç›´æ¥ç”¨sagemathçš„rootsæ–¹æ³•ï¼Œç”±äºæ˜¯åœ¨æ¨¡pï¼Œqçš„æƒ…å†µä¸‹åˆ†åˆ«å¼€æ ¹çš„ï¼Œæ‰€ä»¥è¦ç”¨CRTå°†pï¼Œqåˆå¹¶ã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p= <span class="number">182756071972245688517047475576147877841</span></span><br><span class="line">q= <span class="number">305364532854935080710443995362714630091</span></span><br><span class="line">c= <span class="number">14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line">n= <span class="number">55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line">PR.&lt;x&gt; = ZZ[]</span><br><span class="line">f = x^<span class="number">4</span> - c</span><br><span class="line">mp = [<span class="built_in">int</span>(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> f.change_ring(GF(p)).roots()]</span><br><span class="line">mq = [<span class="built_in">int</span>(i[<span class="number">0</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> f.change_ring(GF(q)).roots()]</span><br><span class="line"><span class="keyword">for</span> m1 <span class="keyword">in</span> mp:</span><br><span class="line">    <span class="keyword">for</span> m2 <span class="keyword">in</span> mq:</span><br><span class="line">        m = crt([m1, m2], [p, q])</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># NSSCTF&#123;4MM_1s_so_e4s7!&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="baby_factor">baby_factor</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>():</span><br><span class="line">    pl  = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        pl.append(getPrime(<span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(pl)</span><br><span class="line">pl = create()</span><br><span class="line">m=<span class="string">b&#x27;NSSCTF&#123;xxx&#125;&#x27;</span></span><br><span class="line">p,q,r = pl[<span class="number">0</span>],pl[<span class="number">1</span>],pl[<span class="number">2</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(m),e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n=<span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;phi=<span class="subst">&#123;phi&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n=2741832985459799195551463586200496171706401045582705736390510500694289553647578857170635209048629428396407631873312962021354740290808869502374444435394061448767702908255197762575345798570340246369827688321483639197634802985398882606068294663625992927239602442735647762662536456784313240499437659967114509197846086151042512153782486075793224874304872205720564733574010669935992016367832666397263951446340260962650378484847385424893514879629196181114844346169851383460163815147712907264437435463059397586675769959094397311450861780912636566993749356097243760640620004707428340786147078475120876426087835327094386842765660642186546472260607586011343238080538092580452700406255443887820337778505999803772196923996033929998741437250238302626841957729397241851219567703420968177784088484002831289722211924810899441563382481216744212304879717297444824808184727136770899310815544776369231934774967139834384853322157766059825736075553</span></span><br><span class="line"><span class="string">phi=2741832985459799195551463586200496171706401045582705736390510500694289553647578857170635209048629428396407631873312962021354740290808869502374444435394061448767702908255197762575345798570340246369827688321483639197634802985398882606068294663625992927239602442735647762662536456784313240499437659967114509197784246608456057052779643060628984335578973450260519106769911425793594847759982583376628098472390090331415895352869275325656949958242181688663465437185437198392460569653734315961071709533645370007008616755547195108861900432818710027794402838336405197750190466425895582236209479543326147804766393022786785337752319686125574507066082357748118175068545756301823381723776525427724798780890160482013759497102382173931716030992837059880049832065500252713739288235410544982532170147652055063681116147027591678349638753796122845041417275362394757384204924094885233281257928031484806977974575497621444483701792085077113227851520</span></span><br><span class="line"><span class="string">c=2675023626005191241628571734421094007494866451142251352071850033504791090546156004348738217761733467156596330653396106482342801412567035848069931148880296036606611571818493841795682186933874790388789734748415540102210757974884805905578650801916130709273985096229857987312816790471330181166965876955546627327549473645830218664078284830699777113214559053294592015697007540297033755845037866295098660371843447432672454589238297647906075964139778749351627739005675106752803394387612753005638224496040203274119150075266870378506841838513636541340104864561937527329845541975189814018246183215952285198950920021711141273569490277643382722047159198943471946774301837440950402563578645113393610924438585345876355654972759318203702572517614743063464534582417760958462550905093489838646250677941813170355212088529993225869303917882372480469839803533981671743959732373159808299457374754090436951368378994871937358645247263240789585351233</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure> å¤šç´ æ•°çš„RSAï¼Œç”±äºç»™äº†<span class="math inline">\(\phi(n)\)</span>ï¼Œæ‰€ä»¥å’Œå¸¸è§„çš„RSAä¸€æ ·ï¼Œå¯ä»¥ç›´æ¥æ±‚å‡ºè§£å¯†æŒ‡æ•°<span class="math inline">\(d\)</span>ã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n=<span class="number">2741832985459799195551463586200496171706401045582705736390510500694289553647578857170635209048629428396407631873312962021354740290808869502374444435394061448767702908255197762575345798570340246369827688321483639197634802985398882606068294663625992927239602442735647762662536456784313240499437659967114509197846086151042512153782486075793224874304872205720564733574010669935992016367832666397263951446340260962650378484847385424893514879629196181114844346169851383460163815147712907264437435463059397586675769959094397311450861780912636566993749356097243760640620004707428340786147078475120876426087835327094386842765660642186546472260607586011343238080538092580452700406255443887820337778505999803772196923996033929998741437250238302626841957729397241851219567703420968177784088484002831289722211924810899441563382481216744212304879717297444824808184727136770899310815544776369231934774967139834384853322157766059825736075553</span></span><br><span class="line">phi=<span class="number">2741832985459799195551463586200496171706401045582705736390510500694289553647578857170635209048629428396407631873312962021354740290808869502374444435394061448767702908255197762575345798570340246369827688321483639197634802985398882606068294663625992927239602442735647762662536456784313240499437659967114509197784246608456057052779643060628984335578973450260519106769911425793594847759982583376628098472390090331415895352869275325656949958242181688663465437185437198392460569653734315961071709533645370007008616755547195108861900432818710027794402838336405197750190466425895582236209479543326147804766393022786785337752319686125574507066082357748118175068545756301823381723776525427724798780890160482013759497102382173931716030992837059880049832065500252713739288235410544982532170147652055063681116147027591678349638753796122845041417275362394757384204924094885233281257928031484806977974575497621444483701792085077113227851520</span></span><br><span class="line">c=<span class="number">2675023626005191241628571734421094007494866451142251352071850033504791090546156004348738217761733467156596330653396106482342801412567035848069931148880296036606611571818493841795682186933874790388789734748415540102210757974884805905578650801916130709273985096229857987312816790471330181166965876955546627327549473645830218664078284830699777113214559053294592015697007540297033755845037866295098660371843447432672454589238297647906075964139778749351627739005675106752803394387612753005638224496040203274119150075266870378506841838513636541340104864561937527329845541975189814018246183215952285198950920021711141273569490277643382722047159198943471946774301837440950402563578645113393610924438585345876355654972759318203702572517614743063464534582417760958462550905093489838646250677941813170355212088529993225869303917882372480469839803533981671743959732373159808299457374754090436951368378994871937358645247263240789585351233</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;W0W!!_Y0u_4r3_g00d_G03!!!&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="ez_fermat">EZ_Fermat</h3>
<p>é¢˜ç›®: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> f</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;test_flag&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line">f = R(<span class="built_in">str</span>(f))</span><br><span class="line"></span><br><span class="line">w = <span class="built_in">pow</span>(<span class="number">2</span>,f(p),n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;f = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;w = &#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span></span><br><span class="line"><span class="string">f = 2*x^332 - x^331 + x^329 + 3*x^328 - x^327 - 3*x^325 + x^323 - 3*x^322 - x^321 - 3*x^320 + x^319 + 2*x^318 - 4*x^317 - 3*x^315 - 2*x^314 + x^313 + x^312 + 2*x^311 + 2*x^309 + 2*x^308 + 5*x^307 + 2*x^306 + 3*x^305 + 5*x^304 + 4*x^303 + x^302 - x^301 - x^300 - 2*x^299 - 2*x^298 + x^297 + 3*x^296 - x^295 - 4*x^292 - x^290 + 4*x^289 - x^287 - 3*x^286 + x^285 - 2*x^284 + x^283 - x^282 - 2*x^281 + x^280 - 2*x^279 + x^278 + 2*x^277 - 3*x^276 - x^275 - 4*x^274 - 3*x^273 - 5*x^272 - 2*x^271 - 3*x^270 + 2*x^269 + 2*x^268 - x^267 - 2*x^266 + x^265 + x^264 - 3*x^262 - 3*x^259 + 2*x^258 - x^257 + 2*x^256 + 2*x^255 - x^254 - 2*x^253 - x^252 + 2*x^251 - x^250 + x^249 + 2*x^247 + 2*x^246 + 2*x^245 - 2*x^244 - 3*x^243 + 2*x^242 - 3*x^241 - x^240 - 3*x^239 - x^236 - 3*x^235 - 2*x^234 - x^233 - 2*x^232 - x^231 - 3*x^230 - 2*x^229 - 4*x^228 - 2*x^227 - 3*x^226 + 2*x^225 + x^224 - x^223 - 2*x^221 + 3*x^219 - x^217 - 2*x^216 + x^215 + 2*x^213 - x^212 + 3*x^211 + x^210 + 4*x^209 + x^208 - x^206 - x^205 - x^204 + 2*x^203 - 3*x^202 + 2*x^199 - x^198 + 2*x^196 - 2*x^195 + 3*x^194 + 3*x^193 - x^192 + 4*x^191 + 2*x^189 + x^186 - x^185 - x^184 + 3*x^183 + x^182 + 2*x^181 - 2*x^180 + x^177 + x^175 - x^173 + 3*x^172 + x^170 + x^169 - x^167 - 2*x^166 - x^165 - 4*x^164 - 2*x^163 + 2*x^162 + 4*x^161 - 2*x^160 - 3*x^159 - 2*x^158 - 2*x^157 + x^156 - x^155 + 3*x^154 - 4*x^153 + x^151 + 2*x^150 + x^149 - x^148 + 2*x^147 + 3*x^146 + 2*x^145 - 4*x^144 - 4*x^143 + x^142 - 2*x^140 - 2*x^139 + 2*x^138 + 3*x^137 + 3*x^136 + 3*x^135 + x^134 - x^133 + 2*x^132 + 3*x^130 - 3*x^129 - 2*x^128 - x^127 - 2*x^126 + x^125 + x^124 - 2*x^123 + x^122 - x^121 + 3*x^120 - x^119 - 2*x^118 - x^117 - x^116 - 2*x^115 + 2*x^114 + 2*x^113 - 3*x^112 - x^111 - 4*x^110 + x^109 + x^108 + x^106 - 4*x^105 + x^104 - x^103 - x^101 + x^100 - 2*x^99 + x^98 - x^97 + 3*x^96 + 3*x^94 - x^93 - x^92 + x^91 - 2*x^90 + x^89 - x^88 + x^87 - x^86 + x^85 + x^84 - x^83 + x^79 - 3*x^78 - 2*x^77 + x^74 + 3*x^73 - x^72 - 3*x^71 - 2*x^70 + x^69 - 3*x^66 + x^65 + x^64 - 4*x^62 - x^61 + x^60 - x^59 + 3*x^58 - x^57 - x^54 + 3*x^53 + x^51 - 3*x^50 - x^49 + 2*x^47 - x^46 - x^44 + x^43 - x^42 - 4*x^41 - 3*x^39 - x^37 - x^36 - 3*x^35 + x^34 + x^33 - 2*x^32 + 2*x^31 - x^30 + 2*x^29 - 2*x^28 - 2*x^27 - x^24 + x^22 - 5*x^21 + 3*x^20 + 2*x^19 - x^18 + 2*x^17 + x^16 - 2*x^15 - 2*x^14 + x^13 + x^12 + 2*x^11 - 3*x^10 + 3*x^9 + 2*x^8 - 4*x^6 - 2*x^5 - 4*x^4 + x^3 - x^2 - 1</span></span><br><span class="line"><span class="string">w = 32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜çœ‹é¢˜ç›®å°±çŸ¥é“è¦ç”¨è´¹é©¬å°å®šç†: <span class="math display">\[
pä¸ºç´ æ•°ï¼Œå¯¹ä»»æ„çš„æ•´æ•°aï¼Œæœ‰:\\
a^p \equiv a \mod p
\]</span> è¿™é‡Œè¦ç”¨åˆ°è´¹é©¬å°å®šç†çš„ä¸€ä¸ªæ¨è®º: <span class="math display">\[
a^{p^i} \equiv a \mod p
\]</span> é€šè¿‡åå¤ä½¿ç”¨è´¹é©¬å°å®šç†å¯ä»¥å¾—åˆ°è¿™ä¸ªæ¨è®ºã€‚</p>
<p>å¯¹äºé¢˜ç›®æ‰€ç»™çš„<span class="math inline">\(w\)</span>ï¼Œæœ‰: <span class="math display">\[
w \equiv 2^{f(p)} \equiv 2^{\sum^{332}_0a_ip^i} \equiv
\prod^{332}_02^{a_ip^i} \equiv \prod^{332}_02^{a_i} \mod p
\]</span></p>
<p>æ‰€ä»¥: <span class="math display">\[
p \mid w - \prod^{332}_02^{a_i}
\]</span></p>
<p>æ‰€ä»¥<span class="math inline">\(w -
\prod^{332}_02^{a_i}\)</span>ä¸<span class="math inline">\(n\)</span>çš„æœ€å¤§å…¬å› æ•°å°±æ˜¯<span class="math inline">\(p\)</span>ï¼ŒæˆåŠŸåˆ†è§£<span class="math inline">\(n\)</span>åå°±æ˜¯å¸¸è§„çš„RSAè§£å¯†äº†ã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line">n = <span class="number">101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span></span><br><span class="line">f = <span class="number">2</span>*x^<span class="number">332</span> - x^<span class="number">331</span> + x^<span class="number">329</span> + <span class="number">3</span>*x^<span class="number">328</span> - x^<span class="number">327</span> - <span class="number">3</span>*x^<span class="number">325</span> + x^<span class="number">323</span> - <span class="number">3</span>*x^<span class="number">322</span> - x^<span class="number">321</span> - <span class="number">3</span>*x^<span class="number">320</span> + x^<span class="number">319</span> + <span class="number">2</span>*x^<span class="number">318</span> - <span class="number">4</span>*x^<span class="number">317</span> - <span class="number">3</span>*x^<span class="number">315</span> - <span class="number">2</span>*x^<span class="number">314</span> + x^<span class="number">313</span> + x^<span class="number">312</span> + <span class="number">2</span>*x^<span class="number">311</span> + <span class="number">2</span>*x^<span class="number">309</span> + <span class="number">2</span>*x^<span class="number">308</span> + <span class="number">5</span>*x^<span class="number">307</span> + <span class="number">2</span>*x^<span class="number">306</span> + <span class="number">3</span>*x^<span class="number">305</span> + <span class="number">5</span>*x^<span class="number">304</span> + <span class="number">4</span>*x^<span class="number">303</span> + x^<span class="number">302</span> - x^<span class="number">301</span> - x^<span class="number">300</span> - <span class="number">2</span>*x^<span class="number">299</span> - <span class="number">2</span>*x^<span class="number">298</span> + x^<span class="number">297</span> + <span class="number">3</span>*x^<span class="number">296</span> - x^<span class="number">295</span> - <span class="number">4</span>*x^<span class="number">292</span> - x^<span class="number">290</span> + <span class="number">4</span>*x^<span class="number">289</span> - x^<span class="number">287</span> - <span class="number">3</span>*x^<span class="number">286</span> + x^<span class="number">285</span> - <span class="number">2</span>*x^<span class="number">284</span> + x^<span class="number">283</span> - x^<span class="number">282</span> - <span class="number">2</span>*x^<span class="number">281</span> + x^<span class="number">280</span> - <span class="number">2</span>*x^<span class="number">279</span> + x^<span class="number">278</span> + <span class="number">2</span>*x^<span class="number">277</span> - <span class="number">3</span>*x^<span class="number">276</span> - x^<span class="number">275</span> - <span class="number">4</span>*x^<span class="number">274</span> - <span class="number">3</span>*x^<span class="number">273</span> - <span class="number">5</span>*x^<span class="number">272</span> - <span class="number">2</span>*x^<span class="number">271</span> - <span class="number">3</span>*x^<span class="number">270</span> + <span class="number">2</span>*x^<span class="number">269</span> + <span class="number">2</span>*x^<span class="number">268</span> - x^<span class="number">267</span> - <span class="number">2</span>*x^<span class="number">266</span> + x^<span class="number">265</span> + x^<span class="number">264</span> - <span class="number">3</span>*x^<span class="number">262</span> - <span class="number">3</span>*x^<span class="number">259</span> + <span class="number">2</span>*x^<span class="number">258</span> - x^<span class="number">257</span> + <span class="number">2</span>*x^<span class="number">256</span> + <span class="number">2</span>*x^<span class="number">255</span> - x^<span class="number">254</span> - <span class="number">2</span>*x^<span class="number">253</span> - x^<span class="number">252</span> + <span class="number">2</span>*x^<span class="number">251</span> - x^<span class="number">250</span> + x^<span class="number">249</span> + <span class="number">2</span>*x^<span class="number">247</span> + <span class="number">2</span>*x^<span class="number">246</span> + <span class="number">2</span>*x^<span class="number">245</span> - <span class="number">2</span>*x^<span class="number">244</span> - <span class="number">3</span>*x^<span class="number">243</span> + <span class="number">2</span>*x^<span class="number">242</span> - <span class="number">3</span>*x^<span class="number">241</span> - x^<span class="number">240</span> - <span class="number">3</span>*x^<span class="number">239</span> - x^<span class="number">236</span> - <span class="number">3</span>*x^<span class="number">235</span> - <span class="number">2</span>*x^<span class="number">234</span> - x^<span class="number">233</span> - <span class="number">2</span>*x^<span class="number">232</span> - x^<span class="number">231</span> - <span class="number">3</span>*x^<span class="number">230</span> - <span class="number">2</span>*x^<span class="number">229</span> - <span class="number">4</span>*x^<span class="number">228</span> - <span class="number">2</span>*x^<span class="number">227</span> - <span class="number">3</span>*x^<span class="number">226</span> + <span class="number">2</span>*x^<span class="number">225</span> + x^<span class="number">224</span> - x^<span class="number">223</span> - <span class="number">2</span>*x^<span class="number">221</span> + <span class="number">3</span>*x^<span class="number">219</span> - x^<span class="number">217</span> - <span class="number">2</span>*x^<span class="number">216</span> + x^<span class="number">215</span> + <span class="number">2</span>*x^<span class="number">213</span> - x^<span class="number">212</span> + <span class="number">3</span>*x^<span class="number">211</span> + x^<span class="number">210</span> + <span class="number">4</span>*x^<span class="number">209</span> + x^<span class="number">208</span> - x^<span class="number">206</span> - x^<span class="number">205</span> - x^<span class="number">204</span> + <span class="number">2</span>*x^<span class="number">203</span> - <span class="number">3</span>*x^<span class="number">202</span> + <span class="number">2</span>*x^<span class="number">199</span> - x^<span class="number">198</span> + <span class="number">2</span>*x^<span class="number">196</span> - <span class="number">2</span>*x^<span class="number">195</span> + <span class="number">3</span>*x^<span class="number">194</span> + <span class="number">3</span>*x^<span class="number">193</span> - x^<span class="number">192</span> + <span class="number">4</span>*x^<span class="number">191</span> + <span class="number">2</span>*x^<span class="number">189</span> + x^<span class="number">186</span> - x^<span class="number">185</span> - x^<span class="number">184</span> + <span class="number">3</span>*x^<span class="number">183</span> + x^<span class="number">182</span> + <span class="number">2</span>*x^<span class="number">181</span> - <span class="number">2</span>*x^<span class="number">180</span> + x^<span class="number">177</span> + x^<span class="number">175</span> - x^<span class="number">173</span> + <span class="number">3</span>*x^<span class="number">172</span> + x^<span class="number">170</span> + x^<span class="number">169</span> - x^<span class="number">167</span> - <span class="number">2</span>*x^<span class="number">166</span> - x^<span class="number">165</span> - <span class="number">4</span>*x^<span class="number">164</span> - <span class="number">2</span>*x^<span class="number">163</span> + <span class="number">2</span>*x^<span class="number">162</span> + <span class="number">4</span>*x^<span class="number">161</span> - <span class="number">2</span>*x^<span class="number">160</span> - <span class="number">3</span>*x^<span class="number">159</span> - <span class="number">2</span>*x^<span class="number">158</span> - <span class="number">2</span>*x^<span class="number">157</span> + x^<span class="number">156</span> - x^<span class="number">155</span> + <span class="number">3</span>*x^<span class="number">154</span> - <span class="number">4</span>*x^<span class="number">153</span> + x^<span class="number">151</span> + <span class="number">2</span>*x^<span class="number">150</span> + x^<span class="number">149</span> - x^<span class="number">148</span> + <span class="number">2</span>*x^<span class="number">147</span> + <span class="number">3</span>*x^<span class="number">146</span> + <span class="number">2</span>*x^<span class="number">145</span> - <span class="number">4</span>*x^<span class="number">144</span> - <span class="number">4</span>*x^<span class="number">143</span> + x^<span class="number">142</span> - <span class="number">2</span>*x^<span class="number">140</span> - <span class="number">2</span>*x^<span class="number">139</span> + <span class="number">2</span>*x^<span class="number">138</span> + <span class="number">3</span>*x^<span class="number">137</span> + <span class="number">3</span>*x^<span class="number">136</span> + <span class="number">3</span>*x^<span class="number">135</span> + x^<span class="number">134</span> - x^<span class="number">133</span> + <span class="number">2</span>*x^<span class="number">132</span> + <span class="number">3</span>*x^<span class="number">130</span> - <span class="number">3</span>*x^<span class="number">129</span> - <span class="number">2</span>*x^<span class="number">128</span> - x^<span class="number">127</span> - <span class="number">2</span>*x^<span class="number">126</span> + x^<span class="number">125</span> + x^<span class="number">124</span> - <span class="number">2</span>*x^<span class="number">123</span> + x^<span class="number">122</span> - x^<span class="number">121</span> + <span class="number">3</span>*x^<span class="number">120</span> - x^<span class="number">119</span> - <span class="number">2</span>*x^<span class="number">118</span> - x^<span class="number">117</span> - x^<span class="number">116</span> - <span class="number">2</span>*x^<span class="number">115</span> + <span class="number">2</span>*x^<span class="number">114</span> + <span class="number">2</span>*x^<span class="number">113</span> - <span class="number">3</span>*x^<span class="number">112</span> - x^<span class="number">111</span> - <span class="number">4</span>*x^<span class="number">110</span> + x^<span class="number">109</span> + x^<span class="number">108</span> + x^<span class="number">106</span> - <span class="number">4</span>*x^<span class="number">105</span> + x^<span class="number">104</span> - x^<span class="number">103</span> - x^<span class="number">101</span> + x^<span class="number">100</span> - <span class="number">2</span>*x^<span class="number">99</span> + x^<span class="number">98</span> - x^<span class="number">97</span> + <span class="number">3</span>*x^<span class="number">96</span> + <span class="number">3</span>*x^<span class="number">94</span> - x^<span class="number">93</span> - x^<span class="number">92</span> + x^<span class="number">91</span> - <span class="number">2</span>*x^<span class="number">90</span> + x^<span class="number">89</span> - x^<span class="number">88</span> + x^<span class="number">87</span> - x^<span class="number">86</span> + x^<span class="number">85</span> + x^<span class="number">84</span> - x^<span class="number">83</span> + x^<span class="number">79</span> - <span class="number">3</span>*x^<span class="number">78</span> - <span class="number">2</span>*x^<span class="number">77</span> + x^<span class="number">74</span> + <span class="number">3</span>*x^<span class="number">73</span> - x^<span class="number">72</span> - <span class="number">3</span>*x^<span class="number">71</span> - <span class="number">2</span>*x^<span class="number">70</span> + x^<span class="number">69</span> - <span class="number">3</span>*x^<span class="number">66</span> + x^<span class="number">65</span> + x^<span class="number">64</span> - <span class="number">4</span>*x^<span class="number">62</span> - x^<span class="number">61</span> + x^<span class="number">60</span> - x^<span class="number">59</span> + <span class="number">3</span>*x^<span class="number">58</span> - x^<span class="number">57</span> - x^<span class="number">54</span> + <span class="number">3</span>*x^<span class="number">53</span> + x^<span class="number">51</span> - <span class="number">3</span>*x^<span class="number">50</span> - x^<span class="number">49</span> + <span class="number">2</span>*x^<span class="number">47</span> - x^<span class="number">46</span> - x^<span class="number">44</span> + x^<span class="number">43</span> - x^<span class="number">42</span> - <span class="number">4</span>*x^<span class="number">41</span> - <span class="number">3</span>*x^<span class="number">39</span> - x^<span class="number">37</span> - x^<span class="number">36</span> - <span class="number">3</span>*x^<span class="number">35</span> + x^<span class="number">34</span> + x^<span class="number">33</span> - <span class="number">2</span>*x^<span class="number">32</span> + <span class="number">2</span>*x^<span class="number">31</span> - x^<span class="number">30</span> + <span class="number">2</span>*x^<span class="number">29</span> - <span class="number">2</span>*x^<span class="number">28</span> - <span class="number">2</span>*x^<span class="number">27</span> - x^<span class="number">24</span> + x^<span class="number">22</span> - <span class="number">5</span>*x^<span class="number">21</span> + <span class="number">3</span>*x^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">19</span> - x^<span class="number">18</span> + <span class="number">2</span>*x^<span class="number">17</span> + x^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">15</span> - <span class="number">2</span>*x^<span class="number">14</span> + x^<span class="number">13</span> + x^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">11</span> - <span class="number">3</span>*x^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">5</span> - <span class="number">4</span>*x^<span class="number">4</span> + x^<span class="number">3</span> - x^<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">w = <span class="number">32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span></span><br><span class="line">p = gcd(w - <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">sum</span>(f.coefficients()), n), n)</span><br><span class="line">q = n // p</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(ZZ(m)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;8d1e3405044a79b23a44a43084bd994b&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="ez_fermat_bag_pro">EZ_Fermat_bag_PRO</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> f, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">88</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;NSSCTF&#123;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">P.&lt;x,y&gt; = ZZ[]</span><br><span class="line">f = P(<span class="built_in">str</span>(f))</span><br><span class="line"></span><br><span class="line">w = <span class="built_in">pow</span>(<span class="number">2</span>,f(p,q),n)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(<span class="built_in">chr</span>(i) <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">set</span>(<span class="built_in">str</span>(p)))) <span class="keyword">for</span> i <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>:])</span><br><span class="line">c = bytes_to_long(flag) % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;f = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;w = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 95656952327201449381426394713246214670537600365883923624876350719801926817916514429721785287844335184715049179879891389941974481490433975689601829920289485889138252888029716516069912637121531561601839948367426922036690701168975937162280451323099126372019216020898338909808577022618554997063496690156977790629</span></span><br><span class="line"><span class="string">f = x^31 - x^30*y - 2*x^29*y^2 + 7*x^28*y^3 + 2*x^27*y^4 - 4*x^24*y^7 + 3*x^23*y^8 - x^20*y^11 - 4*x^19*y^12 + x^18*y^13 - 5*x^17*y^14 - 4*x^16*y^15 - x^15*y^16 + x^14*y^17 + x^13*y^18 + x^12*y^19 - 2*x^11*y^20 - 3*x^9*y^22 + 5*x^7*y^24 + x^6*y^25 + 6*x^4*y^27 + x^3*y^28 + 2*x*y^30 + y^31 - 2*x^30 - 3*x^29*y + 2*x^28*y^2 + 2*x^27*y^3 - x^26*y^4 - x^25*y^5 - 2*x^24*y^6 - 3*x^23*y^7 - 3*x^22*y^8 - 3*x^20*y^10 - 4*x^19*y^11 + 2*x^18*y^12 + x^15*y^15 - x^14*y^16 - 2*x^12*y^18 - 3*x^11*y^19 - x^10*y^20 + x^9*y^21 + 2*x^8*y^22 + x^7*y^23 + x^5*y^25 - x^4*y^26 - 2*x^3*y^27 - 2*x^2*y^28 - y^30 - 2*x^29 - x^28*y + 3*x^26*y^3 - x^25*y^4 - 2*x^24*y^5 + x^23*y^6 - x^22*y^7 - x^20*y^9 + 2*x^19*y^10 + 2*x^18*y^11 + x^16*y^13 + x^15*y^14 + x^14*y^15 + x^13*y^16 + x^12*y^17 + 5*x^11*y^18 - x^9*y^20 - 2*x^8*y^21 - 5*x^7*y^22 - 2*x^6*y^23 + 3*x^5*y^24 - 5*x^3*y^26 - x^2*y^27 + 2*x*y^28 - y^29 + 3*x^28 + 3*x^27*y - 2*x^26*y^2 + x^25*y^3 + 2*x^24*y^4 - x^23*y^5 - 2*x^22*y^6 - 3*x^20*y^8 - 3*x^19*y^9 + 4*x^17*y^11 - x^16*y^12 - 3*x^15*y^13 - 2*x^14*y^14 + x^13*y^15 + 2*x^12*y^16 - 2*x^11*y^17 + x^10*y^18 - 2*x^9*y^19 + x^8*y^20 - 2*x^7*y^21 - x^6*y^22 + x^5*y^23 - x^4*y^24 + x^3*y^25 + x^2*y^26 - x*y^27 - y^28 + x^27 + x^26*y - 2*x^24*y^3 + x^23*y^4 - 3*x^22*y^5 - 2*x^21*y^6 - 2*x^20*y^7 - 5*x^19*y^8 + 2*x^18*y^9 - 5*x^17*y^10 + x^16*y^11 - 3*x^15*y^12 - 4*x^14*y^13 - x^13*y^14 + x^12*y^15 + 3*x^11*y^16 + 2*x^10*y^17 - 4*x^9*y^18 - 2*x^6*y^21 + x^5*y^22 + 4*x^3*y^24 + 2*x^2*y^25 + 2*x*y^26 - 2*y^27 + x^25*y + x^24*y^2 + x^23*y^3 + 5*x^22*y^4 + x^20*y^6 - 3*x^19*y^7 + x^18*y^8 - x^17*y^9 + 2*x^15*y^11 - x^14*y^12 + 2*x^13*y^13 - x^12*y^14 + 4*x^11*y^15 - x^10*y^16 - 2*x^6*y^20 - x^5*y^21 + 3*x^3*y^23 + x^2*y^24 - 3*x*y^25 - 3*y^26 + 3*x^25 - 2*x^23*y^2 - x^21*y^4 + x^17*y^8 + 2*x^16*y^9 - x^15*y^10 - 2*x^14*y^11 - x^13*y^12 + 2*x^12*y^13 - 2*x^11*y^14 - x^9*y^16 - x^8*y^17 - x^6*y^19 - x^5*y^20 + x^4*y^21 + x^3*y^22 + 5*x*y^24 - 2*y^25 - x^24 + 2*x^23*y + x^22*y^2 - x^21*y^3 - x^19*y^5 + x^18*y^6 - x^17*y^7 + 2*x^16*y^8 - 4*x^15*y^9 - x^14*y^10 - x^13*y^11 - x^12*y^12 + 4*x^10*y^14 + 2*x^9*y^15 - x^8*y^16 - 2*x^7*y^17 - 2*x^6*y^18 + 4*x^5*y^19 + x^4*y^20 + 2*x^2*y^22 - 5*x*y^23 - y^24 + x^23 - x^22*y + 2*x^21*y^2 - x^20*y^3 - x^18*y^5 - x^17*y^6 - 5*x^15*y^8 + x^14*y^9 - 3*x^13*y^10 + 3*x^12*y^11 + 2*x^11*y^12 - 2*x^10*y^13 - 2*x^9*y^14 - x^8*y^15 + 2*x^7*y^16 - 2*x^6*y^17 - 4*x^5*y^18 - 5*x^3*y^20 - x^2*y^21 - x*y^22 - 4*y^23 - x^22 + 2*x^21*y - 2*x^20*y^2 - 2*x^19*y^3 - 3*x^17*y^5 - x^16*y^6 - x^15*y^7 + 4*x^13*y^9 + 2*x^12*y^10 + 3*x^11*y^11 + 2*x^10*y^12 - x^9*y^13 - x^7*y^15 + 2*x^6*y^16 + x^3*y^19 + 2*x^2*y^20 + 2*x*y^21 + 3*y^22 - 3*x^21 - x^20*y - x^19*y^2 + 2*x^17*y^4 - x^16*y^5 - x^15*y^6 + x^14*y^7 - 5*x^12*y^9 - 2*x^11*y^10 + x^10*y^11 + x^6*y^15 + x^5*y^16 + x^4*y^17 - 3*x^2*y^19 - 2*x*y^20 - 2*y^21 + x^20 + 2*x^19*y - 2*x^17*y^3 + 2*x^16*y^4 - 3*x^15*y^5 + 4*x^14*y^6 + 2*x^13*y^7 - x^12*y^8 - 2*x^11*y^9 + x^10*y^10 + 6*x^9*y^11 + x^8*y^12 + x^7*y^13 + 2*x^5*y^15 + 4*x^4*y^16 + x^3*y^17 - x^2*y^18 + 3*x*y^19 - x^17*y^2 + 2*x^16*y^3 + 3*x^14*y^5 - x^13*y^6 + 2*x^11*y^8 + x^10*y^9 + 3*x^9*y^10 - x^7*y^12 - x^6*y^13 + 3*x^5*y^14 - 4*x^4*y^15 + x^2*y^17 + 2*y^19 - x^18 - x^16*y^2 - 2*x^14*y^4 - 2*x^13*y^5 - 2*x^12*y^6 + 2*x^11*y^7 + 3*x^9*y^9 + 3*x^8*y^10 + x^6*y^12 - x^4*y^14 + 2*x^3*y^15 + 2*x^2*y^16 - 2*x*y^17 - x^17 - 4*x^16*y - 2*x^15*y^2 + 2*x^14*y^3 - x^13*y^4 + x^12*y^5 - 2*x^11*y^6 - 3*x^10*y^7 - x^9*y^8 - 5*x^8*y^9 + 2*x^7*y^10 + 2*x^6*y^11 - x^5*y^12 + x^4*y^13 - 3*x^2*y^15 + x*y^16 - 3*x^16 + x^15*y - 3*x^14*y^2 - x^13*y^3 - x^12*y^4 + 2*x^11*y^5 - x^10*y^6 + 5*x^8*y^8 + 3*x^7*y^9 + 3*x^6*y^10 + 2*x^5*y^11 + 4*x^4*y^12 + 2*x^3*y^13 + x^2*y^14 - 3*x*y^15 - x^15 + 3*x^14*y + x^13*y^2 - x^12*y^3 - 3*x^11*y^4 + x^10*y^5 - x^9*y^6 + 2*x^8*y^7 - x^7*y^8 + 4*x^5*y^10 - 2*x^4*y^11 + x^3*y^12 - x^14 + x^13*y + 2*x^12*y^2 + x^11*y^3 - 5*x^10*y^4 - x^9*y^5 - 3*x^8*y^6 - 2*x^7*y^7 + x^6*y^8 + 3*x^5*y^9 + x^4*y^10 + 2*x^3*y^11 - x^2*y^12 - 4*x*y^13 + 3*y^14 + x^12*y - 2*x^11*y^2 - x^9*y^4 - x^8*y^5 + 5*x^7*y^6 - 4*x^6*y^7 + 3*x^5*y^8 + 4*x^4*y^9 - 3*x^3*y^10 - x^2*y^11 - 2*x*y^12 - 3*y^13 + 3*x^12 + x^11*y + x^10*y^2 + x^9*y^3 + x^8*y^4 - x^6*y^6 - x^5*y^7 - 4*x^3*y^9 - x^2*y^10 - 3*x*y^11 - 2*y^12 + x^10*y + 5*x^9*y^2 + x^8*y^3 + 3*x^5*y^6 + x^4*y^7 + 2*x^3*y^8 - 4*x^2*y^9 + 2*x*y^10 + 3*y^11 - x^10 - 2*x^9*y - 2*x^7*y^3 - x^6*y^4 + x^5*y^5 + 3*x^4*y^6 - 2*x^2*y^8 - x*y^9 + 4*x^9 - 3*x^8*y - 3*x^6*y^3 + x^5*y^4 - x^4*y^5 - 2*x^3*y^6 - 2*x^2*y^7 + x*y^8 + 4*y^9 + 2*x^8 - x^7*y - 2*x^5*y^3 - 4*x^4*y^4 + 3*x^3*y^5 + 4*x^2*y^6 + 2*x*y^7 - 2*y^8 + 2*x^7 + 3*x^5*y^2 + 3*x^2*y^5 - x*y^6 - 4*x^6 + 6*x^3*y^3 + 2*x^2*y^4 - 2*x*y^5 - 3*y^6 + x^5 - 3*x^4*y + x^3*y^2 + x^2*y^3 - 2*x*y^4 + 2*x^4 - 2*x^3*y + 6*x^2*y^2 - 3*x*y^3 - 2*y^4 - 5*x^3 - 2*x^2*y - 2*x*y^2 + 3*y^3 + 2*x^2 - x*y + y^2 - 2*x + 2*y - 2</span></span><br><span class="line"><span class="string">w = 12796020294902567574981427270787776254781813995526831579805652479456168245098217943847166109912113827479436654134179666391771173421469188197935460525521295192736123648410762964187396897298542198935971755852754544978564521188423737649175136194386664628304164316905741781089536713701674793641345344818309314224</span></span><br><span class="line"><span class="string">c = 10266913434526071998707605266130137733134248608585146234981245806763995653822203763396430876254213500327272952979577138542487120755771047170064775346450942</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜éš¾ç‚¹åœ¨äº<span class="math inline">\(f\)</span>æ˜¯ä¸€ä¸ªäºŒå…ƒå¤šé¡¹å¼ï¼Œå¦‚æœè¿˜ç›´æ¥é‡‡å–æ¨¡pçš„æ–¹æ³•çš„è¯ï¼ŒæŒ‡æ•°ä¸Šä¼šå‰©ä½™qï¼Œè¿™é¢˜çš„åšæ³•æ˜¯ç”¨<span class="math inline">\(f(x, y)\)</span>å¯¹<span class="math inline">\((n -
x - y + 1)\)</span>åšå¸¦ä½™é™¤æ³•ï¼š <span class="math display">\[
f(x, y) = k(x, y)(n - x - y + 1) + r(y)
\]</span> ç”±äºé™¤å¼æ˜¯ä¸ªä¸€æ¬¡é¡¹ï¼Œæ‰€ä»¥ä½™å¼<span class="math inline">\(r(y)\)</span>åªå«å˜é‡<span class="math inline">\(y\)</span>ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°: <span class="math display">\[
w \equiv 2^{f(p, q)} \equiv 2^{k(p, q)(n - p - q + 1) + r(q)} \equiv
2^{k(p, q)\phi(n) + r(q)} \equiv 2^{r(q)} \mod n
\]</span></p>
<p>ç„¶åé‡‡å–å’Œ<strong>EZ_Fermat</strong>ä¸€æ ·çš„åšæ³•å°±è¡Œã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">P.&lt;x,y&gt; = ZZ[]</span><br><span class="line">PR.&lt;z&gt; = ZZ[]</span><br><span class="line">f = x^<span class="number">31</span> - x^<span class="number">30</span>*y - <span class="number">2</span>*x^<span class="number">29</span>*y^<span class="number">2</span> + <span class="number">7</span>*x^<span class="number">28</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">27</span>*y^<span class="number">4</span> - <span class="number">4</span>*x^<span class="number">24</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">23</span>*y^<span class="number">8</span> - x^<span class="number">20</span>*y^<span class="number">11</span> - <span class="number">4</span>*x^<span class="number">19</span>*y^<span class="number">12</span> + x^<span class="number">18</span>*y^<span class="number">13</span> - <span class="number">5</span>*x^<span class="number">17</span>*y^<span class="number">14</span> - <span class="number">4</span>*x^<span class="number">16</span>*y^<span class="number">15</span> - x^<span class="number">15</span>*y^<span class="number">16</span> + x^<span class="number">14</span>*y^<span class="number">17</span> + x^<span class="number">13</span>*y^<span class="number">18</span> + x^<span class="number">12</span>*y^<span class="number">19</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">20</span> - <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">22</span> + <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">24</span> + x^<span class="number">6</span>*y^<span class="number">25</span> + <span class="number">6</span>*x^<span class="number">4</span>*y^<span class="number">27</span> + x^<span class="number">3</span>*y^<span class="number">28</span> + <span class="number">2</span>*x*y^<span class="number">30</span> + y^<span class="number">31</span> - <span class="number">2</span>*x^<span class="number">30</span> - <span class="number">3</span>*x^<span class="number">29</span>*y + <span class="number">2</span>*x^<span class="number">28</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">27</span>*y^<span class="number">3</span> - x^<span class="number">26</span>*y^<span class="number">4</span> - x^<span class="number">25</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">23</span>*y^<span class="number">7</span> - <span class="number">3</span>*x^<span class="number">22</span>*y^<span class="number">8</span> - <span class="number">3</span>*x^<span class="number">20</span>*y^<span class="number">10</span> - <span class="number">4</span>*x^<span class="number">19</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">12</span> + x^<span class="number">15</span>*y^<span class="number">15</span> - x^<span class="number">14</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">18</span> - <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">19</span> - x^<span class="number">10</span>*y^<span class="number">20</span> + x^<span class="number">9</span>*y^<span class="number">21</span> + <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">22</span> + x^<span class="number">7</span>*y^<span class="number">23</span> + x^<span class="number">5</span>*y^<span class="number">25</span> - x^<span class="number">4</span>*y^<span class="number">26</span> - <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">27</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">28</span> - y^<span class="number">30</span> - <span class="number">2</span>*x^<span class="number">29</span> - x^<span class="number">28</span>*y + <span class="number">3</span>*x^<span class="number">26</span>*y^<span class="number">3</span> - x^<span class="number">25</span>*y^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">5</span> + x^<span class="number">23</span>*y^<span class="number">6</span> - x^<span class="number">22</span>*y^<span class="number">7</span> - x^<span class="number">20</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">19</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">11</span> + x^<span class="number">16</span>*y^<span class="number">13</span> + x^<span class="number">15</span>*y^<span class="number">14</span> + x^<span class="number">14</span>*y^<span class="number">15</span> + x^<span class="number">13</span>*y^<span class="number">16</span> + x^<span class="number">12</span>*y^<span class="number">17</span> + <span class="number">5</span>*x^<span class="number">11</span>*y^<span class="number">18</span> - x^<span class="number">9</span>*y^<span class="number">20</span> - <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">21</span> - <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">22</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">23</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">24</span> - <span class="number">5</span>*x^<span class="number">3</span>*y^<span class="number">26</span> - x^<span class="number">2</span>*y^<span class="number">27</span> + <span class="number">2</span>*x*y^<span class="number">28</span> - y^<span class="number">29</span> + <span class="number">3</span>*x^<span class="number">28</span> + <span class="number">3</span>*x^<span class="number">27</span>*y - <span class="number">2</span>*x^<span class="number">26</span>*y^<span class="number">2</span> + x^<span class="number">25</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">4</span> - x^<span class="number">23</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">22</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">20</span>*y^<span class="number">8</span> - <span class="number">3</span>*x^<span class="number">19</span>*y^<span class="number">9</span> + <span class="number">4</span>*x^<span class="number">17</span>*y^<span class="number">11</span> - x^<span class="number">16</span>*y^<span class="number">12</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">14</span> + x^<span class="number">13</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">17</span> + x^<span class="number">10</span>*y^<span class="number">18</span> - <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">19</span> + x^<span class="number">8</span>*y^<span class="number">20</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">21</span> - x^<span class="number">6</span>*y^<span class="number">22</span> + x^<span class="number">5</span>*y^<span class="number">23</span> - x^<span class="number">4</span>*y^<span class="number">24</span> + x^<span class="number">3</span>*y^<span class="number">25</span> + x^<span class="number">2</span>*y^<span class="number">26</span> - x*y^<span class="number">27</span> - y^<span class="number">28</span> + x^<span class="number">27</span> + x^<span class="number">26</span>*y - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">3</span> + x^<span class="number">23</span>*y^<span class="number">4</span> - <span class="number">3</span>*x^<span class="number">22</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">21</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">20</span>*y^<span class="number">7</span> - <span class="number">5</span>*x^<span class="number">19</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">9</span> - <span class="number">5</span>*x^<span class="number">17</span>*y^<span class="number">10</span> + x^<span class="number">16</span>*y^<span class="number">11</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">12</span> - <span class="number">4</span>*x^<span class="number">14</span>*y^<span class="number">13</span> - x^<span class="number">13</span>*y^<span class="number">14</span> + x^<span class="number">12</span>*y^<span class="number">15</span> + <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">16</span> + <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">9</span>*y^<span class="number">18</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">21</span> + x^<span class="number">5</span>*y^<span class="number">22</span> + <span class="number">4</span>*x^<span class="number">3</span>*y^<span class="number">24</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">25</span> + <span class="number">2</span>*x*y^<span class="number">26</span> - <span class="number">2</span>*y^<span class="number">27</span> + x^<span class="number">25</span>*y + x^<span class="number">24</span>*y^<span class="number">2</span> + x^<span class="number">23</span>*y^<span class="number">3</span> + <span class="number">5</span>*x^<span class="number">22</span>*y^<span class="number">4</span> + x^<span class="number">20</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">19</span>*y^<span class="number">7</span> + x^<span class="number">18</span>*y^<span class="number">8</span> - x^<span class="number">17</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">15</span>*y^<span class="number">11</span> - x^<span class="number">14</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">13</span> - x^<span class="number">12</span>*y^<span class="number">14</span> + <span class="number">4</span>*x^<span class="number">11</span>*y^<span class="number">15</span> - x^<span class="number">10</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">20</span> - x^<span class="number">5</span>*y^<span class="number">21</span> + <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">23</span> + x^<span class="number">2</span>*y^<span class="number">24</span> - <span class="number">3</span>*x*y^<span class="number">25</span> - <span class="number">3</span>*y^<span class="number">26</span> + <span class="number">3</span>*x^<span class="number">25</span> - <span class="number">2</span>*x^<span class="number">23</span>*y^<span class="number">2</span> - x^<span class="number">21</span>*y^<span class="number">4</span> + x^<span class="number">17</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">9</span> - x^<span class="number">15</span>*y^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">11</span> - x^<span class="number">13</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">14</span> - x^<span class="number">9</span>*y^<span class="number">16</span> - x^<span class="number">8</span>*y^<span class="number">17</span> - x^<span class="number">6</span>*y^<span class="number">19</span> - x^<span class="number">5</span>*y^<span class="number">20</span> + x^<span class="number">4</span>*y^<span class="number">21</span> + x^<span class="number">3</span>*y^<span class="number">22</span> + <span class="number">5</span>*x*y^<span class="number">24</span> - <span class="number">2</span>*y^<span class="number">25</span> - x^<span class="number">24</span> + <span class="number">2</span>*x^<span class="number">23</span>*y + x^<span class="number">22</span>*y^<span class="number">2</span> - x^<span class="number">21</span>*y^<span class="number">3</span> - x^<span class="number">19</span>*y^<span class="number">5</span> + x^<span class="number">18</span>*y^<span class="number">6</span> - x^<span class="number">17</span>*y^<span class="number">7</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">15</span>*y^<span class="number">9</span> - x^<span class="number">14</span>*y^<span class="number">10</span> - x^<span class="number">13</span>*y^<span class="number">11</span> - x^<span class="number">12</span>*y^<span class="number">12</span> + <span class="number">4</span>*x^<span class="number">10</span>*y^<span class="number">14</span> + <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">15</span> - x^<span class="number">8</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">17</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">18</span> + <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">19</span> + x^<span class="number">4</span>*y^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">22</span> - <span class="number">5</span>*x*y^<span class="number">23</span> - y^<span class="number">24</span> + x^<span class="number">23</span> - x^<span class="number">22</span>*y + <span class="number">2</span>*x^<span class="number">21</span>*y^<span class="number">2</span> - x^<span class="number">20</span>*y^<span class="number">3</span> - x^<span class="number">18</span>*y^<span class="number">5</span> - x^<span class="number">17</span>*y^<span class="number">6</span> - <span class="number">5</span>*x^<span class="number">15</span>*y^<span class="number">8</span> + x^<span class="number">14</span>*y^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">13</span>*y^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">12</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">12</span> - <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">14</span> - x^<span class="number">8</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">18</span> - <span class="number">5</span>*x^<span class="number">3</span>*y^<span class="number">20</span> - x^<span class="number">2</span>*y^<span class="number">21</span> - x*y^<span class="number">22</span> - <span class="number">4</span>*y^<span class="number">23</span> - x^<span class="number">22</span> + <span class="number">2</span>*x^<span class="number">21</span>*y - <span class="number">2</span>*x^<span class="number">20</span>*y^<span class="number">2</span> - <span class="number">2</span>*x^<span class="number">19</span>*y^<span class="number">3</span> - <span class="number">3</span>*x^<span class="number">17</span>*y^<span class="number">5</span> - x^<span class="number">16</span>*y^<span class="number">6</span> - x^<span class="number">15</span>*y^<span class="number">7</span> + <span class="number">4</span>*x^<span class="number">13</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">12</span> - x^<span class="number">9</span>*y^<span class="number">13</span> - x^<span class="number">7</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">16</span> + x^<span class="number">3</span>*y^<span class="number">19</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">20</span> + <span class="number">2</span>*x*y^<span class="number">21</span> + <span class="number">3</span>*y^<span class="number">22</span> - <span class="number">3</span>*x^<span class="number">21</span> - x^<span class="number">20</span>*y - x^<span class="number">19</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">17</span>*y^<span class="number">4</span> - x^<span class="number">16</span>*y^<span class="number">5</span> - x^<span class="number">15</span>*y^<span class="number">6</span> + x^<span class="number">14</span>*y^<span class="number">7</span> - <span class="number">5</span>*x^<span class="number">12</span>*y^<span class="number">9</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">10</span> + x^<span class="number">10</span>*y^<span class="number">11</span> + x^<span class="number">6</span>*y^<span class="number">15</span> + x^<span class="number">5</span>*y^<span class="number">16</span> + x^<span class="number">4</span>*y^<span class="number">17</span> - <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">19</span> - <span class="number">2</span>*x*y^<span class="number">20</span> - <span class="number">2</span>*y^<span class="number">21</span> + x^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">19</span>*y - <span class="number">2</span>*x^<span class="number">17</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">4</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">5</span> + <span class="number">4</span>*x^<span class="number">14</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">7</span> - x^<span class="number">12</span>*y^<span class="number">8</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">9</span> + x^<span class="number">10</span>*y^<span class="number">10</span> + <span class="number">6</span>*x^<span class="number">9</span>*y^<span class="number">11</span> + x^<span class="number">8</span>*y^<span class="number">12</span> + x^<span class="number">7</span>*y^<span class="number">13</span> + <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">15</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">16</span> + x^<span class="number">3</span>*y^<span class="number">17</span> - x^<span class="number">2</span>*y^<span class="number">18</span> + <span class="number">3</span>*x*y^<span class="number">19</span> - x^<span class="number">17</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">3</span> + <span class="number">3</span>*x^<span class="number">14</span>*y^<span class="number">5</span> - x^<span class="number">13</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">8</span> + x^<span class="number">10</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">10</span> - x^<span class="number">7</span>*y^<span class="number">12</span> - x^<span class="number">6</span>*y^<span class="number">13</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">14</span> - <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">15</span> + x^<span class="number">2</span>*y^<span class="number">17</span> + <span class="number">2</span>*y^<span class="number">19</span> - x^<span class="number">18</span> - x^<span class="number">16</span>*y^<span class="number">2</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">8</span>*y^<span class="number">10</span> + x^<span class="number">6</span>*y^<span class="number">12</span> - x^<span class="number">4</span>*y^<span class="number">14</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">16</span> - <span class="number">2</span>*x*y^<span class="number">17</span> - x^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">16</span>*y - <span class="number">2</span>*x^<span class="number">15</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">3</span> - x^<span class="number">13</span>*y^<span class="number">4</span> + x^<span class="number">12</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">10</span>*y^<span class="number">7</span> - x^<span class="number">9</span>*y^<span class="number">8</span> - <span class="number">5</span>*x^<span class="number">8</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">11</span> - x^<span class="number">5</span>*y^<span class="number">12</span> + x^<span class="number">4</span>*y^<span class="number">13</span> - <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">15</span> + x*y^<span class="number">16</span> - <span class="number">3</span>*x^<span class="number">16</span> + x^<span class="number">15</span>*y - <span class="number">3</span>*x^<span class="number">14</span>*y^<span class="number">2</span> - x^<span class="number">13</span>*y^<span class="number">3</span> - x^<span class="number">12</span>*y^<span class="number">4</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">5</span> - x^<span class="number">10</span>*y^<span class="number">6</span> + <span class="number">5</span>*x^<span class="number">8</span>*y^<span class="number">8</span> + <span class="number">3</span>*x^<span class="number">7</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">6</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">11</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">13</span> + x^<span class="number">2</span>*y^<span class="number">14</span> - <span class="number">3</span>*x*y^<span class="number">15</span> - x^<span class="number">15</span> + <span class="number">3</span>*x^<span class="number">14</span>*y + x^<span class="number">13</span>*y^<span class="number">2</span> - x^<span class="number">12</span>*y^<span class="number">3</span> - <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">4</span> + x^<span class="number">10</span>*y^<span class="number">5</span> - x^<span class="number">9</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">7</span> - x^<span class="number">7</span>*y^<span class="number">8</span> + <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">4</span>*y^<span class="number">11</span> + x^<span class="number">3</span>*y^<span class="number">12</span> - x^<span class="number">14</span> + x^<span class="number">13</span>*y + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">2</span> + x^<span class="number">11</span>*y^<span class="number">3</span> - <span class="number">5</span>*x^<span class="number">10</span>*y^<span class="number">4</span> - x^<span class="number">9</span>*y^<span class="number">5</span> - <span class="number">3</span>*x^<span class="number">8</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">7</span> + x^<span class="number">6</span>*y^<span class="number">8</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">9</span> + x^<span class="number">4</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">11</span> - x^<span class="number">2</span>*y^<span class="number">12</span> - <span class="number">4</span>*x*y^<span class="number">13</span> + <span class="number">3</span>*y^<span class="number">14</span> + x^<span class="number">12</span>*y - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">2</span> - x^<span class="number">9</span>*y^<span class="number">4</span> - x^<span class="number">8</span>*y^<span class="number">5</span> + <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">6</span> - <span class="number">4</span>*x^<span class="number">6</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">8</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">10</span> - x^<span class="number">2</span>*y^<span class="number">11</span> - <span class="number">2</span>*x*y^<span class="number">12</span> - <span class="number">3</span>*y^<span class="number">13</span> + <span class="number">3</span>*x^<span class="number">12</span> + x^<span class="number">11</span>*y + x^<span class="number">10</span>*y^<span class="number">2</span> + x^<span class="number">9</span>*y^<span class="number">3</span> + x^<span class="number">8</span>*y^<span class="number">4</span> - x^<span class="number">6</span>*y^<span class="number">6</span> - x^<span class="number">5</span>*y^<span class="number">7</span> - <span class="number">4</span>*x^<span class="number">3</span>*y^<span class="number">9</span> - x^<span class="number">2</span>*y^<span class="number">10</span> - <span class="number">3</span>*x*y^<span class="number">11</span> - <span class="number">2</span>*y^<span class="number">12</span> + x^<span class="number">10</span>*y + <span class="number">5</span>*x^<span class="number">9</span>*y^<span class="number">2</span> + x^<span class="number">8</span>*y^<span class="number">3</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">6</span> + x^<span class="number">4</span>*y^<span class="number">7</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">2</span>*y^<span class="number">9</span> + <span class="number">2</span>*x*y^<span class="number">10</span> + <span class="number">3</span>*y^<span class="number">11</span> - x^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">9</span>*y - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">3</span> - x^<span class="number">6</span>*y^<span class="number">4</span> + x^<span class="number">5</span>*y^<span class="number">5</span> + <span class="number">3</span>*x^<span class="number">4</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">8</span> - x*y^<span class="number">9</span> + <span class="number">4</span>*x^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">8</span>*y - <span class="number">3</span>*x^<span class="number">6</span>*y^<span class="number">3</span> + x^<span class="number">5</span>*y^<span class="number">4</span> - x^<span class="number">4</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">7</span> + x*y^<span class="number">8</span> + <span class="number">4</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">8</span> - x^<span class="number">7</span>*y - <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">3</span> - <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">4</span> + <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">5</span> + <span class="number">4</span>*x^<span class="number">2</span>*y^<span class="number">6</span> + <span class="number">2</span>*x*y^<span class="number">7</span> - <span class="number">2</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">2</span> + <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">5</span> - x*y^<span class="number">6</span> - <span class="number">4</span>*x^<span class="number">6</span> + <span class="number">6</span>*x^<span class="number">3</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">4</span> - <span class="number">2</span>*x*y^<span class="number">5</span> - <span class="number">3</span>*y^<span class="number">6</span> + x^<span class="number">5</span> - <span class="number">3</span>*x^<span class="number">4</span>*y + x^<span class="number">3</span>*y^<span class="number">2</span> + x^<span class="number">2</span>*y^<span class="number">3</span> - <span class="number">2</span>*x*y^<span class="number">4</span> + <span class="number">2</span>*x^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">3</span>*y + <span class="number">6</span>*x^<span class="number">2</span>*y^<span class="number">2</span> - <span class="number">3</span>*x*y^<span class="number">3</span> - <span class="number">2</span>*y^<span class="number">4</span> - <span class="number">5</span>*x^<span class="number">3</span> - <span class="number">2</span>*x^<span class="number">2</span>*y - <span class="number">2</span>*x*y^<span class="number">2</span> + <span class="number">3</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">2</span> - x*y + y^<span class="number">2</span> - <span class="number">2</span>*x + <span class="number">2</span>*y - <span class="number">2</span></span><br><span class="line">n = <span class="number">95656952327201449381426394713246214670537600365883923624876350719801926817916514429721785287844335184715049179879891389941974481490433975689601829920289485889138252888029716516069912637121531561601839948367426922036690701168975937162280451323099126372019216020898338909808577022618554997063496690156977790629</span></span><br><span class="line">w = <span class="number">12796020294902567574981427270787776254781813995526831579805652479456168245098217943847166109912113827479436654134179666391771173421469188197935460525521295192736123648410762964187396897298542198935971755852754544978564521188423737649175136194386664628304164316905741781089536713701674793641345344818309314224</span></span><br><span class="line">c = <span class="number">10266913434526071998707605266130137733134248608585146234981245806763995653822203763396430876254213500327272952979577138542487120755771047170064775346450942</span></span><br><span class="line">g = f % (n - x - y + <span class="number">1</span>)</span><br><span class="line">g = g(<span class="number">0</span>, z)</span><br><span class="line">q = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, g(<span class="number">1</span>), n) - w, n)</span><br><span class="line">p = n // q</span><br><span class="line"></span><br><span class="line">diff = <span class="string">b&quot;NSSCTF&#123;&quot;</span> + <span class="string">b&quot;0&quot;</span>*<span class="number">80</span> + <span class="string">b&quot;&#125;&quot;</span></span><br><span class="line">diff = bytes_to_long(diff)</span><br><span class="line">M = column_matrix([<span class="number">2</span>**(<span class="number">8</span>*(<span class="number">80</span> - i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">80</span>)] + [diff-c] + [p])</span><br><span class="line">M = M.augment(identity_matrix(<span class="number">81</span>).stack(zero_vector(<span class="number">81</span>)))</span><br><span class="line">MLLL = M.LLL()</span><br><span class="line">v = MLLL[<span class="number">0</span>]</span><br><span class="line">v = v[-<span class="number">1</span>]*v</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;NSSCTF&#123;&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v[<span class="number">1</span>:-<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(i), end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># NSSCTF&#123;38886172735077060750460332815973614272222523052135584902884007925985948919714862&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="baby_factor_revenge">baby_factor_revenge</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>():</span><br><span class="line">    pl  = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        pl.append(getPrime(<span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(pl)</span><br><span class="line">pl = create()</span><br><span class="line">m=<span class="string">b&#x27;NSSCTF&#123;xxxxxx&#125;&#x27;</span></span><br><span class="line">p,q,r = pl[<span class="number">0</span>],pl[<span class="number">1</span>],pl[<span class="number">2</span>]</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">phi_2=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n2=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(m),e,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n=<span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;phi=<span class="subst">&#123;phi&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n=3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984460699747964946764645986828307675081596907634022110868102739948513844625534865764252668312850364286204872187001344218083941399088833989233474318289529103178632284291007694811574023047207470113594082533713524606268388742119103653587354956091145288566437795469230667897089543048576812362251576281067933183713438502813206542834734983616378764909202774603304124497453696792428111112644362307853143219890039129054302905340695668256116233515323529918746264727874817221051242387145263342018617858562987223211598238069486447049955021864781104312134816578626968386395835285074116149472750100154961405785440009296096563521430833</span></span><br><span class="line"><span class="string">phi=3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984394758254181484105857103844940487787404078873566779953101987404891507588290232992132681729619718279684673827347612899406697514777723904351697638562060304399923174376216080338949397741477013367831377040866937433520175862575061413321076151761545984886547872427147498175814451096795344136954743868643889768901204954902708679102384061694877757565486240670882343628571424084461972849147495569088820011108794930593172573959423278140327579049114196086428504291102619820322231225943837444001821535593671764186251713714593498207219093585758479440828038119079608764008747539277397742897542501803218788455452391287578171880267200</span></span><br><span class="line"><span class="string">c=8847973599594272436100870059187158819529199340583461915617467299706215012295598155778224026186157290320191983062022702191439286020733625396165573681688842631368993650799220713225485752608650482408353598320160571916055498330875851476520668973214124194890108144336715482373743731578734960096351460142579903010557821654345995923836938260379746304222820835040419844947019844885128550552066290798665884099701340641403329066058638137944934073185448687990744852400616823426082588916251127609191094346267837812018236673478691437630461425526779014305216914035039981685211625653600564431704400207095883904994772993227506462664</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜ä¸<strong>baby_factor</strong>çš„åŒºåˆ«æ˜¯éœ€è¦æˆ‘ä»¬å¿…é¡»åˆ†è§£<span class="math inline">\(n\)</span>ï¼Œé¢˜ç›®ç»™äº†<span class="math inline">\(n,
phi\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸¤ä¸ªå…³äº<span class="math inline">\(p,q,r\)</span>çš„ä¸¤ä¸ªç­‰å¼ï¼Œç”±äºå˜é‡å¤šäº†ä¸€ä¸ªï¼Œæ‰€ä»¥æ²¡åŠæ³•åˆ©ç”¨è§£æ–¹ç¨‹æ¥åˆ†è§£<span class="math inline">\(n\)</span>ã€‚è¿™é‡Œç”¨åˆ°çš„åˆ†è§£æŠ€å·§å¯ä»¥çœ‹æˆ‘å†™çš„è¿™ç¯‡æ–‡ç« :
<a href="https://blog.csdn.net/AxuAxuA123/article/details/141454579">[å¤šç´ æ•°RSA]åˆ©ç”¨phi(n)åˆ†è§£n</a></p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984460699747964946764645986828307675081596907634022110868102739948513844625534865764252668312850364286204872187001344218083941399088833989233474318289529103178632284291007694811574023047207470113594082533713524606268388742119103653587354956091145288566437795469230667897089543048576812362251576281067933183713438502813206542834734983616378764909202774603304124497453696792428111112644362307853143219890039129054302905340695668256116233515323529918746264727874817221051242387145263342018617858562987223211598238069486447049955021864781104312134816578626968386395835285074116149472750100154961405785440009296096563521430833</span></span><br><span class="line">phi=<span class="number">3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984394758254181484105857103844940487787404078873566779953101987404891507588290232992132681729619718279684673827347612899406697514777723904351697638562060304399923174376216080338949397741477013367831377040866937433520175862575061413321076151761545984886547872427147498175814451096795344136954743868643889768901204954902708679102384061694877757565486240670882343628571424084461972849147495569088820011108794930593172573959423278140327579049114196086428504291102619820322231225943837444001821535593671764186251713714593498207219093585758479440828038119079608764008747539277397742897542501803218788455452391287578171880267200</span></span><br><span class="line">c=<span class="number">8847973599594272436100870059187158819529199340583461915617467299706215012295598155778224026186157290320191983062022702191439286020733625396165573681688842631368993650799220713225485752608650482408353598320160571916055498330875851476520668973214124194890108144336715482373743731578734960096351460142579903010557821654345995923836938260379746304222820835040419844947019844885128550552066290798665884099701340641403329066058638137944934073185448687990744852400616823426082588916251127609191094346267837812018236673478691437630461425526779014305216914035039981685211625653600564431704400207095883904994772993227506462664</span></span><br><span class="line">t = <span class="number">0</span></span><br><span class="line">s = phi</span><br><span class="line"><span class="keyword">while</span> (s % <span class="number">2</span> == <span class="number">0</span>):</span><br><span class="line">    s //= <span class="number">2</span></span><br><span class="line">    t += <span class="number">1</span></span><br><span class="line">factor = <span class="built_in">set</span>()</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">10</span>):</span><br><span class="line">    p = GCD(<span class="built_in">pow</span>(a, s, n) - <span class="number">1</span>, n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n:</span><br><span class="line">            factor.add(p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">        p = GCD(<span class="built_in">pow</span>(a, <span class="number">2</span>**t*s, n) + <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; p &lt; n:</span><br><span class="line">            factor.add(p)</span><br><span class="line">factor = <span class="built_in">list</span>(factor)</span><br><span class="line"></span><br><span class="line">pqr = []</span><br><span class="line">pqr.append(GCD(factor[<span class="number">0</span>], factor[<span class="number">1</span>]))</span><br><span class="line">pqr.append(factor[<span class="number">0</span>]//pqr[<span class="number">0</span>])</span><br><span class="line">pqr.append(factor[<span class="number">1</span>]//pqr[<span class="number">0</span>])</span><br><span class="line">pqr = <span class="built_in">sorted</span>(pqr)</span><br><span class="line"></span><br><span class="line">p, q, r = pqr</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, p*q)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># NSSCTF&#123;D0_Y0u_knnn0www_p71!!!&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="mimt_rsa">MIMT_RSA</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> KEYï¼Œ flag  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">int</span>(KEY).bit_length() == <span class="number">36</span></span><br><span class="line"><span class="keyword">assert</span> <span class="keyword">not</span> isPrime(KEY)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">ck = <span class="built_in">pow</span>(KEY, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(KEY).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ck = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 26563847822899403123579768059987758748518109506340688366937229057385768563897579939399589878779201509595131302887212371556759550226965583832707699167542469352676806103999861576255689028708092007726895892953065618536676788020023461249303717579266840903337614272894749021562443472322941868357046500507962652585875038973455411548683247853955371839865042918531636085668780924020410159272977805762814306445393524647460775620243065858710021030314398928537847762167177417552351157872682037902372485985979513934517709478252552309280270916202653365726591219198063597536812483568301622917160509027075508471349507817295226801011</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">ck = 8371316287078036479056771367631991220353236851470185127168826270131149168993253524332451231708758763231051593801540258044681874144589595532078353953294719353350061853623495168005196486200144643168051115479293775329183635187974365652867387949378467702492757863040766745765841802577850659614528558282832995416523310220159445712674390202765601817050315773584214422244200409445854102170875265289152628311393710624256106528871400593480435083264403949059237446948467480548680533474642869718029551240453665446328781616706968352290100705279838871524562305806920722372815812982124238074246044446213460443693473663239594932076</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜é¢˜ç›®å·²ç»å‘Šè¯‰äº†æˆ‘ä»¬æ˜¯MIMTæ”»å‡»ï¼Œè¿™é‡Œè¯´ä¸€ä¸‹å®ƒçš„åŸç†ï¼Œå¯¹äºæœ¬é¢˜è€Œè¨€ï¼Œæ¼æ´ç‚¹åœ¨äº<span class="math inline">\(\text{KEY}\)</span>ä¸æ˜¯ç´ æ•°ï¼Œæ‰€ä»¥<span class="math inline">\(\text{KEY} =
k_1k_2\)</span>ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹<span class="math inline">\(k_1,k_2\)</span>æ˜¯æ¯”è¾ƒæ¥è¿‘çš„ï¼Œä¹Ÿå°±æ˜¯<span class="math inline">\(k_1 \approx k_2 \approx \sqrt{\text{KEY}}\)</span>
æˆ‘ä»¬å·²çŸ¥: <span class="math display">\[
ck \equiv \text{KEY}^e \equiv k_1^ek_2^e \mod n
\]</span> ç¨åŠ å˜å½¢å¾—: <span class="math display">\[
ck \cdot k_1^{-e} \equiv k_2^e \mod n
\]</span></p>
<p>è¿™é‡Œ<span class="math inline">\(\text{KEY}\)</span>æ˜¯36bitsï¼Œæ‰€ä»¥<span class="math inline">\(k_1,k_2\)</span>å¤§æ¦‚18bitsï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæšä¸¾<span class="math inline">\(k_1\)</span>ï¼Œæ±‚å‡º<span class="math inline">\(ck
\cdot k_1^{-e}\)</span>çš„æ‰€æœ‰å¯èƒ½å€¼æ”¾åˆ°é›†åˆä¸­<span class="math inline">\(S\)</span>ä¸­ï¼Œç„¶åæšä¸¾<span class="math inline">\(k_2\)</span>ï¼Œçœ‹çœ‹<span class="math inline">\(k_2^e\)</span>æ˜¯å¦å­˜åœ¨äº<span class="math inline">\(S\)</span>ä¸­ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±è¯´æ˜æˆ‘ä»¬æ‰¾åˆ°äº†<span class="math inline">\(k_1,k_2\)</span>ã€‚å¯ä»¥å‘ç°ï¼Œç”±äºæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦æ˜¯<span class="math inline">\(O(lg(k_2))\)</span>ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯<span class="math inline">\(O(\sqrt{k_1}\text{log}(k_2))\)</span>ï¼Œç›¸æ¯”ç›´æ¥æšä¸¾<span class="math inline">\(\text{KEY}\)</span>çš„æ—¶é—´å¤æ‚åº¦<span class="math inline">\(O(k_1k_2)\)</span>è¦å¿«ä¸å°‘ã€‚æœ€åå®æµ‹ä¸‹æ¥å…¶ä¸­ä¸€ä¸ªå› å­çš„å¤§å°æ˜¯17bitsã€‚
exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">n = <span class="number">26563847822899403123579768059987758748518109506340688366937229057385768563897579939399589878779201509595131302887212371556759550226965583832707699167542469352676806103999861576255689028708092007726895892953065618536676788020023461249303717579266840903337614272894749021562443472322941868357046500507962652585875038973455411548683247853955371839865042918531636085668780924020410159272977805762814306445393524647460775620243065858710021030314398928537847762167177417552351157872682037902372485985979513934517709478252552309280270916202653365726591219198063597536812483568301622917160509027075508471349507817295226801011</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ck = <span class="number">8371316287078036479056771367631991220353236851470185127168826270131149168993253524332451231708758763231051593801540258044681874144589595532078353953294719353350061853623495168005196486200144643168051115479293775329183635187974365652867387949378467702492757863040766745765841802577850659614528558282832995416523310220159445712674390202765601817050315773584214422244200409445854102170875265289152628311393710624256106528871400593480435083264403949059237446948467480548680533474642869718029551240453665446328781616706968352290100705279838871524562305806920722372815812982124238074246044446213460443693473663239594932076</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_KEY</span>():</span><br><span class="line">    l = []</span><br><span class="line">    begin, end = <span class="number">2</span>**<span class="number">16</span>, <span class="number">2</span>**<span class="number">17</span></span><br><span class="line">    <span class="keyword">for</span> k2 <span class="keyword">in</span> trange(begin, end):</span><br><span class="line">        l.append(ck*<span class="built_in">pow</span>(k2, -e, n) % n)</span><br><span class="line"></span><br><span class="line">    begin, end = <span class="number">2</span>**<span class="number">36</span> // end, <span class="number">2</span>**<span class="number">36</span> // begin</span><br><span class="line">    <span class="keyword">for</span> k1 <span class="keyword">in</span> trange(begin, end):</span><br><span class="line">        tmp = <span class="built_in">pow</span>(k1, e, n)</span><br><span class="line">        <span class="keyword">if</span> tmp <span class="keyword">in</span> l:</span><br><span class="line">            k1, k2 = k1, l.index(tmp)</span><br><span class="line">            <span class="keyword">return</span> k1, k2</span><br><span class="line"></span><br><span class="line">k1, k2 = get_KEY()</span><br><span class="line">KEY = k1 * (k2 + <span class="number">2</span>**<span class="number">16</span>)</span><br><span class="line"><span class="keyword">assert</span> ck == <span class="built_in">pow</span>(KEY, e, n)</span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(KEY).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># NSSCTF&#123;14369380f677abec84ed8b6d0e3a0ba9&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h3 id="baby_lattice">baby_lattice</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">miku = <span class="number">30</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">key = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">while</span> key&gt; p:</span><br><span class="line">    key= getPrime(<span class="number">512</span>)</span><br><span class="line">ts = []</span><br><span class="line">gs = []</span><br><span class="line">zs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(miku):</span><br><span class="line">    t = getPrime(<span class="number">512</span>)</span><br><span class="line">    z = getPrime(<span class="number">400</span>)</span><br><span class="line">    g= (t * key + z) % p</span><br><span class="line">    ts.append(t)</span><br><span class="line">    gs.append(g)</span><br><span class="line">    zs.append(z)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ts = <span class="subst">&#123;ts&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;gs = <span class="subst">&#123;gs&#125;</span>&#x27;</span>)</span><br><span class="line">iv= os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(<span class="built_in">str</span>(key).encode()[:<span class="number">16</span>], AES.MODE_CBC,iv)</span><br><span class="line">ciphertext=cipher.encrypt(pad(flag.encode(),<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;iv=<span class="subst">&#123;iv&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ciphertext=<span class="subst">&#123;ciphertext&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure></p>
<p>é¢˜ç›®ç»™äº†30ç»„å¦‚ä¸‹çš„ç­‰å¼: <span class="math display">\[
g_i \equiv t_i * key + z \mod p
\]</span> å³: <span class="math display">\[
g_i = t_i * key + z - k_ip
\]</span></p>
<p>æ³¨æ„åˆ°<span class="math inline">\(z\)</span>æ˜¯æ¯”è¾ƒå°çš„ï¼Œå¯ä»¥æ„é€ å¦‚ä¸‹çš„æ ¼ï¼š <span class="math display">\[
\begin{pmatrix}
g_1 &amp; g_2 &amp; \cdots &amp; g_{30} &amp; 1 &amp; \\
t_1 &amp; t_2 &amp; \cdots &amp; t_{30} &amp;   &amp; 1\\
p \\
&amp;p\\
&amp;&amp;\ddots\\
&amp;&amp;&amp;p
\end{pmatrix}
\]</span> è¿™ä¸ªæ ¼å…·æœ‰å¦‚ä¸‹çš„å°å‘é‡: <span class="math display">\[
(1, -key, k_1, k_2, \cdots, k_{30})
\begin{pmatrix}
g_1 &amp; g_2 &amp; \cdots &amp; g_{30} &amp; 1 &amp; \\
t_1 &amp; t_2 &amp; \cdots &amp; t_{30} &amp;   &amp; 1\\
p \\
&amp;p\\
&amp;&amp;\ddots\\
&amp;&amp;&amp;p
\end{pmatrix}
= (z_1, z_2, \cdots, z_{30}, 1, -key)
\]</span> <span class="math inline">\(z_i\)</span>æ˜¯æ¯”è¾ƒå°çš„ï¼Œæ‰€ä»¥å¯¹æ ¼ä½¿ç”¨æ ¼åŸºè§„çº¦ç®—æ³•å¯èƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªçŸ­å‘é‡ã€‚è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹ï¼Œè®©è¿™ä¸ªå‘é‡çš„å„åˆ†é‡éƒ½æ¯”è¾ƒæ¥è¿‘ï¼Œè¿™æ ·æ›´å®¹æ˜“å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆï¼Œæœ€ç»ˆæˆ‘ä»¬æ„é€ ä¸€ä¸ªå¦‚ä¸‹çš„æ ¼ï¼Œå…·æœ‰å¦‚ä¸‹çš„çŸ­å‘é‡:
<span class="math display">\[
(1, -key, k_1, k_2, \cdots, k_{30})
\begin{pmatrix}
2^{112}g_1 &amp; 2^{112}g_2 &amp; \cdots &amp; 2^{112}g_{30} &amp;
2^{512} &amp; \\
2^{112}t_1 &amp; 2^{112}t_2 &amp; \cdots &amp; 2^{112}t_{30}
&amp;   &amp; 1\\
2^{112}p \\
&amp;2^{112}p\\
&amp;&amp;\ddots\\
&amp;&amp;&amp;2^{112}p
\end{pmatrix}
= (2^{112}z_1, 2^{112}z_2, \cdots, 2^{112}z_{30}, 2^{512}, -key)
\]</span></p>
<p>å› ä¸º<span class="math inline">\(key\)</span>ä¸<span class="math inline">\(p\)</span>çš„å¤§å°ç›¸è¿‘ï¼Œæ‰€ä»¥æœ€åæ ¼å‡ºæ¥çš„å®é™…ä¸Šæ˜¯<span class="math inline">\(key-p\)</span></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">p = <span class="number">13401991645840298882794100147034379521242237285821020793208518466205688272722127694554243298223159648613332253774886696888511245155898681828972316158766813</span></span><br><span class="line">ts = [<span class="number">8016983781273189754281912962247057409930227455812224730112055674262101679986538896353333785641031178561641562965339977035588567181180100475283408488320671</span>, <span class="number">12980173980684618239567238092970002844391225790428809984588444288874980047043175328056782109973890659670718383856150425014293022930574469326618263083648099</span>, <span class="number">8109856702010014482292978050018141635784057812487351143916154508689142112615449144377702002382005662470835964315028619291602564624893518861557701327890923</span>, <span class="number">12785373226115694299429762427866573289359143336748874789256870948157808484043436344897926547699412946084053665605873366419653263394817308889578649556482317</span>, <span class="number">12293720016807713691819354075258380849321736691923473670291035750221768289875347194928451102365603432383881559318603460687890903510706219895796459019974867</span>, <span class="number">9784378896444105030039569921777285228994264456281120536753266782980679466146906618674672118057906497814953677764528302638725540882074537262487534252076829</span>, <span class="number">9241433814815706758885649801540944918822400007457713603674159882791199750057709773097552334465041959969676782253637817171507122904345522225398825682237481</span>, <span class="number">11204803848333722110323297716136514262820561394355433234423667799557561253910421337700868735544193790444406938869863716247161888020220901893711513603634809</span>, <span class="number">10851090251796215969502640347727949807230163009657915435491546953253351810608099195268759626721620529756828379004467476267712531905975334082089231769707617</span>, <span class="number">11250957460128461102060212243723539805901629603092001540925013383541943835129096257407578679799378517176957440298695788786794500447140718667332595080944869</span>, <span class="number">12248623923069220370917375593286718711586079377902376988707257328512455851210970182518826733646869485671374318338949112466814956514662420760908691130244383</span>, <span class="number">11061068271412202445428992286301637014530049371871820612053163253748795430394720967354122057185625710764847486790478210908967065668096047462000900877243843</span>, <span class="number">9250800791153158078642768324800520716511537203538708124830844957330029236789799844775267058446261708862442981956837389747149720449997356553753692631237873</span>, <span class="number">11442112467994330302413453979716258058149104607244851803491048585747359474970005873336772224480265499136742622823880716879860377641238675210553131052206691</span>, <span class="number">8851268226889934481971979527547782930762103134830344221114784617526682434893736517219781937490279514229768881864475696389373739501629994242420024622585309</span>, <span class="number">8761826274329402585517262093482651333161640060627583337505498299736119877176278155436111156185319629046980645810012652601825582701466570339570478108791887</span>, <span class="number">8173260008522260126563915135008278248111293487661172115633899079869720932758788675224579864948752039769531398938248083971071345978173279466336354696742377</span>, <span class="number">11733325877716881936637372036969125985631514189799569847189115606745019694984456424617859168884541552882900918661071180298079869943357668081866511603361429</span>, <span class="number">12798678249651545625305346509566263707129030745621625744465668772298872710674031103310015594375483838020916596533864897632924958154707810583510669376046159</span>, <span class="number">11972367565183102195894957634073708898746516169055154830786380821612631063771935949099855541345280195465211676841845799521135332692746439801114025346776451</span>, <span class="number">8309485355838062558333744941897142201736283502970173073711189070760311131678107029730686549988329677109870570827466668034034377094834508445549924223585219</span>, <span class="number">10037957030668927878463105058548635761147918169468443696251870837018029994579358415317101911755591591785037623566701920710453008930531891302329922308475079</span>, <span class="number">13221078857886779075714191159549244640144219704164657103905516889650093241197471185563906205007376146027157620524696025494715411571586859030421582641250071</span>, <span class="number">13377141034964464295846379646837504968557246139611266461228568513844912255762222441387410898249170108735540582627742796017922462329606088337301365183628591</span>, <span class="number">11503417590216916228951909788782481610038959664264972733435373475346403291387209063270057139621628854733942831548624992555175497319058962145185736395531609</span>, <span class="number">10682562966818807073688884352394574841623385668134186058213080078637580526582062737913378756835873195913042020318042792997704842570481165538229628253983417</span>, <span class="number">7009494733984067792833862756223517770477471938386639921019003601598472840183655333614008677846799784155444425042016748876974547683111073376705004070094301</span>, <span class="number">9396274922380984183217450286560296708001013262936289587249206096013034374236192395477584831821730898646879768741299571262843654547918064041618890696711333</span>, <span class="number">9055143657462834722016836241561857041386247088507191351272758917384350750091500866289528933248085632291073921554368989805281660196853938630560350667255913</span>, <span class="number">7075881589550115729079726581415060529537262743216265811601339312252250745864621882784185460812341989475906020671174894015501378625757286896275136526488817</span>]</span><br><span class="line">gs = [<span class="number">3547025130757031371763547817278671805806523773597386380426228204353325314755125874825372064344551510783942287325061869515563511720377069479838665918916338</span>, <span class="number">561524185998066303459395863084068415723518371857539287162474295289737845979144864495515229777991463363132381517905379393086271602757286846999926034367409</span>, <span class="number">10630918988200018501478600883655233518093875635494077893436132190015060760951001030031068630865667129447250982542911493607849695255758299063471724885107320</span>, <span class="number">5385738167688714294394456876987750423263279740302210790063861475593679005286633965917637168163655774852001750955925563171806165861440634515967640179944804</span>, <span class="number">3686451063569312252337028014973428925521749963152262622523483348285262144703447272544972123815729823760936936761643322992469583780002855185407873398768127</span>, <span class="number">9596580956215126253893458055745193704575088913515678341231900675542245449333964660007025564677263334281046226112471415925784249910282102204627251580303047</span>, <span class="number">9656829597739031272294632966205884640125918053307645634673206826103547310810254891833432384622548154588598670746803614688469837172848481449498079690935715</span>, <span class="number">9907308304392368929600091658386459655450451232070442677496713774343506026327224070703486188335961098033888098971263207077722473044862118000082007110037557</span>, <span class="number">7839372385123283975949639433665292734490760458360682832497005213559939527031767909811695257768341209806346811519315554587887588294359891829457980910373676</span>, <span class="number">9524560447616291402016995361580593070951296833074538783490159546001656765257005901587161833656370873513309819850104060230660386406669378214335512722509152</span>, <span class="number">8734422874517209772760818316188000967216535009508164549745674472106165337990045713973843427581730460676070294620298664038968581128044873585552989614725336</span>, <span class="number">5148158222052082942951739997892280954937954769195857112271289335776175568625514426629773392655353554820374445881301175856523121361252868192790918069469104</span>, <span class="number">3405639365216597742633558534342314393231966921971024333387009357007031255109911181571542920889177048552084631482291912851876735480121959418518626599223928</span>, <span class="number">6965895908963098896413697893751255263053889382630643791713636829201586125658579731479485123904224727756791164618191156426250811133029277086293720268527300</span>, <span class="number">515472047175628755463279789359658211455570096067652817360508027869002916852457796014115363850477155232728049656195126940493402028508630979737222916876246</span>, <span class="number">8377848726362282033165443045774756072489017398005262818165334796393061408947900148462399707261050565348807577258621241416711089587307194346694505937252864</span>, <span class="number">1178755053483981880338850194698011124968424379914871101461970724324613752209283539401502897388962321646518511682063263530792638817282211333222820982688221</span>, <span class="number">6409725586399153562174435158247599193499008381130383743433623949976530392240171542527657077771723107664747118903213393154893390715457247849808357209465942</span>, <span class="number">3372824803484968486680937546271819996332625362891283809637871759604598252172343794474197823370030403360262989580844260103083478034905726890611202238641340</span>, <span class="number">13221067729455004299677399984872603663881675510140157358091630484387026309376774076498558628883879446483977202290444900329681753187886973457338777404374837</span>, <span class="number">7168388056726802823482632673894477305062116631923141017136239676696007696629606782541016490173953868270727600022309320772114799519383514048456314407549126</span>, <span class="number">5250230933448962245502125593869313477032913928941516938273943408457441209365441112912617832856547549404891414953525445963675011329667621804152746371657313</span>, <span class="number">8511291855606246692070730459514263912089592580342504124890734122750181111943376656479213361961009582891618556261302703133404839204999651359329176948170842</span>, <span class="number">10576966024912004586600985705328475294820172279541596349092328002861342696932964481093301707680584309062968518297314914578723605267596141569538103299931592</span>, <span class="number">12610576251820483830699440118009518195547953924641848179631259695652398482759919292823264035055444639679877606276670927735340951916197191958922906156370663</span>, <span class="number">3742260845065949575192054445757226288737527960324254459850715703182879384214273141678432129201712761002566924178045796602250837169613100836509080462118064</span>, <span class="number">11563799338655584285772430060426469486983276581413105960901201146319641194721216394735314795999096052047566733050321685673448559752053334666493545565267458</span>, <span class="number">2135904971793751083168704063674429207856744601756475004904460101727999030934815461118290836502605293753384609825541213034656253854812143724421464450937515</span>, <span class="number">3115138049292154301818359336614981367419382594686950083225042221335435796679806070685800479754927915293066789893346628151325862299622031407323031470432866</span>, <span class="number">11834987428374239733081967249175125232293539826462896997963240557834259212701171232384194311849363016441847536816726226234955703291712817155658535826680986</span>]</span><br><span class="line">iv=<span class="string">b&#x27;\x88\x0c\x7f\x92\xd7\xb7\xaf4\xe4\xfb\xd1_\xab\xff)\xb8&#x27;</span></span><br><span class="line">ciphertext=<span class="string">b&#x27;\x94\x198\xd6\xa2mK\x00\x06\x7f\xad\xa0M\xf7\xadV;EO$\xee\xcdB0)\xfb!&amp;8%,M&#x27;</span></span><br><span class="line"></span><br><span class="line">num = <span class="number">30</span></span><br><span class="line">M = matrix([gs[:num], ts[:num]])</span><br><span class="line">M = M.stack(p * identity_matrix(num))</span><br><span class="line"></span><br><span class="line">M = <span class="number">2</span>**<span class="number">112</span> * M</span><br><span class="line">I = matrix([[<span class="number">2</span>**<span class="number">512</span>, <span class="number">0</span>],</span><br><span class="line">            [<span class="number">0</span>,      <span class="number">1</span>]])</span><br><span class="line">M = M.augment(I.stack(zero_matrix(<span class="number">30</span>, <span class="number">2</span>)))</span><br><span class="line">MLLL = M.LLL()</span><br><span class="line">key = MLLL[<span class="number">1</span>][-<span class="number">1</span>] + p</span><br><span class="line">cipher = AES.new(<span class="built_in">str</span>(key).encode()[:<span class="number">16</span>], AES.MODE_CBC,iv)</span><br><span class="line">flag=cipher.decrypt(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># NSSCTF&#123;F@@@un7_L4444t1c3333!!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="rsa_and_dsa">RSA_and_DSA</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, randint</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">ink=getPrime(<span class="number">20</span>)</span><br><span class="line">p1= getPrime(<span class="number">512</span>)</span><br><span class="line">q1= getPrime(<span class="number">512</span>)</span><br><span class="line">N = p1* q1</span><br><span class="line">phi = (p1-<span class="number">1</span>) * (q1-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d1= getRandomNBitInteger(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d1, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d1, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">c_ink = <span class="built_in">pow</span>(ink, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c_ink=&#x27;</span>,c_ink)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e=&#x27;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N=&#x27;</span>,N)</span><br><span class="line"></span><br><span class="line">k= getPrime(<span class="number">64</span>)</span><br><span class="line">q = getPrime(<span class="number">160</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg, pub, pri, k</span>):</span><br><span class="line">    (p,q,g,y) = pub</span><br><span class="line">    x = pri</span><br><span class="line">    r = <span class="built_in">int</span>(<span class="built_in">pow</span>(g, k, p) % q)</span><br><span class="line">    h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    s = <span class="built_in">int</span>((h + x * r) * gmpy2.invert(k, q) % q)</span><br><span class="line">    <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    temp = q * getrandbits(<span class="number">864</span>)</span><br><span class="line">    <span class="keyword">if</span> isPrime(temp + <span class="number">1</span>):</span><br><span class="line">        p = temp + <span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">assert</span> p % q == <span class="number">1</span></span><br><span class="line">h = randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">g = <span class="built_in">pow</span>(h, (p - <span class="number">1</span>) // q, p)</span><br><span class="line">y = <span class="built_in">pow</span>(g, k, p)</span><br><span class="line">pub = (p,q,g,y)</span><br><span class="line">pri = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r1,s1)=&quot;</span>,sign(<span class="string">b&#x27;GHCTF-2025&#x27;</span>, pub, pri, k))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r2,s2)=&quot;</span>,sign(<span class="string">b&#x27;GHCTF-2025&#x27;</span>, pub, pri, k+ink))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;g= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;q= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;y= &#125;</span>&quot;</span>)</span><br><span class="line">key = hashlib.sha1(<span class="built_in">str</span>(pri).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag=<span class="string">&quot;NSSCTF&#123;xxxxxxxxx&#125;&quot;</span></span><br><span class="line">ciphertext = cipher.encrypt(pad(flag.encode(), <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c_ink= 84329531596553394336538987023357227935440127545924398750500007122949822951975451942488164538560925222694222413022235832336439700420379598454619959178424907616592885325169668838139433265501326382467741883799799897305247164532663683724926267222341485376684034461780316163663624769479766276645610470850267093664</span></span><br><span class="line"><span class="string">e= 100797590979191597676081881632112443200677974501832055481332601002844223186483558337099380805371010917502984674789369037985572270571944684404114475915036053451756526659905789324413633016308331745100752282051937597697581233757669107763643041665187533373053952694612521031477624363476981177214961821456672635823</span></span><br><span class="line"><span class="string">N= 133020919573254586736009662994351483197630110046444622015176359062686053521475990861985101412597512894313048001198942449066636145265799205815566892581351543233960812384316942438814742826123037762680960898927252792974233266551853930274479435403549161383103059746381782668941421906340168652870371226382805032027</span></span><br><span class="line"><span class="string">(r1,s1)= (105538622724986198173818280402723234123231812870, 165871242333491991006684781121637801537623792920)</span></span><br><span class="line"><span class="string">(r2,s2)= (895673018852361693797535983771888430717799939767, 511956887428148277909616673338517730698888202223)</span></span><br><span class="line"><span class="string">g= 97444164915108666817264719918456841236668149777715575246719562319277238318814584882880249446488655758781498681349330709135670188875982069778879957837454582916193915374305422049064769688749957611500682447936476425649642359105731049262259786188565867271216015835626264543593116387612078934710741467063982007499</span></span><br><span class="line"><span class="string">q= 974306102330898613562307019447798934376234044213</span></span><br><span class="line"><span class="string">p= 113996945917185663452903189185812083054654586038361814576057637684218572059191009152754335053396974825607186512631652893899380922217026759410880236546966561476761050482902589270845489570126254333374605973087540746242818447451510386137109253463070487353845675998098620056687507969012229115435439218407426962991</span></span><br><span class="line"><span class="string">y= 8015503667614219250943034151839311927430676423719991507127801373333532219335171760992873121586820712328636972152697436159934583810723294897449200937370031784164230148453787378834760102389031574149857480339843366568164403131143385627621208571673677878768568991050568882099039880976450795530322753270408770484</span></span><br><span class="line"><span class="string">ciphertext = b&#x27;\xb0\ra\x9c\xeb9y\xd5k\xfde\xdfJ\xba\n\xce^u\xae\x81J8\xe4\x8da\xdf;H@WV5&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></p>
<p><strong>RSAéƒ¨åˆ†</strong></p>
<p>è¿™é‡Œå‘ç°dåªæœ‰200bitsï¼Œç¬¦åˆweineræ”»å‡»çš„æ¡ä»¶ï¼š <span class="math display">\[
d &lt; \frac{1}{3}N^{0.25}
\]</span> é€šè¿‡weineræ”»å‡»ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å¾—è·å–ç§é’¥dï¼Œè§£å¯†å¾—åˆ°inkã€‚</p>
<p><strong>DASéƒ¨åˆ†</strong></p>
<p>DASæ–¹æ¡ˆä¸­ï¼Œæ¯æ¬¡ç­¾åéƒ½åº”è¯¥ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„éšæœºæ•°ï¼Œè€Œè¿™é‡Œè¿›è¡Œçš„ä¸¤æ¬¡ç­¾åä½¿ç”¨çš„éšæœºæ•°æ˜¯kï¼Œk+inkï¼Œè¿™æ ·æ ¹æ®ç­¾åçš„ç­‰å¼ï¼Œæˆ‘ä»¬å°±æœ‰å¦‚ä¸‹ä¸¤ç»„æ–¹ç¨‹:</p>
<p><span class="math display">\[
\begin{aligned}
k*s_1 \equiv h + xr_1 \mod q \\
(k+ink)*s_2 \equiv h + xr_2 \mod q
\end{aligned}
\]</span> åˆšå¥½2ä¸ªæœªçŸ¥é‡ï¼Œè”ç«‹è§£å‡ºxå³å¯ã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA</span></span><br><span class="line">c_ink= <span class="number">84329531596553394336538987023357227935440127545924398750500007122949822951975451942488164538560925222694222413022235832336439700420379598454619959178424907616592885325169668838139433265501326382467741883799799897305247164532663683724926267222341485376684034461780316163663624769479766276645610470850267093664</span></span><br><span class="line">e= <span class="number">100797590979191597676081881632112443200677974501832055481332601002844223186483558337099380805371010917502984674789369037985572270571944684404114475915036053451756526659905789324413633016308331745100752282051937597697581233757669107763643041665187533373053952694612521031477624363476981177214961821456672635823</span></span><br><span class="line">N= <span class="number">133020919573254586736009662994351483197630110046444622015176359062686053521475990861985101412597512894313048001198942449066636145265799205815566892581351543233960812384316942438814742826123037762680960898927252792974233266551853930274479435403549161383103059746381782668941421906340168652870371226382805032027</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="variable language_">self</span>.numberlist = []  <span class="comment"># number in continued fraction</span></span><br><span class="line">        <span class="variable language_">self</span>.fractionlist = []  <span class="comment"># the near fraction list</span></span><br><span class="line">        <span class="variable language_">self</span>.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        <span class="variable language_">self</span>.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            <span class="variable language_">self</span>.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist.append([<span class="variable language_">self</span>.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>.numberlist)):</span><br><span class="line">            numerator = <span class="variable language_">self</span>.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * <span class="variable language_">self</span>.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            <span class="variable language_">self</span>.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = ContinuedFraction(e, N)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="keyword">if</span> d.bit_length() == <span class="number">200</span>:</span><br><span class="line">        phi = (e*d - <span class="number">1</span>) // k</span><br><span class="line">        delta = iroot((phi - N - <span class="number">1</span>)**<span class="number">2</span> - <span class="number">4</span>*N, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> delta[<span class="number">1</span>]:</span><br><span class="line">            delta = <span class="built_in">int</span>(delta[<span class="number">0</span>])</span><br><span class="line">            p, q = (delta - phi + N + <span class="number">1</span>) // <span class="number">2</span>, (-delta - phi + N + <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="keyword">assert</span> p*q == N</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">ink = <span class="built_in">pow</span>(c_ink, d, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ink = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># DSA</span></span><br><span class="line">(r1,s1)= (<span class="number">105538622724986198173818280402723234123231812870</span>, <span class="number">165871242333491991006684781121637801537623792920</span>)</span><br><span class="line">(r2,s2)= (<span class="number">895673018852361693797535983771888430717799939767</span>, <span class="number">511956887428148277909616673338517730698888202223</span>)</span><br><span class="line">g= <span class="number">97444164915108666817264719918456841236668149777715575246719562319277238318814584882880249446488655758781498681349330709135670188875982069778879957837454582916193915374305422049064769688749957611500682447936476425649642359105731049262259786188565867271216015835626264543593116387612078934710741467063982007499</span></span><br><span class="line">q= <span class="number">974306102330898613562307019447798934376234044213</span></span><br><span class="line">p= <span class="number">113996945917185663452903189185812083054654586038361814576057637684218572059191009152754335053396974825607186512631652893899380922217026759410880236546966561476761050482902589270845489570126254333374605973087540746242818447451510386137109253463070487353845675998098620056687507969012229115435439218407426962991</span></span><br><span class="line">y= <span class="number">8015503667614219250943034151839311927430676423719991507127801373333532219335171760992873121586820712328636972152697436159934583810723294897449200937370031784164230148453787378834760102389031574149857480339843366568164403131143385627621208571673677878768568991050568882099039880976450795530322753270408770484</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\xb0\ra\x9c\xeb9y\xd5k\xfde\xdfJ\xba\n\xce^u\xae\x81J8\xe4\x8da\xdf;H@WV5&#x27;</span></span><br><span class="line">msg = <span class="string">b&#x27;GHCTF-2025&#x27;</span></span><br><span class="line">h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">pri = x = (h*s1 - h*s2 - ink*s1*s2)*<span class="built_in">pow</span>(r1*s2 - r2*s1, -<span class="number">1</span>, q) % q</span><br><span class="line"></span><br><span class="line">key = hashlib.sha1(<span class="built_in">str</span>(pri).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag = cipher.decrypt(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;flag = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># NSSCTF&#123;n0_RRRrs4_or_DDDS4????&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œå…¶å®å¯ä»¥ä¸ç”¨ç®¡RSAï¼Œå› ä¸ºinkåªæœ‰20bitsï¼Œç›´æ¥çˆ†ç ´ä¹Ÿè¡Œï¼š</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># brute.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line"><span class="comment"># DSA</span></span><br><span class="line">(r1,s1)= (<span class="number">105538622724986198173818280402723234123231812870</span>, <span class="number">165871242333491991006684781121637801537623792920</span>)</span><br><span class="line">(r2,s2)= (<span class="number">895673018852361693797535983771888430717799939767</span>, <span class="number">511956887428148277909616673338517730698888202223</span>)</span><br><span class="line">g= <span class="number">97444164915108666817264719918456841236668149777715575246719562319277238318814584882880249446488655758781498681349330709135670188875982069778879957837454582916193915374305422049064769688749957611500682447936476425649642359105731049262259786188565867271216015835626264543593116387612078934710741467063982007499</span></span><br><span class="line">q= <span class="number">974306102330898613562307019447798934376234044213</span></span><br><span class="line">p= <span class="number">113996945917185663452903189185812083054654586038361814576057637684218572059191009152754335053396974825607186512631652893899380922217026759410880236546966561476761050482902589270845489570126254333374605973087540746242818447451510386137109253463070487353845675998098620056687507969012229115435439218407426962991</span></span><br><span class="line">y= <span class="number">8015503667614219250943034151839311927430676423719991507127801373333532219335171760992873121586820712328636972152697436159934583810723294897449200937370031784164230148453787378834760102389031574149857480339843366568164403131143385627621208571673677878768568991050568882099039880976450795530322753270408770484</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\xb0\ra\x9c\xeb9y\xd5k\xfde\xdfJ\xba\n\xce^u\xae\x81J8\xe4\x8da\xdf;H@WV5&#x27;</span></span><br><span class="line">msg = <span class="string">b&#x27;GHCTF-2025&#x27;</span></span><br><span class="line">h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> ink <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">19</span>, <span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">    pri = x = (h*s1 - h*s2 - ink*s1*s2)*<span class="built_in">pow</span>(r1*s2 - r2*s1, -<span class="number">1</span>, q) % q</span><br><span class="line">    key = hashlib.sha1(<span class="built_in">str</span>(pri).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">if</span> flag.startswith(<span class="string">b&quot;NSSCTF&#123;&quot;</span>):</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># NSSCTF&#123;n0_RRRrs4_or_DDDS4????&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="sin">Sin</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="built_in">print</span>((<span class="number">2</span> * sin((m := bytes_to_long(<span class="string">b&#x27;NSSCTF&#123;test_flag&#125;&#x27;</span>))) - <span class="number">2</span> * sin(m) * cos(<span class="number">2</span> * m)).n(<span class="number">1024</span>))</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mçš„å€¼å³ä¸ºflag</span></span><br><span class="line"><span class="string">0.002127416739298073705574696200593072466561264659902471755875472082922378713642526659977748539883974700909790177123989603377522367935117269828845667662846262538383970611125421928502514023071134249606638896732927126986577684281168953404180429353050907281796771238578083386883803332963268109308622153680934466412</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure> çŸ¥ä¹ä¸Šæœ‰ä¸ªå¾ˆåƒä½†æ¯”è¿™é¢˜ç®€å•çš„ç‰ˆæœ¬ï¼š</p>
<p><a href="https://www.zhihu.com/question/2059501083/answer/39015211971">è®¾kæ˜¯ä¸€ä¸ª10ä½æ•´æ•°ï¼Œä¸”sqrtï¼ˆkï¼‰çš„å°æ•°ç‚¹å15ä½ä¸º418400286617716ï¼Œæ±‚kã€‚ï¼Ÿ</a></p>
<p>è¿™é¢˜è€å¥—è·¯äº†ï¼Œä¹‹å‰åœ¨shctfä¸Šæœ‰é“å·®ä¸å¤šçš„ï¼Œåªä¸è¿‡shctfé‚£é¢˜æ˜¯<span class="math inline">\(\cos\)</span>ã€‚ è¿™é‡Œæˆ‘ä»¬å…ˆåŒ–ç®€: <span class="math display">\[
\begin{aligned}
c&amp;=2\sin(m) - 2\sin(m)\cos(2m)\\
&amp;=2\sin(m)(1-\cos(2m))\\
&amp;=4\sin^3(m)
\end{aligned}
\]</span> æ‰€ä»¥: <span class="math display">\[
\arcsin((\frac{c}{4})^{\frac{1}{3}}) = m + k\pi
\]</span> å…¶ä¸­<span class="math inline">\(m,k\)</span>æ˜¯æ•´æ•°ã€‚
ä¸ºäº†æ–¹ä¾¿ï¼Œè¿™é‡Œè®°<span class="math inline">\(\arcsin((\frac{c}{4})^{\frac{1}{3}})ä¸ºm_{fake}\)</span></p>
<p>å®æ•°åŸŸä¸Šè¿™ä¸ªç­‰å¼æ˜¯æˆç«‹çš„ã€‚ä½†åœ¨è®¡ç®—æœºä¸Šä¸ä¸€å®šï¼Œå‡è®¾æˆ‘ä»¬å¯¹<span class="math inline">\(m_{fake},
\pi\)</span>éƒ½åªå–1024æ¯”ç‰¹çš„ç²¾åº¦ï¼Œé‚£ä¹ˆå®é™…ä¸Šæ˜¯ä¼šå­˜åœ¨ä¸€ä¸ªéå¸¸å°çš„è¯¯å·®<span class="math inline">\(\epsilon\)</span>: <span class="math display">\[
m_{fake} = m + k\pi  + \epsilon
\]</span> å³ï¼š <span class="math display">\[
\epsilon = m_{fake} - m - k\pi
\]</span></p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªå¦‚ä¸‹çš„æ ¼: <span class="math display">\[
(-m, 1, -k)
\begin{pmatrix}
1&amp;1&amp;0\\
m_{fake}&amp;0&amp;1\\
\pi&amp;0&amp;0\\
\end{pmatrix}
= (\epsilon, -m, 1)
\]</span> è¿™é‡Œä¸ºäº†è®©ç›®æ ‡å‘é‡çš„å„ä¸ªåˆ†é‡æ¯”è¾ƒå‡è¡¡ï¼Œæ‰€ä»¥å¯¹æ ¼ç¨å¾®è°ƒæ•´ä¸€ä¸‹ï¼š
<span class="math display">\[
(-m, 1, -k)
\begin{pmatrix}
2^{1024}&amp;1&amp;0\\
2^{1024}m_{fake}&amp;0&amp;2^{256}\\
2^{1024}\pi&amp;0&amp;0\\
\end{pmatrix}
= (2^{1024}\epsilon, -m, 2^{256})
\]</span></p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line">exp.sage</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = <span class="number">0.002127416739298073705574696200593072466561264659902471755875472082922378713642526659977748539883974700909790177123989603377522367935117269828845667662846262538383970611125421928502514023071134249606638896732927126986577684281168953404180429353050907281796771238578083386883803332963268109308622153680934466412</span></span><br><span class="line">sin_m = (c / <span class="number">4</span>).nth_root(<span class="number">3</span>)</span><br><span class="line">fake_m = arcsin(sin_m)</span><br><span class="line">PI = pi.n(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">M = column_matrix([<span class="number">1</span>, QQ(fake_m), QQ(PI)])</span><br><span class="line">M = <span class="number">2</span>**<span class="number">1024</span> * M </span><br><span class="line">I = matrix([[<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">            [<span class="number">0</span>, <span class="number">2</span>**<span class="number">256</span>]])</span><br><span class="line">M = M.augment(I.stack(vector([<span class="number">0</span>, <span class="number">0</span>])))</span><br><span class="line">ML = M.LLL()</span><br><span class="line"><span class="comment"># print(ML[0])</span></span><br><span class="line"><span class="comment"># for i in ML[0]:</span></span><br><span class="line"><span class="comment">#     print(i.n())</span></span><br><span class="line">flag = <span class="built_in">abs</span>(ML[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag)))</span><br><span class="line"><span class="comment"># NSSCTF&#123;just_make_a_latter_and_LLL_is_OK_padpad&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="river">river</h3>
<p>é¢˜ç›®ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, seed, mask</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">è¸©è¸©èƒŒ</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask, lfsr=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;seed:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        <span class="variable language_">self</span>.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;mask:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.lfsr = lfsr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([<span class="variable language_">self</span>.state[i] * <span class="variable language_">self</span>.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n)]) &amp; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.state = <span class="variable language_">self</span>.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.lfsr:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.lfsr():</span><br><span class="line">                <span class="variable language_">self</span>.update()</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.update()</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">å¥¶é¾™</span>(<span class="title class_ inherited__">è¸©è¸©èƒŒ</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(n, seed, mask, lfsr=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">64</span></span><br><span class="line"><span class="keyword">assert</span> seed.bit_length == mask.bit_length == n</span><br><span class="line">lfsr1 = å¥¶é¾™(n, seed, mask)</span><br><span class="line">lfsr2 = è¸©è¸©èƒŒ(n, seed, mask, lfsr1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mask = <span class="subst">&#123;mask&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;output = <span class="subst">&#123;<span class="built_in">sum</span>(lfsr2() &lt;&lt; (n - <span class="number">1</span> - i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># mask = 9494051593829874780</span></span><br><span class="line"><span class="comment"># output = 13799267741689921474</span></span><br><span class="line"><span class="comment"># enc = b&#x27;\x03\xd1#\xb9\xaa5\xff3y\xba\xcb\x91`\x9d4p~9r\xf6i\r\xca\x03dW\xdb\x9a\xd2\xa6\xc6\x85\xfa\x19=b\xb2)5&gt;]\x05,\xeb\xa0\x12\xa9\x1e&#x27; </span></span><br></pre></td></tr></table></figure></p>
<p>è¿™é¢˜ä¸€å¼€å§‹ä»¥ä¸ºå°±æ˜¯ä¸ªç®€å•çš„lfsrç ´è§£ï¼Œç›´æ¥æŠŠoutputå½“æˆlfsrçš„è¿ç»­64bitsè¾“å‡ºå»åšäº†ï¼Œç»“æœå‘ç°outputå¹¶ä¸æ˜¯lfsrçš„è¿ç»­64bitsè¾“å‡ºã€‚
ä½†æ˜¯å¯ä»¥å‘ç°outputæ˜¯ç”±lfsrçš„è¿ç»­64bitså†³å®šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¯•è¯•èƒ½ä¸èƒ½ä»outputæ¨å‡ºlfsrçš„è¿ç»­64bitsã€‚</p>
<h4 id="è·å–lfsrçš„è¾“å‡º">è·å–lfsrçš„è¾“å‡º</h4>
<p>å‡è®¾lfsrçš„å‰64bitsè¾“å‡ºå¦‚ä¸‹ï¼š <span class="math display">\[
\mathbf{a} = (a_1, a_2, a_3, \cdots, a_{64})
\]</span> outputç¬¬iä½çš„è¾“å‡ºé€»è¾‘æ˜¯ï¼š</p>
<ul>
<li>å¦‚æœ<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½æ˜¯1ï¼Œé‚£ä¹ˆæ›´æ–°lfsrçš„çŠ¶æ€ï¼Œè¾“å‡ºå½“å‰çŠ¶æ€çš„æœ€å1bits</li>
<li>å¦‚æœ<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½æ˜¯0ï¼Œé‚£ä¹ˆä¸æ›´æ–°lfsrçš„çŠ¶æ€ï¼Œè¾“å‡ºå½“å‰çŠ¶æ€çš„æœ€å1bits</li>
</ul>
<p>æ ¹æ®è¿™ä¸ªè¾“å‡ºé€»è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“outputä¸€å®šæ˜¯<span class="math inline">\(\mathbf{a}\)</span>ä¸­çš„å…ƒç´ ï¼Œoutputçš„ç¬¬kä½ä¸€å®šæ¥è‡ªäº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½ï¼Œiä¸è¶…è¿‡aã€‚</p>
<p>outputè½¬åŒ–ä¸ºäºŒè¿›åˆ¶å‘é‡å¦‚ä¸‹: <span class="math display">\[
(1, 0, 1, 1 , \cdots, 0, 1, 0)
\]</span> æˆ‘ä»¬å¯ä»¥çŸ¥é“<span class="math inline">\(a_2,
a_3\)</span>ä¸€å®šæ˜¯1ï¼Œå› ä¸ºoutputåœ¨ç¬¬1ä½åˆ°ç¬¬2ä½ã€ç¬¬2ä½åˆ°3ä½å‘ç”Ÿäº†å˜åŒ–ï¼Œä¹Ÿå°±æ˜¯lfsrçš„çŠ¶æ€ä¸€å®šæ›´æ–°äº†ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜å¯ä»¥æ¨å‡º<span class="math inline">\(a_1\)</span>ä¸€å®šæ˜¯0ï¼Œå› ä¸ºå¦‚æœ<span class="math inline">\(a_1\)</span>æ˜¯1çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§outputçš„ç”Ÿæˆé€»è¾‘ï¼Œå¾—å‡ºoutputçš„ç¬¬2ä½ä¹Ÿæ˜¯1ï¼Œè¿™ä¸äº‹å®çŸ›ç›¾ã€‚
è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†<span class="math inline">\(\mathbf{a}\)</span>çš„å‰ç¼€æ˜¯<span class="math inline">\((0,1,1)\)</span>ï¼Œç„¶åå¯ä»¥åˆ©ç”¨
é€’å½’ä»å‰å¾€åæ±‚è§£<span class="math inline">\(\mathbf{a}\)</span>ã€‚</p>
<p>é€’å½’å‡½æ•°ä¸º<strong>dfs(index, prefix, output)</strong></p>
<p>å‡è®¾æˆ‘ä»¬å·²ç»çŸ¥é“äº†<span class="math inline">\(\mathbf{a}\)</span>çš„kä½å‰ç¼€(ä»£ç ä¸­è®°ä½œprefix)ï¼š
<span class="math display">\[
(a_1, a_2, \cdots, a_k)
\]</span> å‡è®¾outputçš„ç¬¬kä½æ¥è‡ªäº<span class="math inline">\(\mathbf{a}\)</span>ç¬¬iä½(ä»£ç ä¸­è®°ä½œindex)
ç„¶åè€ƒè™‘outputçš„ç¬¬k+1ä½ï¼š</p>
<ol type="1">
<li>å¦‚æœoutputçš„ç¬¬k+1ä½ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½ï¼Œè¯´æ˜lfsrå¯èƒ½æ²¡æœ‰æ›´æ–°ï¼Œprefixåé¢å°±åº”è¯¥å†åŠ ä¸Š0ï¼Œå³<strong>dfs(index,
prefix[:] + [0], output)</strong></li>
<li>å¦‚æœoutputçš„ç¬¬k+1ä½ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½ä¸”outputçš„ç¬¬k+1ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬i+1ä½ï¼Œè¯´æ˜lfsrå¯èƒ½æ›´æ–°äº†ï¼Œprefixåé¢åº”è¯¥å†åŠ ä¸Š1ï¼Œå³<strong>dfs(index+1,
prefix[:] + [1], output)</strong></li>
<li>å¦‚æœoutputçš„ç¬¬k+1ä½ä¸ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½ä¸”outputçš„ç¬¬k+1ä½ä¸ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬i+1ä½ï¼Œè¯´æ˜è¿™æ˜¯çŸ›ç›¾çš„ã€‚</li>
<li>å¦‚æœoutputçš„ç¬¬k+1ä½ä¸ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬iä½ä¸”outputçš„ç¬¬k+1ä½ç­‰äº<span class="math inline">\(\mathbf{a}\)</span>çš„ç¬¬i+1ä½ï¼Œè¯´æ˜lfsråªå¯èƒ½æ˜¯æ›´æ–°äº†ï¼Œprefixåé¢åº”è¯¥å†åŠ ä¸Š1ï¼Œå³<strong>dfs(index+1,
prefix[:] + [1], output)</strong></li>
</ol>
<p>å°±è¿™æ ·å¾€åé¢é€’å½’ï¼Œç›´åˆ°prefixçš„é•¿åº¦è¾¾åˆ°64ï¼Œå°±è¯´æ˜å·²ç»æ‰¾åˆ°äº†<span class="math inline">\(\mathbf{a}\)</span>çš„ä¸€ç§æƒ…å†µã€‚</p>
<h4 id="ç ´è§£lfsr">ç ´è§£lfsr</h4>
<p>lfsråœ¨ç”Ÿæˆéšæœºæ•°çš„è¿‡ç¨‹ä¸­ï¼Œä¸€ç›´åœ¨ç»´æŠ¤ä¸€ä¸ªçŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ç”±64ä¸ªæ¯”ç‰¹æ„æˆï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒè®°ä½œï¼š
<span class="math display">\[
\mathbf{state} = (s_1, s_2, \cdots, s_{64})
\]</span> åŠ å¯†è¿‡ç¨‹è¿˜éœ€è¦ä¸€ä¸ªæ©ç mask,æˆ‘ä»¬è®°ä½œï¼š <span class="math display">\[
\mathbf{mask} = (m_1, m_2, \cdots, m_{64})
\]</span>
ç„¶åå°†è¿™ä¸¤ä¸ªå‘é‡ä½œå†…ç§¯ï¼Œå¾—åˆ°çš„å°±æ˜¯è¾“å‡ºæ¯”ç‰¹ï¼Œè¦æ³¨æ„è¿™é‡Œçš„è¿ç®—æ˜¯åœ¨<span class="math inline">\(GF(2)\)</span>ä¸Šè¿›è¡Œçš„(å¯ä»¥ç®€å•çš„ç†è§£ä¸ºæ‰€æœ‰è¿ç®—éƒ½è¦æ¨¡2ï¼Œä¿è¯æ•°æ®åªæœ‰1æ¯”ç‰¹çš„å¤§å°)ã€‚é‚£ä¹ˆæ–°çš„çŠ¶æ€å¯ä»¥è¡¨ç¤ºä¸ºï¼š
<span class="math display">\[
\mathbf{state}^{&#39;} = ( s_2, s_3, \cdots, s_{64}, \mathbf{state}
\cdot \mathbf{mask}^T )
\]</span> æˆ‘ä»¬å¯ä»¥æŠŠå®ƒå†™ä½œçŸ©é˜µå½¢å¼ï¼š <span class="math display">\[
\mathbf{state}^{&#39;} = \mathbf{state}
\begin{pmatrix}
&amp;&amp;&amp;&amp;m_1\\
1&amp;&amp;&amp;&amp;m_2\\
&amp;1&amp;&amp;&amp;m_3\\
&amp;&amp;\ddots&amp;&amp;\vdots\\
&amp;&amp;&amp;1&amp;m_{64}
\end{pmatrix}
\]</span>
å°†è¿™ä¸ªçŸ©é˜µä½œç”¨64æ¬¡åå¾—åˆ°çš„çŠ¶æ€ï¼Œå°±æ˜¯lfsrçš„è¿ç»­64æ¯”ç‰¹çš„è¾“å‡ºï¼Œå³ï¼š <span class="math display">\[
\mathbf{a} = \mathbf{state}
\begin{pmatrix}
&amp;&amp;&amp;&amp;m_1\\
1&amp;&amp;&amp;&amp;m_2\\
&amp;1&amp;&amp;&amp;m_3\\
&amp;&amp;\ddots&amp;&amp;\vdots\\
&amp;&amp;&amp;1&amp;m_{64}
\end{pmatrix}^{64}
\]</span> æ‰€ä»¥æœ‰äº†<span class="math inline">\(\mathbf{a}\)</span>åï¼Œåªéœ€è¦å³ä¹˜ä¸€ä¸ªçŸ©é˜µé€†åŸå°±å¯ä»¥æ¢å¤åˆå§‹çŠ¶æ€ï¼Œä»è€Œå¾—åˆ°seedã€‚</p>
<p>exp: <figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># exp.sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">mask = <span class="number">9494051593829874780</span></span><br><span class="line">output = <span class="number">13799267741689921474</span></span><br><span class="line">enc = <span class="string">b&#x27;\x03\xd1#\xb9\xaa5\xff3y\xba\xcb\x91`\x9d4p~9r\xf6i\r\xca\x03dW\xdb\x9a\xd2\xa6\xc6\x85\xfa\x19=b\xb2)5&gt;]\x05,\xeb\xa0\x12\xa9\x1e&#x27;</span> </span><br><span class="line">n = <span class="built_in">int</span>(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">è¸©è¸©èƒŒ</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask, lfsr=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;seed:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        <span class="variable language_">self</span>.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;mask:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line">        <span class="variable language_">self</span>.lfsr = lfsr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([<span class="variable language_">self</span>.state[i] * <span class="variable language_">self</span>.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="variable language_">self</span>.n)]) &amp; <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.state = <span class="variable language_">self</span>.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.lfsr:</span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.lfsr():</span><br><span class="line">                <span class="variable language_">self</span>.update()</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="variable language_">self</span>.update()</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>.state[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">å¥¶é¾™</span>(<span class="title class_ inherited__">è¸©è¸©èƒŒ</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(n, seed, mask, lfsr=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">index, prefix, output</span>):</span><br><span class="line">    all_result = []</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(prefix) == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> [prefix]</span><br><span class="line">    next_num = <span class="built_in">len</span>(prefix)</span><br><span class="line">    <span class="keyword">if</span> prefix[index] == output[next_num]:</span><br><span class="line">        result = dfs(index, prefix[:] + [<span class="number">0</span>], output)</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">            <span class="keyword">if</span> r != <span class="literal">None</span>:</span><br><span class="line">                all_result.append(r)</span><br><span class="line">        <span class="keyword">if</span> prefix[index+<span class="number">1</span>] == output[next_num]:</span><br><span class="line">            result = dfs(index + <span class="number">1</span>, prefix[:] + [<span class="number">1</span>], output)</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">                <span class="keyword">if</span> r != <span class="literal">None</span>:</span><br><span class="line">                    all_result.append(r)</span><br><span class="line">    <span class="keyword">if</span> prefix[index] != output[next_num]:</span><br><span class="line">        <span class="keyword">if</span> prefix[index + <span class="number">1</span>] == output[next_num]:</span><br><span class="line">            result = dfs(index + <span class="number">1</span>, prefix[:] + [<span class="number">1</span>], output)</span><br><span class="line">            <span class="keyword">for</span> r <span class="keyword">in</span> result:</span><br><span class="line">                <span class="keyword">if</span> r != <span class="literal">None</span>:</span><br><span class="line">                    all_result.append(r)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> [<span class="literal">None</span>]</span><br><span class="line">    <span class="keyword">return</span> all_result</span><br><span class="line">    </span><br><span class="line">mask = matrix(GF(<span class="number">2</span>), [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;mask:<span class="number">0</span>&#123;<span class="number">64</span>&#125;</span>b&#125;&quot;</span>])</span><br><span class="line">M = zero_matrix(GF(<span class="number">2</span>), <span class="number">1</span>, <span class="number">63</span>).stack(identity_matrix(GF(<span class="number">2</span>), <span class="number">63</span>)).augment(mask.T)</span><br><span class="line">M = M^<span class="number">64</span></span><br><span class="line"><span class="keyword">assert</span> M.rank() == n</span><br><span class="line">M_inv = M^(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">index = <span class="number">1</span></span><br><span class="line">prefix = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">output = [<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(output)[<span class="number">2</span>:].zfill(<span class="number">64</span>)]</span><br><span class="line">all_result = dfs(index, prefix, output)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="built_in">len</span>(all_result)):</span><br><span class="line">    v = vector(GF(<span class="number">2</span>), all_result[i])</span><br><span class="line">    fake_s = v*M_inv</span><br><span class="line">    seed = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> fake_s.change_ring(ZZ):</span><br><span class="line">        seed &lt;&lt;= <span class="number">1</span></span><br><span class="line">        seed ^^= i</span><br><span class="line">    flag = AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).decrypt(enc)</span><br><span class="line">    <span class="keyword">if</span> flag[:<span class="number">32</span>].isascii():</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;5b322a2b-8d15-43b3-88f0-ee1586f1cf4f&#125;</span></span><br></pre></td></tr></table></figure></p>
]]></content>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
</search>
